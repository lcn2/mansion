$CONTROL USLINIT,NOSOURCE,FILE=5,FILE=6
$CONTROL INIT
      PROGRAM MMM
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      RND=2.
      CALL MMSA
      STOP
      END
      BLOCK DATA MMBC
      INTEGER IVRB(4,89),ICLS(4,12),IRNM(8,56),IRSN(4,17),IPRP(4,17),
     1IDTN(4,11),IXT(360),IXTB(180)
      COMPLEX CVRB(89),CCLS(12),CRNM(2,56),CRSN(17),CPRP(17),CDTN(11)
      EQUIVALENCE (CVRB,IVRB),(CCLS,ICLS),(CRNM,IRNM),(CRSN,IRSN),
     1(CPRP,IPRP),(CDTN,IDTN),(IXT(181),IXTB(1))
      COMMON/MMBC/IWRD(9,9),IPR(5),CVRB,CRNM,IROM(99),CRSN,IRES(17),
     1CPRP,CDTN,IVEN(107),
     2IXT,CCLS,ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      DATA CVRB/8HGO      ,8HCLIMB   ,8HENTER   ,8HXIMOW   ,8HXIWOM   ,
     28HMOWIX   ,8HWOMIX   ,8HWIMOX   ,8HWOXIM   ,8HXIMOW   ,8HMOXIW   ,
     48HDIG     ,8HFOLLOW  ,8H        ,8H        ,8H        ,8H        ,
     68HQUIT    ,8HSTOP    ,8HSCORE   ,8HGET     ,8HTAKE    ,8HDROP    ,
     88HGIVE    ,8HLOOK    ,8HREAD    ,8HFIND    ,8HLIST    ,8HLIGHT   ,
     18HTURN    ,8HHELP    ,8HOPEN    ,8HCLOSE   ,8HSNUFF   ,8HBLOW    ,
     38HEAT     ,8HRUB     ,8HBEAM    ,8HSWEEP   ,8HCALL    ,8HMOVE    ,
     58HANSWER  ,8HFEED    ,8HDISPLAY ,8HATTACK  ,8HKILL    ,8HSUSPEND ,
     78HRESTORE ,8HDRINK   ,8HMYSTERY ,8HBRIBE   ,8HQUESTION,8HLISTEN  ,
     98HUNLOCK  ,8HLOCK    ,8HSHOOT   ,8HOIL     ,8HRECORD  ,8HBREAK   ,
     18HPLACE   ,8HSLEEP   ,8H        ,8H        ,8H        ,8H        ,
     28H        ,8H        ,8H        ,8H        ,8H        ,8H        ,
     38HWALK    ,8HPUT     ,8HPICK    ,8H        ,8H        ,8H        ,
     48H        ,8H        ,8H        ,8H        ,8H        ,8H        ,
     58H        ,8H        ,8H        ,8H        ,8H        ,8H        /
      DATA CRNM/8HBUTLER'S,8H ROOM   ,8HFURNACE ,8HROOM    ,
     28HDARK PIT,8H        ,8HSECRET P,8HASSAGE  ,8HCREEPY C,8HRYPT    ,
     58HWINE CEL,8HLAR     ,8HSTORAGE ,8HROOM    ,8HDAMP DUN,8HGEON    ,
     88HFOOD CEL,8HLAR     ,8HLIVING R,8HOOM     ,8HENTRANCE,8H HALL   ,
     28HGAME ROO,8HM       ,8HBALL ROO,8HM       ,8HDINING H,8HALL     ,
     58HCHARMING,8H CHAPEL ,8HLIBRARY ,8H        ,8HKITCHEN ,8H        ,
     88HCLOSET  ,8H        ,8HMASTER B,8HEDROOM  ,8HBELL TOW,8HER      ,
     28HHAUNTED ,8HHALLWAY ,8HLARGE BE,8HDROOM   ,8HMAID'S R,8HOOM     ,
     58HTWISTY M,8HAZE     ,8HCOLD COR,8HRIDOR   ,8HSHORT CU,8HT       ,
     88HTRICKY T,8HREASURY ,8HMOLE MAZ,8HE       ,8HMOLE'S V,8HAULT    ,
     28HMOLE CAV,8HE       ,8HVEXING V,8HERANDA  ,8HGARDEN G,8HATE     ,
     58HGARDEN E,8HXIT     ,8HGARGOYLE,8H GARDEN ,8HGRASSY M,8HEADOW   ,
     88HFOUL FOU,8HNTAIN   ,8HWITCHING,8H WELL   ,8HBROKEN B,8HRIDGE   ,
     28HPOLLUTED,8H POND   ,8HCOZY COT,8HTAGE    ,8HFIRE ESC,8HAPE     ,
     58HSTRANGE ,8HSTREAM  ,8HAWKWARD ,8HATTIC   ,8HLABORATO,8HRY      ,
     88HHIDEOUS ,8HHIGHWAY ,8HFRONT PO,8HRCH     ,8HDREARY D,8HRIVEWAY ,
     28HMAIN GAT,8HE       ,8HROADWAY ,8H        ,8HBACK GAT,8HE       ,
     58HDENSE WO,8HODS     ,8HWOODS   ,8H        ,8HTREASURE,8H TREK   ,
     68HDEN OF D,8HEATH    ,8HTROLL TR,8HAP      ,8HBATTY BA,8HTHROOM  /
      DATA IROM/5201,5202,5203,5804,5205,5206,5207,5208,5209,15210,
     125211,15212,5804,5213,15214,5215,15816,15217,5218,15219,25220,
     25804,5221,15222,15223,15221,5218,5824,5024,5024,5124,5024,5124,
     35024,25245,5225,5125,3025,5225,5826,8027,5828,5028,5028,5028,
     45128,5028,5028,5028,5028,5028,8029,5830,5231,5232,5233,5233,
     55034,5034,5034,5034,5034,5034,5234,5234,5234,5234,5234,5234,
     65234,6535,6535,5236,5236,5237,5237,5237,37,8037,37,5238,5238,
     839,6540,5241,8041,6543,6518,8044,5156,5246,6547,5248,5249,
     95250,5249,5152,5151,5842/
      DATA CRSN/8HCORPSE  ,8HLADY    ,8HBUTLER  ,8HMOLE    ,8HVAMPIRE ,
     38HWOODSMAN,8HGARDENER,8HMAID    ,8HCOOK    ,8HWEREWOLF,8HELF     ,
     58HHUNTER  ,8HDWARF   ,8HMASTER  ,8HWOLF    ,8HWARRIOR ,8H        /
      DATA IRES/19,424,911,43,300,894,763,525,718,0,
     1870,996,330,920,71,0,0/
      DATA CPRP/8HIN      ,8HON      ,8HBY      ,8HAT      ,8HTO      ,
     28HOVER    ,8HFROM    ,8HOUT     ,8HTHE     ,8HOFF     ,8HBOOTY   ,
     38HA       ,8HWITH    ,8H        ,8H        ,8H        ,8H        /
      DATA CDTN/8HNORTH   ,8HEAST    ,8HSOUTH   ,8HWEST    ,8HUP      ,
     28HDOWN    ,8HBACKWARD,8HLEFT    ,8HFORWARD ,8HRIGHT   ,8HBACK    /
      DATA IVEN/0,121,220,493,1316,126,441,233,217,5218,9396,7312,
     1125,5308,295,520,152,105,1216,114,217,193,789,309,319,789,0,
     21184,1214,312,118,394,202,17213,625,0,0,0,0,
     40,0,0,0,0,14416,1101,0,0,10216,14316,0,0,20100,0,0,0,0,0,0,
     516,0,0,0,24,41,41,14,27,7,5,0,
     510,11,0,12,10,0,0,0,0,0,0,52,43,93,0,0,17,14,
     691,0,0,0,15,15,15,15,15,0,51,51,51,53,0,0,0,0/
      DATA IXT/401,502,704,20906,1310,1411,9562,1613,11714,1815,
     12219,22320,2421,2522,2623,22724,328,3429,2085,24036,
     22831,4342,4645,4647,4849,15417,5554,5856,5100,4600,
     20,0,6157,6458,7359,7460,6561,7164,7265,6866,
     26967,6268,6369,6871,6972,95,9335,8176,8277,6281,
     26382,1191,9792,29293,9894,9596,0,9899,9897,9798,
     320201,302,504,20807,1110,1211,1413,1514,22019,1716,
     42322,22423,22625,35,2829,2930,2931,436,3637,3738,
     53839,5342,4443,4644,4445,4446,4548,4350,4200,4700,
     529026,0,8890,0,6055,5456,5958,5559,6160,7062,
     56963,7364,6765,7166,8368,6769,6370,7671,6772,7573,
     56574,7475,7277,9192,9693,21,9695,96,9497,9898,
     6104,205,407,20609,1013,1114,6295,1316,11417,1518,
     71922,22023,2124,2225,2326,22427,8520,3228,3229,3640,
     83033,4344,4847,5150,4251,11754,5455,5658,4300,4800,
     80,0,5761,8162,8263,5864,6165,6466,6567,7168,
     87269,8370,6471,6572,5973,6074,3593,3535,7681,7782,
     82488,8889,9111,0,0,9394,9799,9396,9897,9898/
      DATA IXTB/20102,203,405,20708,1011,1112,1314,1415,21920,1617,
     12223,22324,22526,2928,3330,2932,9766,3604,3736,3837,
     23938,5043,4845,5247,4948,5149,4950,4951,4400,4900,
     222690,9088,0,5955,5457,5859,5560,6061,6862,7063,
     26664,7465,7267,6668,8369,6270,6671,7772,6473,7574,
     27375,7176,9291,29392,9493,9794,9895,9835,9997,9898,
     31203,1304,1607,1809,2112,2213,2314,3128,3129,2832,
     40,4039,3941,4544,4746,4748,5051,4752,4500,5000,
     50,0,0,753,8687,0,8499,9884,2934,0,
     60,0,9933,3839,3738,3637,3130,0,0,0,
     78990,0,0,0,0,0,0,0,0,0,
     80,0,0,0,0,0,0,0,0,0,
     6312,413,716,918,1221,1322,1423,2803,3028,3029,
     72830,3031,4139,3940,5142,4243,4546,5049,4253,5307,
     89984,0,0,0,0,0,0,0,5100,5100,
     90,1987,3399,3938,3837,3736,0,0,0,0,
     10,0,0,0,0,0,0,0,0,0,
     89089,0,0,0,0,0,0,0,0,0/
      DATA CCLS/8HPITIFUL ,8HPOOR    ,8HUNLUCKY ,8HNOVICE  ,
     18HFAIR    ,8HAMATEUR ,8HGOOD    ,8HLUCKY   ,
     38HSKILLFUL,8HSUPERB  ,8HMASTER  ,8HSUPER   /
      DATA ITST/93,45,999,1000,0,0,0,0,3,0,
     16,0,0,93,17,0,0,0,0,0,
     10,0,0,0,1,0,0,0,29,12,
     20,0,0,0,0,0,0,1,0,0/
      DATA NAME/2HMM,2H  ,2H  /
      DATA IPR/1,0,0,0,0/
      DATA LDEV,IDEV/6,5/
      END
      SUBROUTINE MMSA
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      DIMENSION ITIM(5)
      INTEGER MOVEAS
      IF(RND.NE.2.)GOTO 1000
      CALL OURTIME(ITIM)
      RND=(ITIM(2)*ITIM(3)+10)/3600.
      IM=1000*RND
      ITST(23)=IM
      RND=.001*IM
      LU=IPR(1)
      ITST(21)=IPR(3)
      ITST(30)=ITST(30)+3*ITST(29)
    9 NAME(2)=MOVEAS("SB")
      NAME(3)=MOVEAS("  ")
   10 WRITE(LDEV,100)ITST(15),IM
  100 FORMAT(/" WELCOME TO MYSTERY MANSION. (REV."I2") MYSTERY #"I4//,
     1"THIS VERSION OF MYSTERY MANSION IS NOT COMPATIBLE WITH ",
     2"EARLIER VERSIONS"/" MMFREEZE FILES.  PLEASE REPORT ANY",
     3" PROBLEMS TO THE AUTHOR."/,
     3" THE ELEMENTS OF MYSTERY MANSION ARE BASED ON THE ",
     4"FACTS, FICTIONS AND"/" FANTASIES OF THE PAST, PRESENT AND ",
     5"FUTURE. THE SCENARIO WAS DESIGNED"/" TO CHALLENGE THE DARING ",
     6"AND YET, ENTERTAIN THE CURIOUS. ESCAPE FOR A"/" FEW MOMENTS ",
     7"AND EXPERIENCE FRUSTRATION AND TRIUMPH, HOPE AND DESPAIR,"/
     8" POWER, LUST AND GREED. USING WHAT YOU KNOW, WHAT YOU CAN ",
     9"FIND OUT AND"/" WHAT WORKS; TELL THE COMPUTER WHAT YOU WANT ",
     1"OR THINK YOU SHOULD DO."//
     1" YOU ARE IN FRONT OF A HEAVY IRON GATE WHICH IS APPARENTLY THE ",
     2"ONLY"/" WAY THROUGH A HIGH BRICK WALL PROTECTING AN OLD MANSION",
     3" JUST VISIBLE"/" THROUGH THE GATE. A ROAD LEADS TO THE EAST AND"
     4," WEST ALONG THE WALL."/" IT IS DAWN AND A THIN LOW FOG IS JUST "
     5,"CLEARING FROM THE COOL AREAS."/" BEHIND YOU TO THE SOUTH ",
     5"ON THE OTHER SIDE OF THE ROAD IS A HIGHWAY"/" GOING SOUTH AS ",
     6"FAR AS YOU CAN SEE. YOU CAN JUST SEE THE TAXI THAT"/
     7" DROPPED YOU OFF, DRIVING OUT OF SIGHT.")
      ITST(18)=ITIM(4)*1200+ITIM(3)*20+ITIM(2)/3
      ITST(19)=100*ITIM(4)+ITIM(3)
 1000 RND=RND*7.7-INT(RND*7.7)
      IC=INT(RND*77)+1
      IF ((( IC .GT. 9) .AND. (IC .LT. 19)) .OR. ((IC .GT. 27)
     1.AND. (IC .LT. 54))) GOTO 1000
      ITST(8)=IC
      RND=RND*7.7-INT(RND*7.7)
      ID=INT(RND*4)
      IF (ID .EQ. 0) IE=7
      IF (ID .EQ. 1) IE=8
      IF (ID .EQ. 2) IE=9
      IF (ID .EQ. 3) IE=2
      IF((IC .LT. 28) .AND. (ID .EQ. 0)) IE=3
      IF((IC .LT. 28) .AND. (ID .EQ. 1)) IE=8
      IF((IC .LT. 28) .AND. (ID .EQ. 2)) IE=14
      IF((IC .LT. 28) .AND. (ID .EQ. 3)) IE=2
      IF((IC .LT. 10) .AND. (ID .EQ. 0)) IE=3
      IF((IC .LT. 10) .AND. (ID .EQ. 1)) IE=7
      IF((IC .LT. 10) .AND. (ID .EQ. 2)) IE=9
      IF((IC .LT. 10) .AND. (ID .EQ. 3)) IE=14
      ITST(9)=IE
      RND=RND*7.7-INT(RND*7.7)
      IF=INT(RND+.5)
      RND=RND*7.7-INT(RND*7.7)
      IF((IE .EQ. 3) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 3) .AND. (IF .EQ. 1)) IG=INT(RND*9)+19
      IF((IE .EQ. 7) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 7) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      IF((IE .EQ. 8) .AND. (IF .EQ. 0)) IG=INT(RND*9)+19
      IF((IE .EQ. 8) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      IF((IE .EQ. 9) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 9) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      IF((IE .EQ. 14) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 14) .AND. (IF .EQ. 1)) IG=INT(RND*9)+19
      IF((IE .EQ. 2) .AND. (IF .EQ. 0)) IG=INT(RND*9)+19
      IF((IE .EQ. 2) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      RND=RND*7.7-INT(RND*7.7)
      IVEN(INT(RND*6)+9)=(IVEN(INT(RND*6)+9)/100)*100+IG
      ITST(10)=INT(RND*6)+9
      IF(INT(RND*6) .EQ. 0) ITST(11)=5
      IF(ITST(10) .GT. 12) IRES(1)=10000+IC
      IF(ITST(10) .GT. 12) GOTO 2000
      RND=RND*7.7-INT(RND*7.7)
      IF=INT(RND+.5)
      RND=RND*7.7-INT(RND*7.7)
      IF((IE .EQ. 3) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 3) .AND. (IF .EQ. 1)) IG=INT(RND*9)+19
      IF((IE .EQ. 7) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 7) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      IF((IE .EQ. 8) .AND. (IF .EQ. 0)) IG=INT(RND*9)+19
      IF((IE .EQ. 8) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      IF((IE .EQ. 9) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 9) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      IF((IE .EQ. 14) .AND. (IF .EQ. 0)) IG=INT(RND*9)+1
      IF((IE .EQ. 14) .AND. (IF .EQ. 1)) IG=INT(RND*9)+19
      IF((IE .EQ. 2) .AND. (IF .EQ. 0)) IG=INT(RND*9)+19
      IF((IE .EQ. 2) .AND. (IF .EQ. 1)) IG=INT(RND*24)+54
      IRES(1)=10000+IG
 2000 IC=INT(RND*3)+78
      IXT(326)=75+100*IC
      IF (IC .EQ. 79) IXT(266)=7579
      IC=IC+1
      IF (IC .EQ. 81) IC=78
      IXT(327)=76+100*IC
      IF(IC .EQ. 79) IXT(266)=7679
      IC=IC+1
      IF (IC .EQ. 81) IC=78
      IXT(328)=77+100*IC
      IF (IC .EQ. 79) IXT(266)=7779
      RND=RND*7.7-INT(RND*7.7)
      IVEN(8)=200+INT(RND*6+29)
      RND=RND*7.7-INT(RND*7.7)
      IRES(4)=INT(RND*9+43)
      IWRD(1,1)=MOVEAS("M ")
      IWRD(2,1)=MOVEAS("I ")
      IWRD(3,1)=MOVEAS("W ")
      IWRD(4,1)=MOVEAS("O ")
      IWRD(5,1)=MOVEAS("X ")
      IWRD(1,2)=MOVEAS("M ")
      IWRD(2,2)=MOVEAS("I ")
      IWRD(3,2)=MOVEAS("W ")
      IWRD(4,2)=MOVEAS("O ")
      IWRD(5,2)=MOVEAS("H ")
      DO 3300 I=1,2
      RND=RND*7.7-INT(RND*7.7)
      DO 3300 J=1,INT(RND*10)+5
      RND=RND*7.7-INT(RND*7.7)
      IF (RND .LT. .5) GOTO 3100
      IC=IWRD(1,I)
      IWRD(1,I)=IWRD(3,I)
      IWRD(3,I)=IC
 3100 RND=RND*7.7-INT(RND*7.7)
      IF (RND .LT. .5) GOTO 3200
      IC=IWRD(2,I)
      IWRD(2,I)=IWRD(4,I)
      IWRD(4,I)=IC
 3200 RND=RND*7.7-INT(RND*7.7)
      IF (RND .LT. .5) GOTO 3300
      IC=IWRD(5,1)
      IWRD(5,1)=IWRD(5,2)
      IWRD(5,2)=IC
 3300 CONTINUE
      RND=RND*7.7-INT(RND*7.7)
      IF (RND .LT. .5) GOTO 3400
      IC=IWRD(1,1)
      IWRD(1,1)=IWRD(5,1)
      IWRD(5,1)=IC
 3400 RND=RND*7.7-INT(RND*7.7)
      IF (RND .LT. .5) GOTO 3500
      IC=IWRD(1,2)
      IWRD(1,2)=IWRD(5,2)
      IWRD(5,2)=IC
 3500 CONTINUE
      DO 3700 I=1,2
      IVRB(1,4*I)=IWRD(1,I)-32+(IWRD(2,I)-32)/256
      IVRB(2,4*I)=IWRD(3,I)-32+(IWRD(4,I)-32)/256
      IVRB(3,4*I)=IWRD(5,I)
      IVRB(1,4*I+1)=IWRD(5,I)-32+(IWRD(4,I)-32)/256
      IVRB(2,4*I+1)=IWRD(3,I)-32+(IWRD(2,I)-32)/256
      IVRB(3,4*I+1)=IWRD(1,I)
      IF((IWRD(1,I).NE.MOVEAS("W ")).AND.(IWRD(1,I).NE.MOVEAS("M ")))
     1GOTO 3600
      IVRB(1,4*I+2)=IWRD(3,I)-32+(IWRD(2,I)-32)/256
      IVRB(2,4*I+2)=IWRD(1,I)-32+(IWRD(4,I)-32)/256
      IVRB(3,4*I+2)=IWRD(5,I)
      IVRB(1,4*I+3)=IWRD(5,I)-32+(IWRD(4,I)-32)/256
      IVRB(2,4*I+3)=IWRD(1,I)-32+(IWRD(2,I)-32)/256
      IVRB(3,4*I+3)=IWRD(3,I)
      GOTO 3700
 3600 IVRB(1,4*I+2)=IWRD(1,I)-32+(IWRD(2,I)-32)/256
      IVRB(2,4*I+2)=IWRD(5,I)-32+(IWRD(4,I)-32)/256
      IVRB(3,4*I+2)=IWRD(3,I)
      IVRB(1,4*I+3)=IWRD(3,I)-32+(IWRD(4,I)-32)/256
      IVRB(2,4*I+3)=IWRD(5,I)-32+(IWRD(2,I)-32)/256
      IVRB(3,4*I+3)=IWRD(1,I)
 3700 CONTINUE
      IWP(3)=MOVEAS("  ")
      IWP(4)=MOVEAS("  ")
      IF(ITST(10).EQ.9)IWP(1)=MOVEAS("GU")
      IF(ITST(10).EQ.9)IWP(2)=MOVEAS("N ")
      IF(ITST(10).EQ.10)IWP(1)=MOVEAS("KN")
      IF(ITST(10).EQ.10)IWP(2)=MOVEAS("IF")
      IF(ITST(10).EQ.10)IWP(3)=MOVEAS("E ")
      IF(ITST(10).EQ.11)IWP(1)=MOVEAS("AX")
      IF(ITST(10).EQ.11)IWP(2)=MOVEAS("E ")
      IF(ITST(10).EQ.12)IWP(1)=MOVEAS("SW")
      IF(ITST(10).EQ.12)IWP(2)=MOVEAS("OR")
      IF(ITST(10).EQ.12)IWP(3)=MOVEAS("D ")
      IF(ITST(10).EQ.13)IWP(1)=MOVEAS("VI")
      IF(ITST(10).EQ.13)IWP(2)=MOVEAS("AL")
      IF(ITST(10).EQ.14)IWP(1)=MOVEAS("CL")
      IF(ITST(10).EQ.14)IWP(2)=MOVEAS("UB")
 3800 RND=RND*7.7-INT(RND*7.7)
      IC=INT(RND*6+2)
      IF(IC.EQ.4)IC=8
      IF(IC.EQ.5)IC=9
      IF(IC.EQ.6)IC=14
      IF(IC.EQ.ITST(9))GOTO 3800
      ITST(39)=IC
 3810 NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
 9999 CONTINUE
      NAME(2)=MOVEAS("SD")
      CALL EXEC(8,NAME,LU,11111,0)
      STOP
      END
$CONTROL SEGMENT=MMSB
      SUBROUTINE MMSB
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      INTEGER ITEM(4,189)
      COMPLEX CTEM(149)
      EQUIVALENCE (CTEM,ITEM)
      DIMENSION MSG(72),MSGR(72),ITIM(5)
      INTEGER MOVEAS
      IFSD(I)=I-100*INT(I/100.)
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      RN(R)=R*7.7-INT(R*7.7)
      LU=IPR(1)
      NAME(2)=MOVEAS("SD")
      R=RND
      DATA CTEM /8HRING    ,8HKEYS    ,8HCLOCK   ,8HLANTERN ,8HCROSS   ,
     18HCOMPASS ,8HTREASURE,8HBATTERY ,8HGUN     ,8HKNIFE   ,8HAXE     ,
     38HSWORD   ,8HVIAL    ,8HCLUB    ,8HROPE    ,8HCHAIR   ,8HAMULET  ,
     58HTALISMAN,8HCANDLE  ,8HBULLET  ,8HBOOK    ,8HNOTE    ,8HXMITTER ,
     78HFOOD    ,8HBROOM   ,8HRECEIVER,8HTORCH   ,8HMAP     ,8HWEDGE   ,
     18HGLOBE   ,8HMATCH   ,8HSHOVEL  ,8HOILCAN  ,8HHATCHET ,8HCHEST   ,
     38HPEARLS  ,8HEMERALD ,8HCOINS   ,8HGOBLET  ,8HDIAMONDS,8HJEWELRY ,
     68HNECKLACE,8HCROWN   ,8HDARTS   ,8HSHIELD  ,8HKEY     ,8HBATTERY ,
     88HGAUNTLET,8HPARROT  ,8HMACE    ,8H        ,8H        ,8HCLOTHES ,
     18HPADLOCK ,8HPOLICE  ,8HOPERATOR,8HFIREMEN ,8HTAXI    ,8H        ,
     38HWINE    ,8HPOISON  ,8HWATER   ,8HMONKEY  ,8HMIRROR  ,8HDRAWING ,
     58HCAVITY  ,8HWOOD    ,8HRAGS    ,8HCRATE   ,8HCOFFIN  ,8HPOINTS  ,
     68HPICTURE ,8HPHONE   ,8HHINGE   ,8HRADIO   ,8HLAMP    ,8HWALL    ,
     78HTREE    ,8HTROLL   ,8HSTATUE  ,8HFIGURINE,8HIDOL    ,8HBOULDERS,
     88HROCKS   ,8HHOOK    ,8HNEW     ,8HOLD     ,8HSCROLL  ,8HFIRE    ,
     98HPLAQUE  ,8HCURTAIN ,8HDOOR    ,8HGATE    ,8HQUEEN   ,8HKING    ,
     18HINDIANS ,8HTABLE   ,8HTABLES  ,8HSHOWER  ,8HFIGURINE,8HBULL    ,
     28HBARS    ,8HDAGGER  ,8HPRINTER ,8HCASSETTE,8HSILVER  ,8HMANSION ,
     38HAND     ,8HCURTAINS,8HCRAZY   ,8HBOULDER ,26*8H        ,8HWHERE
     4  ,8HWHAT    ,8HWHO     ,8HHOW     ,8HWHY     ,7*8H        /
      IF(IWRD(6,IWRD(7,1)+1).NE.108)GOTO 5
      DO 4 I=1,6
    4 IWRD(I,IWRD(7,1))=IWRD(I,IWRD(7,1)+2)
      IWRD(6,IWRD(7,1)+1)=0
      GOTO 296
    5 DO 10 I=1,9
      DO 10 J=1,9
      IWRD(J,I)=MOVEAS("  ")
      IF(I.EQ.9)GOTO 10
      MSG(J+(I-1)*9)=8224
      MSGR(J+(I-1)*9)=8224
   10 CONTINUE
      LU=IPR(1)
      WRITE(LDEV,12)
   12 FORMAT(1X/)
      CALL REIO(MSGR,72)
      IF(MSGR(1).EQ.MOVEAS("**"))GOTO 5
      DO 30 J=1,71,2
      MSG(J)=(MSGR((J+1)/2)/256)*256+32
      MSG(J+1)=(MSGR((J+1)/2)-MSG(J)+32)*256+32
      IF(MSG(J).EQ.32)MSG(J)=8224
      IF(MSG(J+1).EQ.32)MSG(J+1)=8224
   30 CONTINUE
      IC=0
      DO 60 INUM=1,9
      DO 40 J=1,9
      IC=IC+1
      IWRD(J,INUM)=MSG(IC)
      IF((MSG(IC).EQ.8224).AND.(MSG(IC+1).EQ.8224))GOTO 80
      IF(MSG(IC).EQ.8224)GOTO 60
   40 CONTINUE
      CALL EXEC(8,NAME,LU,150,0)
   60 CONTINUE
      CALL EXEC(8,NAME,LU,170,0)
   80 DO 90 J=1,INUM
      DO 90 I=1,4
   90 IWRD(I,J)=IWRD(2*I-1,J)-32+(IWRD(2*I,J)-32)/256
      DO 100 I=5,9
      DO 100 J=1,5
  100 IWRD(I,J)=0
      DO 170 I=1,INUM
      DO 110 K=1,89
      IC=0
      DO 110 J=1,4
      IF(IWRD(J,I).EQ.IVRB(J,K))IC=IC+1
      IF(IC.EQ.4)IWRD(5,I)=1
      IF(IC.EQ.4) GOTO 169
  110 CONTINUE
      DO 120 K=1,11
      IC=0
      DO 120 J=1,4
      IF(IWRD(J,I).EQ.IDTN(J,K))IC=IC+1
      IF(IC.EQ.4)IWRD(5,I)=2
      IF(IC.EQ.4) GOTO 169
  120 CONTINUE
      DO 130 K=1,149
      IC=0
      DO 130 J=1,4
      IF(IWRD(J,I).EQ.ITEM(J,K))IC=IC+1
      IF(IC.EQ.4)IWRD(5,I)=3
      IF(IC.EQ.4) GOTO 169
  130 CONTINUE
      DO 140 K=1,17
      IC=0
      DO 140 J=1,4
      IF(IWRD(J,I).EQ.IRSN(J,K))IC=IC+1
      IF(IC.EQ.4) IWRD(5,I)=4
      IF(IC.EQ.4) GOTO 169
  140 CONTINUE
      DO 150 K=1,17
      IC=0
      DO 150 J=1,4
      IF(IWRD(J,I).EQ.IPRP(J,K))IC=IC+1
      IF(IC.EQ.4)IWRD(5,I)=5
      IF(IC.EQ.4) GOTO 169
  150 CONTINUE
      IF(I.GT.1)GOTO 168
      IC=IWRD(1,1)
      ID=0
      IF(IC.EQ.MOVEAS("N "))ID=1
      IF(IC.EQ.MOVEAS("E "))ID=2
      IF(IC.EQ.MOVEAS("S "))ID=3
      IF(IC.EQ.MOVEAS("W "))ID=4
      IF(IC.EQ.MOVEAS("U "))ID=5
      IF(IC.EQ.MOVEAS("D "))ID=6
      IF(IC.EQ.MOVEAS("B "))ID=7
      IF(IC.EQ.MOVEAS("L "))ID=8
      IF(IC.EQ.MOVEAS("F "))ID=9
      IF(IC.EQ.MOVEAS("R "))ID=10
      IF(ID.NE.0)IWRD(5,1)=1
      IF(ID.NE.0)IWRD(5,2)=2
      IF(ID.NE.0)INUM=2
      IF(ID.NE.0)IWRD(6,1)=1
      IF(ID.NE.0)IWRD(6,2)=ID
      IF(ID.NE.0)GOTO 171
  168 CALL EXEC(8,NAME,LU,160,I)
  169 CONTINUE
      IWRD(6,I)=K
      IF(K.GT.143)CALL EXEC(8,NAME,LU,165,0)
      IF(K.GT.137.AND.K.LT.144)CALL EXEC(8,NAME,LU,166,0)
  170 CONTINUE
      IX=0
      IF(IWRD(5,1).EQ.5.AND.IWRD(6,1).EQ.11.AND.INUM.EQ.1)IX=9999
      IF(IX.EQ.9999)IWRD(5,1)=1
      IF(IX.EQ.9999)IWRD(6,1)=28
      IF(IWRD(5,1).NE.1)CALL EXEC(8,NAME,LU,180,0)
      IF(IWRD(6,1).EQ.19.AND.IWRD(6,2).EQ.19)GOTO 9999
      IF((IWRD(5,2).EQ.1.OR.IWRD(5,3).EQ.1.OR.IWRD(5,4).EQ.1.OR.
     1IWRD(5,5).EQ.1).AND.IWRD(5,1).NE.51)CALL EXEC(8,NAME,LU,190,0)
      DO 176 I=2,8
      IF(IWRD(5,I).EQ.5.AND.(IWRD(6,I).EQ.9.OR.IWRD(6,I).EQ.12))GOTO172
      IF(IWRD(5,I).EQ.2.AND.IWRD(6,I-1).EQ.74.AND.IWRD(6,I).EQ.5)
     1IWRD(6,I-1)=21
      IF(IWRD(5,I).EQ.2.AND.IWRD(6,I-1).EQ.21.AND.IWRD(6,I).EQ.5)
     1GOTO 172
      IF(IWRD(5,I).EQ.2.AND.IWRD(6,I-1).EQ.73.AND.IWRD(6,I).EQ.6)
     1IWRD(6,I-1)=23
      IF(IWRD(5,I).EQ.2.AND.IWRD(6,I-1).EQ.23.AND.IWRD(6,I).EQ.6)
     1 GOTO 172
      IF(IWRD(5,I).NE.3.OR.IWRD(5,I+1).NE.3)GOTO 176
      IF(IWRD(6,I).EQ.86.AND.IWRD(6,I+1).EQ.8)GOTO 172
      IF(IWRD(6,I).EQ.8.AND.IWRD(6,I+1).EQ.4)GOTO 172
      IF(IWRD(6,I).EQ.106.AND.IWRD(6,I+1).EQ.20)GOTO 172
      IF(IWRD(6,I).EQ.106.AND.IWRD(6,I+1).EQ.5)GOTO 172
      IF(IWRD(6,I).EQ.106.AND.IWRD(6,I+1).EQ.39)GOTO 172
      IF(IWRD(6,I).EQ.87.AND.IWRD(6,I+1).EQ.8)IWRD(6,I+1)=47
      IF(IWRD(6,I).EQ.87.AND.IWRD(6,I+1).EQ.47)GOTO 172
      GOTO 176
  172 INUM=INUM-1
      DO 175 J=I,8
      DO 175 K=1,6
      IWRD(K,J)=IWRD(K,J+1)
      IF(J.EQ.8)IWRD(K,J+1)=MOVEAS("  ")
      IF(J.EQ.8.AND.K.GT.4)IWRD(K,J+1)=0
      I=I-1
  175 CONTINUE
  176 CONTINUE
      IF(IWRD(6,1).EQ.41.AND.(INUM.EQ.1.OR.IWRD(5,2).EQ.2))IWRD(6,1)=1
      IF(IWRD(6,1).EQ.72)IWRD(6,1)=1
      IF(IWRD(6,1).EQ.73)IWRD(6,1)=60
      IF(IWRD(5,2).EQ.3.AND.IWRD(6,2).EQ.61)IWRD(6,2)=13
      IF(IWRD(5,2).EQ.3.AND.IWRD(6,2).EQ.109)IWRD(6,2)=91
      IF(IWRD(5,3).EQ.3.AND.IWRD(6,3).EQ.109)IWRD(6,3)=91
      IF(IWRD(5,2).EQ.3.AND.IWRD(6,2).EQ.111)IWRD(6,2)=83
      IF(IWRD(5,3).EQ.3.AND.IWRD(6,3).EQ.111)IWRD(6,3)=83
      IF(IWRD(6,3).EQ.97)INUM=INUM-1
      IF(IWRD(6,INUM-1).EQ.108.AND.IWRD(6,1).EQ.21)INUM=INUM-2
      IF(IWRD(6,INUM-1).EQ.108.AND.IWRD(6,1).EQ.23)INUM=INUM-2
  171 IR=ITST(1)
      NAME(2)=MOVEAS("SD")
      IF(IWRD(1,1).NE.MOVEAS("  ")) ITST(22)=0
      ITST(27)=ITST(5)
      ITST(5)=ITST(5)+1
      RND=RND*7.7-INT(RND*7.7)
      IF(RND.LE..0.OR.RND.GE.1.)RND=.5
      R=RND
      CALL OURTIME(ITIM)
      IC=ITIM(4)*1200+ITIM(3)*20+ITIM(2)/3
      IF(IC-ITST(18).LT.0)ITST(18)=0
      IF(ITST(5).GT.1)ITST(5)=ITST(5)+(IC-ITST(18))/10
      ITST5=ITST(5)
      IF(IC-ITST(18).GE.10.AND.IFSD(ITST(5)).EQ.95)WRITE(LDEV,173)
  173 FORMAT(/" YOU ARE TAKING TOO LONG.")
      ITST(18)=IC
      IF(ITST(1).EQ.46.AND.(IWRD(6,1).NE.1.OR.IWRD(6,2).NE.11.OR.
     1IWRD(5,2).NE.2).AND.IXT(320).EQ.0)CALL EXEC(8,NAME,LU,176,0)
      IT=0
      IF(ITST(32).NE.0)IT=ITST(5)-ITST(32)
      IF(IT.GT.15)IXT(352)=4651
      IF(IT.GT.15)IXT(351)=4649
      IF(IT.GT.24.AND.IXT(319).NE.0)IXT(319)=4652
      IF(IT.GT.24)IXT(353)=4650
      IF(IT.GT.36)IXT(354)=4653
      IF(IT.GT.36)IXT(318)=4645
      IC=0
      IF(ITST5/25.-ITST5/25.EQ.0)IC=ITST5/25+6
  174 IF(IC.GT.12)IC=IC-12
      IF(IC.GT.12)GOTO 174
      IF(IC.NE.0.AND.(IR.LT.28.OR.IR.GT.53))WRITE(LDEV,200)IC
  200 FORMAT(/" THE TOWER BELL RANG"I3" TIMES")
      IC=ITST5-(ITST5/25)*25
      IF(IC.EQ.13.AND.IWRD(6,1).NE.20.AND.IWRD(6,2).NE.40)ITST(3)=
     1ITST(3)-2
      IF(IC.EQ.12.AND.IR.LT.28.AND.ITST5.LT.450)WRITE(LDEV,181)
  181 FORMAT(/" YOU HEARD A WOMAN SCREAM")
      IF(IC.EQ.12.AND.IR.GT.53.AND.ITST5.GE.300.AND.ITST5.LT.450)
     1WRITE(LDEV,182)
  182 FORMAT(/" YOU HEARD A WOLF HOWL")
      IF(IC.EQ.12.AND.IR.GT.53.AND.ITST5.LT.300)WRITE(LDEV,183)
  183 FORMAT(/" YOU HEARD A CROW CAW AS IT FLEW BY")
C     ADDED ".AND.IR.NE.35" FOR HIDEOUS HIGHWAY
      IF(IC.EQ.12.AND.IR.LT.54.AND.IR.GT.27.AND.ITST5.LT.450
     1.AND.IR.NE.35)WRITE(LDEV,184)
  184 FORMAT(/" YOU HEARD SOME ROCKS FALLING NEARBY")
      IF(ITST(5).GT.300)IXT(27)=0
      IF(IVEN(73).NE.11)GOTO 194
      IF(IVEN(22).GT.20000.AND.IC.EQ.12)IVEN(73)=122
      IF(IVEN(4).GT.20000.AND.IVEN(6).GT.20000.AND.ITST5.EQ.120)
     1IVEN(73)=222
      IF(ITST(8).EQ.0.AND.IC.EQ.5.AND.IRES(ITST(9)).NE.0)IVEN(73)=322
      IF(ITD(IVEN(4)).EQ.4.AND.IR.EQ.11)IVEN(73)=422
  194 IF(IFSD(IVEN(73)).EQ.22.AND.IR.GT.9.AND.IR.LT.19.AND.IWRD(6,1)
     1.NE.42.AND.IWRD(6,1).NE.40)WRITE(LDEV,195)
  195 FORMAT(/" YOU HEARD A PHONE RING")
      IF(IVEN(73).NE.11)IVEN(73)=IVEN(73)+1000
      IF(IVEN(73).GE.7000)IVEN(73)=11
      IF(ITST5.GE.450.AND.IXT(26).NE.0)CALL EXEC(8,NAME,LU,185,0)
      IF(IR.GT.18.AND.IR.LT.28.AND.ITST5.GT.490)WRITE(LDEV,188)
  188 FORMAT(/" THE SMOKE IS MAKING YOU CHOKE")
      IF(IR.GT.18.AND.IR.LT.28.AND.ITST5.GE.500)CALL EXEC(8,NAME,
     1LU,189,0)
      IF(IR.EQ.93.AND.ITST5.GE.451.AND.IXT(26).EQ.0)CALL EXEC(8,
     1NAME,LU,191,0)
      IF(ITST5.GE.550)CALL EXEC(8,NAME,LU,192,0)
      R=RN(R)
      IF(IVEN(8).EQ.0.AND.IVEN(47).GT.227.AND.IVEN(47).LT.235
     1.AND.ITST(1).LT.28)IVEN(47)=0
      IF(IVEN(8).EQ.0.AND.IVEN(47).EQ.0)IVEN(8)=229+INT(R*6)
      IF(IFD(IVEN(4)).EQ.0)GOTO 210
      ITST(6)=ITST(6)+1
      IBT=ITST(6)-(ITST(6)/1000)*1000
      IF(IBT.LT.100)GOTO 210
      IF(IBT.EQ.120)IVEN(4)=IVEN(4)-1000
      IF(IVEN(4).LT.20000)GOTO 210
      IF(IVEN(8).LT.20000)GOTO 204
      IVEN(8)=0
      ITST(6)=(ITST(6)/1000)*1000
      WRITE(LDEV,202)
  202 FORMAT(/" I REPLACED YOUR WEAK LANTERN BATTERY")
      IVEN(47)=20200+IR
      GOTO 210
  204 IBT=IBT-100
      IF(IBT.EQ.20)WRITE(LDEV,206)
  206 FORMAT(/" YOUR LANTERN IS OUT")
      IF(IBT.EQ.20)GOTO 210
      IF(IBT/5..EQ.1.*INT(IBT/5.))WRITE(LDEV,208)
  208 FORMAT(/" THE BATTERY IN YOUR LANTERN IS GETTING WEAK")
  210 IF(IFD(IVEN(19)).EQ.0)GOTO 220
      ITST(6)=ITST(6)+1000
      IBT=ITST(6)/1000
      IF(IBT.LT.20)GOTO 220
      IF(IBT.EQ.20.AND.IVEN(19).EQ.1216)ITST(6)=ITST(6)-20000
      IF(IBT.EQ.32)ITST(6)=ITST(6)-32000
      IF(IBT.EQ.29.AND.IVEN(19).GT.20000)WRITE(LDEV,212)
  212 FORMAT(/" YOUR CANDLE IS BURNING LOW")
      IF(IBT.EQ.32.AND.IVEN(19).GT.20000)WRITE(LDEV,214)
  214 FORMAT(/" YOUR CANDLE BURNED OUT")
      IF(IBT.EQ.32)IVEN(19)=1216
  220 IF(IFD(IVEN(31)).EQ.0)GOTO 230
      ITST(7)=ITST(7)+10000
      IBT=ITST(7)/10000
      IF(IBT.LT.3)GOTO 230
      ITST(7)=ITST(7)-30000
      IF(IVEN(31).GT.20000)WRITE(LDEV,222)
  222 FORMAT(/" YOUR MATCH BURNED OUT")
      IVEN(31)=118
  230 IF(IVEN(27).EQ.0.AND.IR.EQ.53.AND.IXT(320).NE.0)IVEN(27)=1242
      IF(IVEN(27).EQ.0.AND.IR.EQ.42.AND.IXT(320).EQ.0)IVEN(27)=1245
      IF(IVEN(27).EQ.0.AND.(IR.EQ.28.OR.IR.EQ.33))IVEN(27)=1230
      IF(IVEN(27).NE.0.AND.IVEN(27).LT.20000.AND.IR.LT.9.AND.IFSD(
     1IVEN(27)).GT.27.AND.IFSD(IVEN(27)).LT.54)IVEN(27)=0
      IF(IVEN(27).EQ.0)ITST(7)=ITST(7)-100*ITFD(ITST(7))
      IF(IFD(IVEN(27)).EQ.0)GOTO 250
      ITST(7)=ITST(7)+100
      IBT=ITFD(ITST(7))
      IF((IR.LT.28.OR.IR.GT.53).AND.IVEN(27).GT.21000)WRITE(LDEV,244)
      IF((IR.LT.28.OR.IR.GT.53).AND.IFD(IVEN(27)).EQ.1)
     1IVEN(27)=IVEN(27)-1000
      IF(IBT.LT.21)GOTO 250
      IF(IBT.LT.25.AND.IVEN(27).GT.21000)WRITE(LDEV,242)
  242 FORMAT(/" YOUR TORCH IS FLICKERING AND GETTING DIM")
      IF(IBT.EQ.25.AND.IVEN(27).GT.21000)WRITE(LDEV,244)
  244 FORMAT(/" YOUR TORCH BURNED OUT")
      IF(IBT.EQ.25.AND.IFD(IVEN(27)).EQ.1)IVEN(27)=IVEN(27)-1000
  250 IXT(16)=(IXT(16)/10000)*10000+2724
      IXT(57)=0
      IVEN(68)=27
      IC=ITST5-(ITST5/25)*25
      IF(IC.GT.21)IXT(16)=(IXT(16)/10000)*10000+8824
      IF(IC.LT.1)IXT(57)=8988
      IF(IC.GT.21)IVEN(68)=88
      IXT(271)=0
      IF(IVEN(16).EQ.519)IXT(271)=8719
      DO 251 I=1,17
      RND=RND*7.7-INT(RND*7.7)
      IF(IFD(IRES(I)).EQ.1.AND.RND.LT..3)IRES(I)=IRES(I)-1000
      IF(IFD(IRES(I)).EQ.2.AND.RND.LT..3)IRES(I)=IRES(I)-1000
      IF(IFD(IRES(I)).EQ.2.AND.RND.GT..7)IRES(I)=IRES(I)+1000
      IF(IFD(IRES(I)).EQ.9.AND.RND.LT..3)IRES(I)=IRES(I)+1000
      IF(IFD(IRES(I)).EQ.8.AND.RND.LT..3)IRES(I)=IRES(I)+1000
      IF(IFD(IRES(I)).EQ.8.AND.RND.GT..7)IRES(I)=IRES(I)-1000
  251 CONTINUE
      IF(ITST(31).EQ.1.AND.RND.LT..3)ITST(31)=0
      IF(ITST(31).EQ.2.AND.RND.LT..3)ITST(31)=1
      IF(ITST(31).EQ.2.AND.RND.GT..7)ITST(31)=3
      IF(ITST(8).EQ.0.AND.IR.EQ.IFSD(IRES(ITST(9))).AND.IRES(ITST(9))
     1.LT.10000.AND.(IVEN(10).EQ.10200+ITST(9).OR.IVEN(11).EQ.10300+
     1ITST(9).OR.IVEN(12).EQ.10300+ITST(9)).AND.ITST5-1.NE.
     2ITST(13))CALL EXEC(8,NAME,LU,251,0)
      IF(IFSD(IRES(13)).NE.IR.OR.ITST(13).EQ.ITST5-1.OR.IRES(13)
     1.GT.10000)GOTO 253
      R=RN(R)
      IF((R.LT..8).AND.(IVEN(34).EQ.17213))WRITE(LDEV,252)
  252 FORMAT(/" THE DWARF THREW A HATCHET AT YOU AND MISSED. HE ",
     1"CURSED, RAN AROUND"/" YOU AND PICKED IT UP")
      IF((R.GE..8).AND.(IVEN(34).EQ.17213))CALL EXEC(8,NAME,LU,254,0)
  253 IF(IR.EQ.92.AND.IRES(16).EQ.0)IRES(16)=995
      R=RN(R)
      IF(IFSD(IRES(16)).NE.IR.OR.IRES(16).GT.1999.OR.(IWRD(6,1).NE.22
     1.AND.R.GT..33))GOTO 260
      IWRD(7,1)=2
      IWRD(6,1)=46
      IWRD(1,2)=MOVEAS("WA")
      IWRD(2,2)=MOVEAS("RR")
      IWRD(3,2)=MOVEAS("IO")
      IWRD(4,2)=MOVEAS("R ")
      IWRD(5,2)=4
      IWRD(6,2)=16
      WRITE(LDEV,254)
  254 FORMAT(/" THE WARRIOR JUST GAVE A FEARSOME YELL AND ATTACKED.")
      NAME(2)=MOVEAS("SH")
      CALL EXEC(8,NAME,0,0,0)
  260 IF((IFSD(IRES(5)).EQ.IR).AND.(IVEN(5).LT.20000)
     1.AND.(ITST(13).NE.ITST5-1))CALL EXEC(8,NAME,LU,262,0)
      IF(IRES(5).EQ.300.AND.ITST5.GE.50)IRES(5)=5
      IF((IFSD(IRES(11)).NE.IR).OR.(ITST(13).EQ.
     1ITST5-1).OR.(IRES(11).GT.10000))GOTO 270
      R=RN(R)
      IC=0
      DO 261 J=INT(R*52+1),52
      IF(IVEN(J).GT.20000)IC=J
      IF(IC.NE.0)GOTO 264
  261 CONTINUE
      DO 263 J=1,INT(R*52+1)
      IF(IVEN(J).GT.20000)IC=J
      IF(IC.NE.0)GOTO 264
  263 CONTINUE
      GOTO 266
  264 DO 265 J=1,52
      IF((IVEN(J)/10000.EQ.1).AND.(IFSD(IVEN(J)).EQ.
     111))IVEN(J)=IVEN(J)-10011+79
  265 CONTINUE
  266 IF(IC.NE.0)IVEN(IC)=IVEN(IC)-10000+11
      IF(IR.LT.62)IRES(11)=870
      IF(IR.GT.61)IRES(11)=854
      IF(IC.EQ.0)WRITE(LDEV,267)
  267 FORMAT(/" THE ELF KICKED YOU IN THE SHIN AND RAN OFF")
      IF(IC.NE.0)WRITE(LDEV,268)(ITEM(L,IC),L=1,4)
  268 FORMAT(/" THE ELF RAN OFF AFTER STEALING YOUR "4A2)
  270 IF(IRES(ITST(39)).GT.10000.OR.IRES(ITST(39)).EQ.0.OR.ITST(5)
     1.LT.300)GOTO 280
      IF(IROM(IFSD(IRES(ITST(39)))).LT.20000.AND.IFSD(IRES(ITST(39)))
     1.LT.54)GOTO 280
      IRES(10)=IRES(ITST(39))
      IRES(ITST(39))=0
      IF(IR.EQ.IFSD(IRES(10)))WRITE(LDEV,275)(IRSN(L,ITST(39)),L=1,4)
  275 FORMAT(/" IN A MATTER OF SECONDS AND BEFORE YOU CAN DO ",
     1"ANYTHING, THE "4A2/" GROWS HAIR, FANGS AND CLAWS GROTESQUELY ",
     2"AND TRANSFORMS INTO A WEREWOLF.")
  280 IF((IR.EQ.IFSD(IRES(10))).AND.(ITST5-1.NE.ITST(13))
     1.AND.(IRES(10).LT.10000))CALL EXEC(8,NAME,LU,285,0)
      R=RN(R)
      IC=R*3
      R=RN(R)
      ID=R*8+2
      IF(ITD(IVEN(35)).EQ.5.AND.IC.NE.0.AND.IWRD(6,1).EQ.1)
     1CALL EXEC(8,NAME,LU,287,ID)
      IF(IR.EQ.52.AND.IFSD(IRES(4)).EQ.52)IXT(258)=0
      IF(IVEN(53).GT.20000.OR.IR.EQ.1.OR.IR.EQ.20.OR.IR.EQ.25)GOTO 295
      DO 290 I=2,17
      IF(I.EQ.4.OR.I.EQ.15.OR.IFSD(IRES(I)).NE.IR)GOTO 290
      WRITE(LDEV,293)(IRSN(L,I),L=1,4)
      GOTO 295
  290 CONTINUE
  293 FORMAT(/" YOU NOTICED THAT YOU WERE BEING LAUGHED AT BY THE "4A2)
  295 IF(IWRD(6,1).EQ.21.OR.IWRD(6,1).EQ.22.OR.IWRD(6,1).EQ.24.OR.
     1IWRD(6,1).EQ.25.OR.IWRD(6,1).EQ.26.OR.IWRD(6,1).EQ.27)
     1CALL MMRL
  296 IF(IWRD(6,1).LT.18)NAME(2)=MOVEAS("SC")
      IF(IWRD(6,1).GT.17.AND.IWRD(6,1).LT.36)NAME(2)=MOVEAS("SF")
      IF(IWRD(6,1).GT.35.AND.IWRD(6,1).LT.54)NAME(2)=MOVEAS("SH")
      IF(IWRD(6,1).GT.53)NAME(2)=MOVEAS("SJ")
      IF(INUM.EQ.1.AND.IWRD(6,1).EQ.25)NAME(2)=MOVEAS("SC")
      IWRD(7,1)=INUM
      CALL EXEC(8,NAME,0,0,0)
 9999 CONTINUE
      NAME(2)=MOVEAS("SD")
      CALL EXEC(8,NAME,LU,11111,0)
      STOP
      END
$CONTROL SEGMENT=MMSC
      SUBROUTINE MMSC
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      DIMENSION MSG(45),IMZ(3),MSGR(45),ITIM(5)
      INTEGER MOVEAS
      IFSD(I)=I-(I/100)*100
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      RN(R)=R*7.7-INT(R*7.7)
      LU=IPR(1)
      IR=ITST(1)
      R=RND
      NAME(2)=MOVEAS("SD")
      IF(ITST(5).GT.300.AND.IWRD(6,1).GT.3.AND.IWRD(6,1).LT.12)
     1CALL EXEC(8,NAME,LU,290,0)
      IF(IWRD(7,1).EQ.1.AND.IWRD(6,1).EQ.25)GOTO 1142
      GOTO(1000,300,400,600,500,700,600,600,500,700,600,900,970,950),
     1IWRD(6,1)
  300 IF(IWRD(7,1).NE.1)GOTO 310
      IWRD(7,1)=2
      IWRD(5,2)=2
      IWRD(6,2)=5
      GOTO 1000
  310 IF(IWRD(7,1).EQ.2)GOTO 330
      IF((IWRD(7,1).GT.3).OR.(IWRD(5,2).NE.5).OR.
     1(IWRD(6,2).NE.5))CALL EXEC(8,NAME,LU,320,0)
      IWRD(5,2)=IWRD(5,3)
      IWRD(6,2)=IWRD(6,3)
  330 IF(IWRD(5,2).NE.3)CALL EXEC(8,NAME,LU,320,0)
      IF(IVEN(15).LT.20000.OR.IWRD(6,2).NE.77.OR.(IR.NE.93.AND.
     1IR.NE.94.AND.IR.NE.95.AND.IR.NE.96.AND.IR.NE.70.AND.IR.NE.66.AND.
     2IR.NE.67.AND.IR.NE.92))GOTO 335
      IRB=ITST(1)
      ITST(14)=IRB
      IF(ITST(1).EQ.93)IR=92
      IF(ITST(1).EQ.94)IR=66
      IF(ITST(1).EQ.95)IR=70
      IF(ITST(1).EQ.96)IR=67
      IF(ITST(1).EQ.67)IR=96
      IF(ITST(1).EQ.70)IR=95
      IF(ITST(1).EQ.66)IR=94
      IF(ITST(1).EQ.92)IR=93
      ITST(1)=IR
      GOTO 1141
  335 IF(IWRD(6,2).EQ.77.AND.(IR.EQ.66.OR.IR.EQ.67.OR.IR.EQ.70.OR.
     1IR.EQ.92.OR.IR.EQ.93.OR.IR.EQ.94.OR.IR.EQ.95.OR.IR.EQ.96))
     2CALL EXEC(8,NAME,LU,340,0)
      IF(IWRD(6,2).EQ.77)CALL EXEC(8,NAME,LU,350,0)
      IF((IWRD(6,2).EQ.78).AND.(IR.NE.97).AND.
     1(IR.NE.98))CALL EXEC(8,NAME,LU,360,0)
      IF(IWRD(6,2).EQ.78)CALL EXEC(8,NAME,LU,370,0)
      IF(IWRD(6,2).EQ.93.AND.IR.NE.93)CALL EXEC(8,NAME,LU,390,0)
      IF(IWRD(6,2).EQ.93)CALL EXEC(8,NAME,LU,385,0)
      CALL EXEC(8,NAME,LU,320,0)
  400 IF(IWRD(7,1).GT.1.AND.IWRD(5,2).NE.3.AND.IWRD(6,2).NE.93)
     1CALL EXEC(8,NAME,LU,320,0)
      IWRD(7,1)=2
      IWRD(6,1)=1
      IWRD(5,2)=2
      IF(IR.EQ.93.OR.IR.EQ.91)IWRD(6,2)=1
      IF(IR.EQ.95)IWRD(6,2)=3
      IF(IWRD(6,2).NE.0)GOTO 1000
      CALL EXEC(8,NAME,LU,410,0)
  500 IF(IR.EQ.17)GOTO 800
      IF((IR.LT.55).OR.(IR.GT.83))CALL EXEC(8,NAME,LU,520,0)
      ITST(1)=54
      IR=54
      WRITE(LDEV,720)
      GOTO 1141
  600 IF(IR.EQ.98)CALL EXEC(8,NAME,LU,520,0)
      ITST(1)=98
      IR=98
      WRITE(LDEV,720)
      GOTO 1141
  700 IF(IR.EQ.17)GOTO 800
      IF((IR.LT.54).OR.(IR.GT.83))CALL EXEC(8,NAME,LU,520,0)
      IF(IWRD(6,1).EQ.6)IR=81
      IF(IWRD(6,1).EQ.10)IR=82
      ITST(1)=IR
      WRITE(LDEV,720)
  720 FORMAT(/" YOU ARE ENVELOPED IN A CLOUD OF SMOKE THAT QUICKLY ",
     1"DISAPPEARS")
      GOTO 1141
  800 IF((IWRD(6,1).EQ.5.AND.IVEN(88).NE.17).OR.(IWRD(6,1).EQ.6.AND.
     1IVEN(88).NE.117).OR.(IWRD(6,1).EQ.9.AND.IVEN(88).NE.217).OR.
     2(IWRD(6,1).EQ.10.AND.IVEN(88).NE.317))CALL EXEC(8,NAME,LU,520,0)
      IF(IVEN(88).EQ.1017)CALL EXEC(8,NAME,LU,520,0)
      IVEN(88)=IVEN(88)+100
      IF(IVEN(88).EQ.417)CALL EXEC(8,NAME,LU,810,0)
      CALL EXEC(8,NAME,LU,1040,0)
  900 IF(IWRD(7,1).NE.1)CALL EXEC(8,NAME,LU,320,0)
      IF(IR.LT.28.OR.(IR.GT.80.AND.IR.LT.97))CALL EXEC(8,NAME,LU,910,0)
      IF(IVEN(32).LT.20000)CALL EXEC(8,NAME,LU,920,0)
      R=RN(R)
      IF(IR.LT.62.OR.(IR.GT.80.AND.IR.LT.97).OR.(IR.GT.65.AND.IR.LT.78)
     1.OR.R.LT..667)CALL EXEC(8,NAME,LU,1040,0)
      IF(IR.EQ.99)IR=28
      IF(IR.EQ.98)IR=33
      IF(IR.EQ.97)IR=34
      IF(IR.EQ.62)IR=43
      IF(IR.EQ.62)IXT(341)=4362
      IF(IR.EQ.63)IR=45
      IF(IR.EQ.63)IXT(342)=4563
      IF(IR.EQ.64)IR=48
      IF(IR.EQ.64)IXT(343)=4864
      IF(IR.EQ.65)IR=50
      IF(IR.EQ.65)IXT(344)=5065
      IF(IR.EQ.78)IR=29
      IF(IR.EQ.78)IXT(345)=2978
      IF(IR.EQ.79)IR=33
      IF(IR.EQ.79)IXT(346)=3379
      IF(IR.EQ.80)IR=29
      IF(IR.EQ.80)IXT(347)=2980
      ITST(1)=IR
      ITST(14)=IR
      WRITE(LDEV,930)
  930 FORMAT(/" YOU DUG AND FELL INTO AN UNDERGROUND TUNNEL")
      GOTO 1141
  950 ITST(22)=ITST(22)+1
      IF(ITST(38).NE.0) NAME(2)=MOVEAS("SB")
      IF(ITST(38).NE.0) CALL EXEC(8,NAME,0,0,0)
      IF(ITST(22).EQ.1)CALL EXEC(8,NAME,LU,960,0)
      CALL EXEC(8,NAME,LU,970,0)
  970 IF (IWRD(5,2).NE.4.OR.IWRD(7,1).NE.2)CALL EXEC(8,NAME,LU,320,0)
      IF(IFSD(IRES(IWRD(6,2))).NE.IR)CALL EXEC(8,NAME,LU,980,0)
      GOTO 1105
 1000 IF(IWRD(7,1).GT.2)CALL EXEC(8,NAME,LU,320,0)
      IC=IWRD(6,2)
      IF(IWRD(7,1).EQ.1)IC=9
      IRX=0
      IF(IWRD(6,2).EQ.110.AND.(IR.EQ.97.OR.IR.EQ.98))IRX=84
      IF(IRX.EQ.84)IR=84
      IF(IRX.EQ.84)ITST(1)=84
      IF(IRX.EQ.84)GOTO 1025
      IF((IWRD(7,1).EQ.2).AND.(IWRD(5,2).NE.2))
     1CALL EXEC(8,NAME,LU,1050,0)
      IF((IC.EQ.11).AND.(ITST(5)-1.NE.ITST(4)-(ITST(4)/1000)
     1*1000.OR.IR.EQ.97.OR.IR.EQ.98))CALL EXEC(8,NAME,LU,1002,0)
      IF(IC.EQ.11)ITST(1)=ITST(14)
      IF(IC.EQ.11)ITST(14)=IR
      IF(IC.EQ.11)IR=ITST(1)
      IF(IC.EQ.11)GOTO 1025
      IF(IC.LT.5.AND.((IR.LT.54..AND.IR.NE.35).OR.IR.EQ.98)
     1.AND.(IVEN(6).LT.20000))CALL EXEC(8,NAME,LU,1005,0)
      IF(IC.LT.7)GOTO 1007
      IC=IC-9+ITST(4)/1000
      IF(IC.GT.4)IC=IC-4
      IF(IC.LT.1)IC=IC+4
 1007 IFC=ITST(4)/1000
      IF(IC.LT.5)ITST(4)=ITST(4)-(ITST(4)/1000)*1000+IC*1000
      DO 1010 J=IC*60-59,IC*60
      IF(IFSD(IXT(J)).EQ.IR)GOTO 1015
 1010 CONTINUE
      CALL EXEC(8,NAME,LU,1105,0)
 1015 IF(J.NE.93.AND.J.NE.212.AND.J.NE.281.AND.J.NE.351)GOTO 1020
      IF(IR.LT.88)GOTO 1020
      DO 1016 K=1,53
      IF(IVEN(K).GT.20000.AND.(J.EQ.281.OR.ITD(IVEN(K)).GT.1))
     1CALL EXEC(8,NAME,LU,1017,0)
 1016 CONTINUE
 1020 IF((IR.LT.55.OR.IR.EQ.90).AND.(IXT(J).GT.20000))
     1CALL EXEC(8,NAME,LU,1021,0)
      IX=0
      IF(IR.EQ.91.AND.ITST(5)-1.NE.ITST(13))IX=99
      IF(IX.EQ.99)ITST(1)=2
      IF(IX.EQ.99)IR=2
      IF(IX.EQ.99)WRITE(LDEV,1023)
 1023 FORMAT(/" YOU JUST FELL THROUGH THE LOOSE BOARDS.")
      IF(IX.EQ.99)GOTO 1025
      R=RN(R)
      IF(R.GT..5.OR.IR.NE.39)GOTO 1024
      IF(R.GT..25)IR=41
      ITST(1)=IR
      WRITE(LDEV,1022)
 1022 FORMAT(/" YOU SLIPPED ON THE LADDER.")
      GOTO 1025
 1024 IF((IR.GT.54).AND.(IXT(J).GT.20000))CALL EXEC(8,NAME,
     1LU,1023,0)
      IRB=ITST(1)
      ITST(14)=IRB
      ITST(1)=ITFD(IXT(J))
      IR=ITST(1)
 1025 ITST(4)=(ITST(4)/1000)*1000+ITST(5)
      IF(IR.EQ.0)CALL EXEC(8,NAME,LU,1026,0)
      IF(IR.EQ.46.AND.IXT(320).EQ.0)CALL EXEC(8,NAME,LU,1027,0)
      IF(IVEN(22).EQ.0.AND.ITST(5)-(ITST(5)/50)*50.LT.10.AND.IR
     1.NE.35)IVEN(22)=100+IR
      IF((IVEN(22).NE.0).AND.(IVEN(22).LT.20000).AND.
     1(ITST(5)-(ITST(5)/50)*50.GT.40).AND.(IFSD(IVEN(22)).NE.
     2IR))IVEN(22)=0
      IF((IR.NE.97.AND.IR.NE.98).OR.IWRD(6,1).EQ.25)GOTO 1045
      DO 1030 I=1,2
      R=RN(R)
      DO 1030 J=1,INT(R*10+10)
      R1=RN(R)
      IC=IXT(60*INT(R1*4)+58+I)
      IF(IR.EQ.98.AND.ITST(17).GT.1.AND.IC.EQ.9798)IC=3598
      IF(IR.EQ.98.AND.ITST(17).LT.2.AND.IC.EQ.3598)IC=9798
      R=RN(R1)
      IXT(60*INT(R1*4)+58+I)=IXT(60*INT(R*4)+58+I)
      IXT(60*INT(R*4)+58+I)=IC
 1030 CONTINUE
      DO 1040 J=1,35
      IF((IVEN(J).GE. 10000).OR.((IFSD(IVEN(J)).NE.IR).AND.
     1(IFSD(IVEN(J)).NE.0)).OR.IVEN(J).EQ.0)GOTO 1040
      IF(IFSD(IVEN(J)).EQ.IR)IVEN(J)=IVEN(J)-IR
      IF(IFSD(IVEN(J)).GT.0)GOTO 1040
      R=RN(R)
      IF(R.GT..1)GOTO 1040
      IVEN(J)=IVEN(J)+IR
 1040 CONTINUE
      IF(IXT(59).EQ.9497.AND.IXT(179).EQ.9897)IXT(59)=9597
      IF(IXT(119).EQ.9297.OR.IXT(119).EQ.9597)IXT(119)=9497
      IF(IXT(179).EQ.9497.AND.IXT(59).EQ.9997)IXT(179)=9297
      IF(IXT(239).EQ.9297.OR.IXT(239).EQ.9597)IXT(239)=9497
      IF(IRES(6).EQ.893.AND.IRES(12).EQ.993)IXT(54)=29293
      IF(IRES(6).EQ.892.AND.IRES(12).EQ.992)IXT(54)=29293
      IF(IXT(54).EQ.29293)IXT(234)=29392
      R=RN(R)
      IF(R.GT..2)GOTO 1045
      R=RN(R)
      DO 1042 J=INT(R*35+1),35
      IF(J.EQ.22)GOTO 1042
      IF(IVEN(J).GT.10000.OR.IFSD(IVEN(J)).NE.0.OR.IVEN(J).EQ.0)
     1GOTO 1042
      WRITE(LDEV,1041)
 1041 FORMAT(/" A WOOD NYMPH RAN BY CARRYING_")
      CALL MMRI(4,J)
      GOTO 1045
 1042 CONTINUE
 1045 IC=1
      IF(IR.LT.42.OR.IR.GT.53.OR.IRES(4).GE.10000
     1.OR.IFSD(IRES(4)).EQ.52)GOTO 1080
      IMZ(1)=0
      IMZ(2)=0
      IMZ(3)=0
      IC=0
      RND=RND*7.7-INT(RND*7.7)
      IX=3*RND+1
      DO 1050 I=1,360
      IF(IFSD(IXT(I)).NE.IFSD(IRES(4)).OR.ITFD(IXT(I)).LT.42.OR.
     1ITFD(IXT(I)).GT.51)GOTO 1050
      IC=IC+1
      IMZ(IC)=I
      IF(IC.EQ.IX)GOTO 1055
 1050 CONTINUE
      GOTO 1080
 1055 RND=RND*7.7-INT(RND*7.7)
      IX=360*RND+1
      DO 1060 J=IX,360
      IF(IXT(J).LT.4100.OR.IFSD(IXT(J)).NE.0)GOTO 1060
      IF((IMZ(1)-1)/60.EQ.(J-1)/60.OR.(IMZ(2)-1)/60.EQ.(J-1)/60.OR.
     1(IMZ(3)-1)/60.EQ.(J-1)/60)GOTO 1060
      IXX=IXT(J)
      IXT(J)=IXT(I)
      IXT(I)=IXX
      GOTO 1075
 1060 CONTINUE
      DO 1070 J=1,IX
      IF(IXT(J).LT.4100.OR.IFSD(IXT(J)).NE.0)GOTO 1070
      DO 1070 K=1,3
      IF((IMZ(1)-1)/60.EQ.(J-1)/60.OR.(IMZ(2)-1)/60.EQ.(J-1)/60.OR.
     1(IMZ(3)-1)/60.EQ.(J-1)/60) GOTO 1070
      IXX=IXT(J)
      IXT(J)=IXT(I)
      IXT(I)=IXX
      GOTO 1075
 1070 CONTINUE
      GOTO 1080
 1075 RND=RND*7.7-INT(RND*7.7)
      IF(IC.LT.2.OR.RND.GT..3)GOTO 1080
      DO 1076 I=1,360
      IF(IFSD(IXT(I)).EQ.ITFD(IXT(J)).AND.ITFD(IXT(I)).EQ.IFSD(IXT(J)))
     1IXT(I)=100*(IXT(I)/100)
 1076 CONTINUE
      IXT(J)=100*(IXT(J)/100)
 1080 IF((IR.GT.35).AND.(IR.LT.41))ITST(12)=ITST(12)-ITST(5)
     1+ITST(13)
      IF((IR.GT.35).AND.(IR.LT.41).AND.(ITST(12).GT.0))
     1WRITE(LDEV,1082)
 1082 FORMAT(/" THE CORRIDOR WALLS ARE CLOSING IN")
      IF((IR.GT.35).AND.(IR.LT.40).AND.(IVEN(17).GT.20000)
     1.AND.(ITST(12).LE. 0))CALL EXEC(8,NAME,LU,1084,0)
      IF((IR.EQ.40).AND.(ITST(12).LE.0))CALL EXEC(8,NAME,LU,1086,0)
      IF((IR.GT.35).AND.(IR.LT.40).AND.(ITST(12).LE. 0))
     1CALL EXEC(8,NAME,LU,1088,0)
      IF((IR.EQ.4).OR.(IR.EQ.41))WRITE(LDEV,1089)
 1089 FORMAT(/" THE CORRIDOR WALLS HAVE OPENED")
      IF((IR.EQ.4).OR.(IR.EQ.41))ITST(12)=4
      IF(IR.EQ.4)IXT(140)=3640
      IF(IR.EQ.4)IXT(314)=3940
      IF(ITST(5).LE.300.OR.IR.LT.55.OR.IR.GT.82)GOTO 1097
      R=RN(R)
      IF(R.GT..5.AND.R.LT..8)WRITE(LDEV,1091)
      IF(R.GT..8.AND.R.LT..95)WRITE(LDEV,1092)
      IF(R.GT..95)CALL EXEC(8,NAME,LU,1093,0)
 1091 FORMAT(/" YOU JUST NOTICED A SNAKE SLITHER BY.")
 1092 FORMAT(/" YOU WERE JUST BITTEN BY A SNAKE THAT RACED BY.")
 1097 IF((IR.EQ.71.OR.IR.EQ.72).AND.IRES(15).LT.10000)WRITE(LDEV,1098)
      IF((IR.EQ.71.OR.IR.EQ.72).AND.IVEN(24).LT.20000.AND.IRES(15).LT.
     110000)CALL EXEC(8,NAME,LU,1097,0)
      IF((IR.EQ.71.OR.IR.EQ.72).AND.IRES(15).LT.10000
     1)CALL EXEC(8,NAME,LU,1096,0)
 1098 FORMAT(/" A WOLF IS RUNNING TOWARDS YOU")
      IF(IR.NE.1)IXT(1)=0
      IF(IR.NE.5)IXT(183)=0
      IF(IR.NE.7)IXT(123)=0
      IF(IR.NE.10)IXT(5)=0
      IF(IR.NE.14)IXT(187)=0
      IF(IR.NE.16)IXT(128)=0
      IF(IR.NE.19)IXT(11)=0
      IF(IR.NE.23)IXT(191)=0
      IF(IR.NE.25)IXT(134)=0
      IF(IR.EQ.93)ITST(17)=0
      IF(IR.EQ.35.AND.IWRD(6,2).EQ.3)ITST(17)=ITST(17)+1
      IF(IR.EQ.35.AND.IWRD(6,2).EQ.1)ITST(17)=ITST(17)-1
      IF(IR.EQ.35.AND.(IFC+IWRD(6,2).EQ.10.OR.IFC
     1+IWRD(6,2).EQ.14))ITST(17)=ITST(17)-1
      IF(IR.EQ.35.AND.(IFC+IWRD(6,2).EQ.8.OR.IFC
     1+IWRD(6,2).EQ.12))ITST(17)=ITST(17)+1
      IF(ITST(17).EQ.1)IXT(47)=9335
      IF(ITST(17).EQ.2)IXT(47)=3535
      IC=100-ITST(17)/10
      ID=ITST(17)/10
      IF(IR.EQ.35.AND.ITST(17)/10.-ITST(17)/10.EQ..0.AND.ITST(5)
     1.LT.300)WRITE(LDEV,1099)IC,ID
 1099 FORMAT(/" YOU PASSED A MILEAGE SIGN THAT READ: BIG CITY"I3,
     1"   MYSTERY MANSION"I3)
      IF(IFD(IVEN(35)).EQ.2.AND.ITD(IVEN(35)).EQ.6)NAME(2)=MOVEAS("SG")
      IF(NAME(2).EQ.MOVEAS("SG"))IVEN(35)=IVEN(35)-100
      IF(NAME(2).EQ.MOVEAS("SG"))CALL EXEC(8,NAME,LU,10210,0)
 1100 DO 1140 J=2,16
      IF(J.EQ.15)GOTO 1140
      IF(IFSD(IRES(J)).EQ.0.OR.IRES(J).GT.10000)GOTO 1140
      IF(IFSD(IRES(J)).EQ.IRB)GOTO 1120
 1105 R=RN(R)
      DO 1110 K=INT(R*6)*60+1,INT(R*6)*60+60
      IF(IFSD(IXT(K)).NE.IFSD(IRES(J)))GOTO 1110
      IF(IXT(K).GT.20000)GOTO 1140
      IRC=IFSD(IRES(J))
      IRES(J)=(IRES(J)/100)*100+ITFD(IXT(K))
      GOTO 1130
 1110 CONTINUE
      GOTO 1140
 1120 IRES(J)=IRES(J)-IRB+IR
      IRC=IRB
 1130 IC=IRES(J)-(IRES(J)/100)*100
      IF((J.EQ.3.OR.J.EQ.14).AND.(IC.GT.26.AND.(ITST(5).LT.400.OR.IFSD
     1(J).NE.IR).OR.IC.EQ.0))IRES(J)=100*(IRES(J)/100)+IRC
      IF(J.EQ.4.AND.(IC.GT.51.OR.IC.LT.43))IRES(4)=100*
     1(IRES(4)/100)+IRC
      IF(J.EQ.5.AND.(IC.EQ.16.OR.(IROM(IC).GE.20000.AND.ITST(5).LT.300)
     1.OR.IC.GT.27.OR.IC.EQ.21))IRES(5)=100*(IRES(5)/100)+IRC
      IF((J.EQ.6.OR.J.EQ.12).AND.(IC.LT.92.OR.IC.EQ.98))IRES(J)=
     1100*(IRES(J)/100)+IRC
      IF((J.EQ.8.OR.J.EQ.2).AND.(IC.LT.9.OR.IC.GT.77))IRES(J)=
     1100*(IRES(J)/100)+IRC
      IF((J.EQ.9.OR.J.EQ.7).AND.((IC.GT.18.AND.IC.LT.54).OR.IC.GT.77))
     1IRES(J)=100*(IRES(J)/100)+IRC
      IF(J.EQ.10.AND.(IC.EQ.98.OR.IC.EQ.78.OR.IC.EQ.80.OR.IC.EQ.88.OR.
     1IC.EQ.83.OR.IC.EQ.0))IRES(10)=100*(IRES(10)/100)+IRC
      IF(J.EQ.13.AND.(IC.LT.29.OR.IC.GT.31))IRES(13)=
     1100*(IRES(13)/100)+IRC
      IF(J.EQ.11.AND.(IC.LT.55.OR.IC.GT.77))IRES(11)=
     1100*(IRES(11)/100)+IRC
      IF(J.EQ.16.AND.(IC.LT.93.OR.IC.GT.96))IRES(16)=
     1100*(IRES(16)/100)+IRC
 1140 CONTINUE
 1141 CONTINUE
      ITST(13)=ITST(5)
      IF(IWRD(6,1).EQ.13)IR=IFSD(IRES(IWRD(6,2)))
      ITST(1)=IR
      IF(IR.EQ.ITST(8).AND.IFSD(IRES(ITST(9))).EQ.IR.AND.(IVEN(ITST(10))
     1.GT.20000.OR.(IFSD(IVEN(ITST(10))).EQ.IR.AND.IVEN(ITST(10)).LT.
     A10000)))CALL EXEC(8,NAME,LU,1145,0)
 1142 DO 1150 I=1,3
      IF(I.EQ.1)K=4
      IF(I.EQ.2)K=19
      IF(I.EQ.3)K=27
      IF(IFD(IVEN(K)).EQ.1.AND.((IVEN(K).LT.10000.AND.IFSD(IVEN(K))
     1.EQ.IR).OR.IVEN(K).GT.20000.OR.(IVEN(K).GT.10000.AND.IVEN(K)
     2.LT.20000.AND.IFSD(IRES(IFSD(IVEN(K)))).EQ.IR))) GOTO 1190
 1150 CONTINUE
      IF((IR.EQ.10).AND.(IVEN(45).GT.1000))GOTO 1190
      IF((IR.EQ.14).AND.(IVEN(89).GT.1000))GOTO 1190
      IF(IVEN(31).GT.21000)GOTO 1190
      IF((IR.GT.53).AND.(ITST(5).LT.300))GOTO 1190
      IF(IR.GT.53)CALL EXEC(8,NAME,LU,1150,1)
      IF((IROM(IR).GT.20000).AND.(ITST(5).LT.300))GOTO 1190
      IF(IROM(IR).GT.20000)CALL EXEC(8,NAME,LU,1150,1)
      IF((ITST(5).LT.300).AND.(IROM(IR).GT.10000))
     1CALL EXEC(8,NAME,LU,1150,2)
      CALL EXEC(8,NAME,LU,1150,0)
 1190 ISC=ITFD(IROM(IR))
      ITST(2)=ITST(2)+ISC-50
      IROM(IR)=IROM(IR)-(ISC*100)+5000
      IF(ISC.LT.50)ITST(3)=ITST(3)-50+ISC
      IC=1
      IF(IR.EQ.35.OR.IR.EQ.54.OR.IR.EQ.71.OR.IR.EQ.72.OR.
     1IR.EQ.81.OR.IR.EQ.82.OR.IR.EQ.85.OR.IR.EQ.94.OR.IR.EQ.96.OR.
     2(IR.EQ.86).OR.(IR.EQ.92).OR.(IR.EQ.91))IC=2
      IF(((IR.GE.73).AND.(IR.LE.77)).OR.(IR.EQ.99))IC=3
      IF(((IR.GE.55).AND.(IR.LE.57)).OR.(IR.EQ.93).OR.
     1(IR.EQ.95))IC=4
      WRITE(LDEV,1200)IPRP(1,IC),(IRNM(L,IFSD(IROM(IR))),L=1,8)
 1200 FORMAT(/" YOU ARE "A2" THE "8A2)
      IF(IVEN(19).GT.21000.AND.(IR.EQ.21.OR.IR.EQ.36.OR.IR.EQ.54
     1.OR.IR.EQ.92))CALL EXEC(8,NAME,LU,213,0)
      IF((ITST(8).EQ.IR).AND.(ITST(10).GT.8).AND.(ITST(10)
     1.LT.13))WRITE(LDEV,1300)
 1300 FORMAT(/" THERE IS BLOOD HERE")
      CALL MMRI(1,0)
      IC=0
      DO 1510 J=1,17
      IF(IR.NE.IFSD(IRES(J)))GOTO 1510
      IF(IC.EQ.0)WRITE(LDEV,1500)(IRSN(L,J),L=1,4)
      IF(IC.EQ.1)WRITE(LDEV,1505)(IRSN(L,J),L=1,4)
 1500 FORMAT(/" YOU ARE HERE WITH: "4A2)
 1505 FORMAT(20X,4A2)
      IC=1
 1510 CONTINUE
      IF(ITST(5).LT.450.AND.(IR.LT.28.OR.IR.GT.64.OR.(IR.GT.34.AND.
     1IR.LT.42).OR.(IR.GT.52.AND.IR.LT.58)))GOTO 1620
      J2=INT(R*240+1)
 1585 DO 1610 J=J2,360
      IF(IFSD(IXT(J)).NE.IR)GOTO 1610
      J1=(J-1)/60+1
      IF((IR.GT.53.AND.IR.NE.98).OR.IVEN(6).GT.20000.OR.IR.EQ.35.
     1.OR.(J1.GT.4))GOTO 1590
      J1=9+J1-ITST(4)/1000
      IF(J1.GT.10)J1=J1-4
      IF(J1.LT.7)J1=J1+4
 1590 WRITE(LDEV,1600)(IDTN(L,J1),L=1,4)
 1600 FORMAT(/" THERE IS A WAY TO GO ",4A2)
      GOTO 1620
 1610 CONTINUE
      IF(J2.EQ.1)GOTO 1620
      J2=1
      GOTO 1585
 1620 CONTINUE
      IF(ISC.NE.50.OR.IWRD(6,1).EQ.25)NAME(2)=MOVEAS("SE")
      IF(NAME(2).EQ.MOVEAS("SE"))CALL EXEC(8,NAME,LU,IR,0)
      NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
      STOP
      END
$CONTROL SEGMENT=MMSD
      SUBROUTINE MMSD
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      DIMENSION ITIM(5),
     1IVAL(52),IRTN(5)
      INTEGER MOVEAS
      IFSD(I)=I-(I/100)*100
      ITD(I)=I/100-(I/1000)*10
      CALL RMPAR(IPR)
      LU=IPR(1)
      IRIT=IPR(2)
      DATA IVAL/3,2,1,2,5,2,10,2,2,1,1,1,1,1,1,1,4,4,1,2,1,1,10,1,1,
     110,1,1,1,4,1,1,1,1,10,10,10,10,10,10,10,10,10,2,5,1,1,10,5,1,0,0/
      DATA IRTN/0,0,0,0,0/
      IF(IRIT.EQ.11111)GOTO 99999
      IF(ITST(9).NE.2.AND.IRES(2).GE.10000)ITST(24)=1
      IF(ITST(9).NE.6.AND.IRES(6).GE.10000)ITST(24)=1
      IF(ITST(9).NE.7.AND.IRES(7).GE.10000)ITST(24)=1
      IF(ITST(9).NE.8.AND.IRES(8).GE.10000)ITST(24)=1
      IF(ITST(9).NE.9.AND.IRES(9).GE.10000)ITST(24)=1
      IF(ITST(9).NE.12.AND.IRES(12).GE.10000)ITST(24)=1
      IF(ITST(9).NE.14.AND.IRES(14).GE.10000)ITST(24)=1
      IF(IRES(5).EQ.0)IRES(5)=100
      IF(ITD(IRES(5)).NE.1.AND.ITST(5).GT.300)ITST(3)=ITST(3)-75
      IF(ITD(IRES(5)).NE.1.AND.ITST(5).GT.300)IRES(5)=IRES(5)+100
      IF(IRIT.EQ.6005)GOTO 80000
  999 IF(IRIT.EQ.110)WRITE(LDEV,110)
  110 FORMAT(/" YOU CLUMSY FOOL! YOU TRIPPED AND DROPPED EVERYTHING.")
      IF (IRIT.EQ.150) WRITE(LDEV,150)
  150 FORMAT(/" A WORD IS TOO LONG")
      IF (IRIT.EQ.170) WRITE(LDEV,170)
  170 FORMAT(/" THERE ARE TOO MANY WORDS")
      IF (IRIT.EQ.160) WRITE(LDEV,160) (IWRD(L,IPR(3)),L=1,4)
  160 FORMAT(/" MY INPUT VOCABULARY DOESN'T INCLUDE THE WORD ",4A2)
      IF(IRIT.EQ.165) WRITE(LDEV,165)
  165 FORMAT(/" WATCH YOUR LANGUAGE!")
      IF(IRIT.EQ.166)WRITE(LDEV,166)
  166 FORMAT(/"I WILL NOT ANSWER ANY QUESTIONS. I ONLY RESPOND TO YOUR ",
     1"ACTIONS.")
      IF(IRIT.EQ.176)WRITE(LDEV,176)
  176 FORMAT(/" YOU COULD NOT HOLD YOUR BREATH ANY LONGER AND DROWNED."/
     1"YOU SHOULD HAVE GONE BACK WHILE YOU COULD.")
      IF(IRIT.EQ.176)GOTO 80000
      IF (IRIT.EQ.180) WRITE(LDEV,180)
  180 FORMAT(/" I EXPECT TO SEE A VERB AS THE FIRST WORD")
      IF(IRIT.NE.185) GOTO 187
      WRITE(LDEV,185)
  185 FORMAT(/" YOU HEAR AN EXPLOSION AND A LOW RUMBLING AS IF SOME OF ",
     1"THE PASSAGES UNDER"/" THE MANSION AND GROUNDS HAVE CAVED-IN.",
     2" YOU ARE BADLY SHAKEN AND THERE IS"/" DISTRUCTION ALL AROUND ",
     3"YOU. YOU CAN SMELL SMOKE.")
      DO 186 J=301,360
  186 IXT(J)=0
      IXT(173)=0
      IXT(26)=0
      IXT(198)=0
      IXT(137)=0
      IXT(46)=0
      IXT(237)=0
      IXT(197)=0
  187 CONTINUE
      IF(IRIT.EQ.189)WRITE(LDEV,189)
  189 FORMAT(/" YOU HAVE SUFFOCATED FROM THE SMOKE AND YOUR BODY IS ",
     1"SLOWLY BEING"/" CONSUMED BY FLAMES AS ALL OF MYSTERY MANSION ",
     2"GOES UP IN SMOKE.")
      IF(IRIT.EQ.189)GOTO 90020
      IF(IRIT.EQ.1017)WRITE(LDEV,1017)
 1017 FORMAT(/" YOU CANNOT QUITE GET THROUGH THE SMALL DOOR.")
      IF(IRIT.EQ.1027)WRITE(LDEV,1027)
 1027 FORMAT(/" YOU ENTERED A TUNNEL FILLED OVER YOUR HEAD WITH THE ",
     1"WATER RUSHING"/" IN FROM THE PRESSURE OF THE INCOMING TIDE.")
      IF(IRIT.EQ.1093)WRITE(LDEV,1093)
 1093 FORMAT(/" YOU JUST STUMBLED INTO THE MIDDLE OF A BUNCH OF ",
     1"POISONOUS SNAKES AND"/" MANY OF THEM BIT YOU AND ARE CRAWLING ",
     2"ALL OVER YOUR DEAD BODY.")
      IF(IRIT.EQ.1093)GOTO 80000
      IF(IRIT.NE.191)GOTO 1199
      WRITE(LDEV,191)
      IC=0
      DO 1190 I=1,52
      IF(IVEN(I).GT.20000)IC=IC+IVAL(I)
 1190 CONTINUE
      WRITE(LDEV,1191)IC
 1191 FORMAT(/" YOUR SCORE INCLUDES"I3" POINTS FOR THE ITEMS YOU HAVE ",
     1"WITH YOU.")
      IF(LU.NE.ITST(21))ITST(2)=ITST(2)+IC
      IF(IXT(52).EQ.0.AND.LU.NE.ITST(21))ITST(2)=ITST(2)+10
      IF(IXT(52).EQ.0)WRITE(LDEV,1192)
 1192 FORMAT(/" YOUR SCORE ALSO INCLUDES 10 POINTS BECAUSE THE TAXI ",
     1"IS WAITING.")
      IF(ITST(2).GT.999)ITST(2)=999
      IF(IXT(52).NE.0)WRITE(LDEV,1193)
 1193 FORMAT(/" NOW YOU HAVE TO WALK TO THE BIG CITY.")
  191 FORMAT(/" YOU HAVE BEATEN THE ODDS AND HAVE DONE THE IMPOSSIBLE. ",
     1"YOU HAVE SURVIVED"/" MYSTERY MANSION AND YOU CAN NOW SEE IT ",
     2"GOING UP IN SMOKE BEFORE YOU.")
      GOTO 90020
 1199 IF (IRIT.EQ.190) WRITE(LDEV,190)
  190 FORMAT(/" I CANNOT DECIPHER TWO VERB TYPE WORDS IN ONE SENTENCE")
      IF(IRIT.EQ.192)WRITE(LDEV,192)
  192 FORMAT(/" I GIVE UP ON YOU. YOU HAVE GOTTEN YOURSELF INTO A ",
     1"SITUATION I CANNOT GET"/" YOU OUT OF.")
      IF(IRIT.EQ.192)GOTO 90020
      IF(IRIT.EQ.213)WRITE(LDEV,213)
  213 FORMAT(/" A SLIGHT BREEZE BLEW OUT YOUR CANDLE.")
      IF(IRIT.EQ.213)IVEN(19)=20200
      IF(IRIT.EQ.244) WRITE(LDEV,244)
  244 FORMAT(/" THE BOMB HAS EXPLODED AND BLOWN YOU TO BITS")
      IF (IRIT.EQ.244) GOTO 80000
      IF(IRIT.EQ.251)WRITE(LDEV,251)
  251 FORMAT(/" THE MURDERER WAS AFRAID YOU WOULD CALL THE POLICE AND ",
     1"HAS KILLED YOU.")
      IF(IRIT.EQ.251) GOTO 80000
      IF(IRIT.EQ.254) WRITE(LDEV,254)
  254 FORMAT(/" THE DWARF JUST THREW A HATCHET AT YOU AND SPLIT YOUR ",
     1"HEAD OPEN")
      IF(IRIT.EQ.254) GOTO 80000
      IF(IRIT.EQ.262) WRITE(LDEV,262)
  262 FORMAT(/" THE VAMPIRE HAS ATTACKED AND SUCKED THE BLOOD OUT ",
     1"OF YOU")
      IF(IRIT.EQ.262) GOTO 80000
      IF(IRIT.EQ.285) WRITE(LDEV,285)
  285 FORMAT(/" THE WEREWOLF HAS ATTACKED YOU AND TORN YOU TO BITS.")
      IF(IRIT.EQ.285) GOTO 80000
      IF(IRIT.EQ.287) WRITE(LDEV,287)IPR(3)
  287 FORMAT(/" THERE ARE"I2" SCREAMING DEMONS IN THE WAY.")
      IF(IRIT.EQ.290)WRITE(LDEV,290)
  290 FORMAT(/" ABSOLUTELY NOTHING HAPPENS!")
      IF (IRIT.EQ.320) WRITE(LDEV,320)
  320 FORMAT(/" I CANNOT FIGURE OUT WHAT YOU ARE TRYING TO SAY")
      IF (IRIT.EQ.340) WRITE(LDEV,340)
  340 FORMAT(/" THE WALL IS TOO HIGH")
      IF (IRIT.EQ.350) WRITE(LDEV,350)
  350 FORMAT(/" I DON'T SEE A WALL AROUND HERE")
      IF (IRIT.EQ.360) WRITE(LDEV,360)
  360 FORMAT(/" YOU HAVE TO BE IN THE WOODS TO CLIMB TREES")
      IF (IRIT.EQ.370) WRITE(LDEV,370)
  370 FORMAT(/" YOU WOULD PROBABLY JUST FALL OUT OF THE TREE. I ",
     1"LOOSE MORE PLAYERS"/" LIKE THAT. SO I CANNOT LET YOU CLIMB ",
     2"ANY TREES.")
      IF (IRIT.EQ.380) WRITE(LDEV,380)
  380 FORMAT(/" THE GARDENER HAS CAUGHT YOU AND FORCEFULLY,",
     1" HAS TAKEN YOU"/" TO THE VERANDA AND HAS TOLD YOU TO ",
     2"LEAVE IF YOU ARE GOING TO ACT"/" LIKE THAT")
      IF(IRIT.EQ.385) WRITE(LDEV,385)
  385 FORMAT(/" THE GATE IS COVERED WITH ALL KINDS OF POINTS AND ",
     1"BARBS AND YOU"/" WOULD NEVER MAKE IT OVER ALIVE.")
      IF (IRIT.EQ.390) WRITE(LDEV,390)
  390 FORMAT(/" YOU ARE NOT BY THE GATE.")
      IF(IRIT.EQ.410)WRITE(LDEV,410)
  410 FORMAT(/" I DIDN'T EXPECT YOU WOULD USE ENTER HERE.")
      IF (IRIT.EQ.510) WRITE(LDEV,510)
  510 FORMAT(/" YOU ARE SUDDENLY SURROUNDED BY SMOKE AND WHEN IT ",
     1"CLEARS YOU SEE"/" THAT YOU ARE ON THE VERANDA")
      IF (IRIT.EQ.520) WRITE(LDEV,520)
  520 FORMAT(/" NOTHING HAPPENS")
      IF (IRIT.EQ.610) WRITE(LDEV,610)
  610 FORMAT(/" YOU ARE SUDDENLY SURROUNDED BY SMOKE AND WHEN IT ",
     1"CLEARS YOU SEE"/" THAT YOU ARE IN THE WOODS")
      IF (IRIT.EQ.710) WRITE(LDEV,710)
  710 FORMAT(/" YOU ARE SUDDENLY SURROUNDED BY SMOKE AND WHEN IT ",
     1"CLEARS YOU SEE"/" THAT YOU ARE ON A BRIDGE")
      IF(IRIT.EQ.810)WRITE(LDEV,810)(IRSN(L,ITST(9)),L=1,4),(IRNM(L,
     1IFSD(IROM(ITST(8)))),L=1,8),(IWP(L),L=1,4)
  810 FORMAT(/" THE SCROLL MAGICALLY UNROLLS ON THE TABLE AND YOU ",
     1"READ THAT THE "4A2/" IS THE MURDERER AND THAT THE SCENE OF THE ",
     2"CRIME IS THE "8A2/" AND THAT THE MURDER WEAPON IS THE "4A2)
      IF(IRIT.EQ.910)WRITE(LDEV,910)
  910 FORMAT(/" YOU CANNOT DIG HERE.")
      IF(IRIT.EQ.920)WRITE(LDEV,920)
  920 FORMAT(/" YOU WON'T GET VERY FAR WITHOUT A SHOVEL.")
      IF(IRIT.EQ.960)WRITE(LDEV,960)
  960 FORMAT(/" LET THAT HAPPEN AGAIN AND THE GAME WILL ABORT")
      IF(IRIT.EQ.970)WRITE(LDEV,970)
  970 FORMAT(/" GAME ABORTED DUE TO NO INPUT")
      IF(IRIT.EQ.970)GOTO 90020
      IF(IRIT.EQ.980)WRITE(LDEV,980)(IRSN(L,IWRD(6,2)),L=1,4)
  980 FORMAT(/" FIRST YOU HAVE TO FIND THE "4A2)
      IF(IRIT.EQ.1002) WRITE(LDEV,1002)
 1002 FORMAT(/" I FORGOT WHERE YOU WERE")
      IF (IRIT.EQ.1005) WRITE(LDEV,1005)
 1005 FORMAT(/" YOU NEED A COMPASS TO TELL CARDINAL POINTS HERE")
      IF(IRIT.EQ.1021) WRITE(LDEV,1021)
 1021 FORMAT(/" THE DOOR IS LOCKED")
      IF(IRIT.EQ.1023) WRITE(LDEV,1023)
 1023 FORMAT(/" THE GATE IS CLOSED")
      IF(IRIT.EQ.1026)WRITE(LDEV,1026)
 1026 FORMAT(/" YOU JUST FELL DOWN THE 500 FOOT CLIFF ONTO THE ROCKS ",
     1"BELOW.")
      IF(IRIT.EQ.1026)GOTO 80000
      IF(IRIT.EQ.1032)GOTO 90060
      IF (IRIT.EQ.1040) WRITE(LDEV,1040)
 1040 FORMAT(/" OKAY.")
      IF (IRIT.EQ.1050) WRITE(LDEV,1050) (IWRD(L,2),L=1,4)
 1050 FORMAT(/" YOU CANNOT GO "4A2)
      IF(IRIT.EQ.1065) WRITE(LDEV,1065) IPR(3)
 1065 FORMAT(/" PROGRAM ERROR AT LINE"I6)
      IF(IRIT.EQ.1084) WRITE(LDEV,1084)
 1084 FORMAT(/" THE AMULET SAVED YOU FROM BEING CRUSHED BY THE WALLS")
      IF(IRIT.EQ.1084) ITST(1)=4
      IF(IRIT.EQ.1086) WRITE(LDEV,1086)
 1086 FORMAT(/" THE CLOSING CORRIDOR WALLS HAVE BLOCKED THE EXITS ",
     1"AND HAVE TRAPPED YOU HERE")
      IF(IRIT.EQ.1086) IXT(314)=0
      IF(IRIT.EQ.1086) IXT(140)=0
      IF(IRIT.EQ.1088) WRITE(LDEV,1088)
 1088 FORMAT(/" THE CLOSING WALLS HAVE CRUSHED YOU")
      IF(IRIT.EQ.1088) GOTO 80000
      IF(IRIT.EQ.1096) WRITE(LDEV,1096)
 1096 FORMAT(/" THE WOLF ATTACKED YOU AND IS BUSY EATING YOUR FOOD")
      IF(IRIT.EQ.1096) IVEN(24)=0
      IF(IRIT.EQ.1096) IRES(15)=ITST(1)
      IF(IRIT.EQ.1097) WRITE(LDEV,1097)
 1097 FORMAT(/" THE WOLF ATTACKED YOU RAVENOUSLY AND KILLED YOU")
      IF(IRIT.EQ.1097) GOTO 80000
      IF (IRIT.EQ.1105) WRITE(LDEV,1105)
 1105 FORMAT(/" YOU CANNOT GO THAT WAY.")
      IF(IRIT.EQ.1145) WRITE(LDEV,1145)(IWP(L),L=1,4),
     1(IRSN(L,ITST(9)),L=1,4)
 1145 FORMAT(/" CONGRATULATIONS! YOU SOLVED THE MYSTERY BY HAVING THE "
     14A2/" WHICH IS THE MURDER WEAPON, AT THE SCENE OF THE CRIME ",
     2"WITH THE "4A2/" WHO IS THE MURDERER")
      IF(IRIT.EQ.1145.AND.ITST(21).NE.LU)ITST(2)=ITST(2)+200
      IF(IRIT.EQ.1145) ITST(8)=0
      IF (IRIT.EQ.1150) WRITE(LDEV,1150)
 1150 FORMAT(/" IT IS DARK HERE")
      IF ((IRIT.EQ.1150) .AND. (IPR(3).EQ.1)) WRITE(LDEV,1151)
 1151 FORMAT(/" IT IS AFTER SUNSET")
      IF ((IRIT.EQ.1150) .AND. (IPR(3).EQ.2)) WRITE(LDEV,1152)
 1152 FORMAT(/" A CURTAIN BLOCKS THE LIGHT")
      IF(IRIT.EQ.10030)GOTO 80000
      IF(IRIT.EQ.13010)WRITE(LDEV,13010)
13010 FORMAT(/" THE POISON DID ITS JOB AND YOU DIED IN A FIT OF AGONY.")
      IF(IRIT.EQ.13010)GOTO 80000
      IF(ITST(21).EQ.LU.OR.ITST(21).EQ.0)GOTO 9999
      LU=ITST(21)
      GOTO 999
 9999 NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
80000 IF(ITST(21).EQ.0.OR.ITST(21).EQ.LU)GOTO 80001
      LU=ITST(21)
      GOTO 999
80001 LU=IPR(1)
      IC=0
      IF(IVEN(1) .GT. 20000) IC=1
      IF(IVEN(18) .GT. 20000) IC=18
      IF(IC .NE. 0) IVEN(IC)=0
80005 IF ((ITST(2) .LT. 100) .AND. (IC.EQ.0)) GOTO 90000
80010 WRITE(LDEV,80020)
80020 FORMAT(/" DO YOU WANT ME TO REINCARNATE YOU?")
      IF(IC.EQ.0) WRITE(LDEV,80022)
80022 FORMAT(/" IT WILL COST YOU 100 POINTS?  ")
      IF(IC .NE. 0) WRITE(LDEV,80024)
80024 FORMAT(/" IT WILL COST YOU NO POINTS SINCE YOU HAD THE ")
      IF(IC.EQ.1)WRITE(LDEV,80025)
80025 FORMAT("RING.")
      IF(IC.EQ.18)WRITE(LDEV,80026)
80026 FORMAT("TALISMAN.")
      READ(IDEV,80030) IANS
80030 FORMAT(A2)
      IF (IANS.EQ.MOVEAS("NO")) GOTO 90020
      IF (IANS.EQ.MOVEAS("YE")) GOTO 80050
      WRITE(LDEV,80040)
80040 FORMAT(/" WHAT? PLEASE ANSWER YES OR NO")
      GOTO 80010
80050 IF(IVEN(4).GT.20000)IVEN(4)=IVEN(4)-20000+193
      IF(IVEN(4).EQ.493.AND.ITST(5).GT.295)IVEN(4)=1493
      DO 80060 J=1,52
      IF (IVEN(J) .GT. 20000) IVEN(J)=IVEN(J)-20000+ITST(1)
80060 CONTINUE
      IF(IRES(16).NE.0)IRES(16)=IRES(16)-IFSD(IRES(16))+95
      ITST(1)=93
      IF(IC.EQ.0.AND.LU.NE.ITST(21)) ITST(2)=ITST(2)-100
      IF(IC.EQ.0) ITST(3)=ITST(3)-100
      WRITE(LDEV,80070)
80070 FORMAT(/" OKAY. I MOVED YOU OUT OF HARM. ENTER LOOK TO SEE ",
     1"WHERE YOU ARE.")
      IF(ITST(21).EQ.LU.OR.ITST(21).EQ.0)GOTO 89999
      LU=ITST(21)
      GOTO 999
89999 NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
90000 WRITE(LDEV,90010)
90010 FORMAT(/" YOU DON'T HAVE ENOUGH POINTS TO REINCARNATE")
90020 WRITE(LDEV,90030) ITST(2),(ICLS(L,1+ITST(2)/85),L=1,4)
90030 FORMAT(/" YOU SCORED"I4" POINTS WHICH RATES YOU AS A "4A2/
     1" SLEUTH.")
      CALL OURTIME(ITIM)
      ITR=60*ITIM(4)+ITIM(3)-60*(ITST(19)/100)-IFSD(ITST(19))
      IF(ITR.LT.0)ITR=ITR+1440
      TG=ITST(5)/25.
C     ADDED TO REMOVE INTEGER OVERFLOW PROBLEM
      IF(ITR/ITST(5).LE.163) GOTO 90031
      IEF=99
      GOTO 90037
90031 IEF=200*ITR/ITST(5)
      IF(IEF.GT.99)IEF=99
90037 WRITE(LDEV,90032)ITR,TG,IEF
90032 FORMAT(/" YOU PLAYED"I4" MINUTES REAL TIME AND"F5.1" HOURS GAME ",.
     1"TIME OR"I3" % UTILIZATION.")
      IF(IRIT.NE.192.AND.ITST(2).LT.700)WRITE(LDEV,90035)
90035 FORMAT(/" BETTER LUCK NEXT TIME.")
      IF(IRIT.EQ.192)WRITE(LDEV,90036)
90036 FORMAT(" HOPE YOU WILL PLAY AGAIN REAL SOON.")
90060 WRITE(LDEV,90070)
90070 FORMAT(1X,"BYE BYE ")
99999 STOP
      END
$CONTROL SEGMENT=MMSE
      SUBROUTINE MMSE
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      INTEGER MOVEAS
      CALL RMPAR(IPR(1))
      LU=IPR(1)
      IR=IPR(2)
      IFC=ITST(4)/1000
      IDN=1
      IDE=2
      IDS=3
      IDW=4
      IF(IVEN(6).LT.20000)IDN=10-IFC
      IF(IDN.EQ.6)IDN=10
      IF(IVEN(6).LT.20000)IDE=11-IFC
      IF(IVEN(6).LT.20000)IDS=12-IFC
      IF(IDS.EQ.11)IDS=7
      IF(IVEN(6).LT.20000)IDW=13-IFC
      IF(IDW.GT.10)IDW=IDW-4
  999 IF(ITST(5) .GT. 450.AND.IR.LT.84)WRITE(LDEV,1000)
 1000 FORMAT(/" EVERYTHING IS IN RUIN AFTER THE EXPLOSION AND CAVE-IN. ",
     1"SMOKE IS EVERYWHERE"/" AND GETTING THICKER. SOME THINGS ARE ",
     2"STILL CRASHING DOWN AROUND YOU.")
      IF(ITST(5).GT.450.AND.IR.LT.84)GOTO 2000
      IF(IR .EQ. 1)WRITE(LDEV,1)
    1 FORMAT(/" THE ROOM IS FURNISHED WITH JUST A COT, A STOOL AND ",
     1"A BENCH WITH A"/" BUNCH OF BANANAS ON IT. THERE IS A PET ",
     2"MONKEY TIED IN ONE CORNER.")
      IF(IR.EQ.1.AND.IVEN(46).NE.1101)WRITE(LDEV,101)
  101 FORMAT(" THERE IS AN EMPTY HOOK FOR THE DUNGEON KEY ON THE WALL.")
      IF(IR.EQ.1.AND.IVEN(46).EQ.1101)WRITE(LDEV,201)
  201 FORMAT(" THERE IS A DUNGEON KEY HANGING FROM A HOOK ON THE WALL.")
      IF(IR.EQ.1)WRITE(LDEV,301)(IDTN(I,IDE),I=1,4)
  301 FORMAT(" IF YOU CANNOT FIND ANY OTHER WAY OUT YOU MIGHT BE ABLE ",
     1"TO GO "4A2/" OUT THE DOOR.")
      IF(IR.EQ.2)WRITE(LDEV,2)(IDTN(I,IDE),I=1,4),(IDTN(J,IDN),J=1,4)
    2 FORMAT(/" THE FURNACE IS WARM AND THERE IS PLENTY OF COAL ",
     1"NEARBY."/" THERE IS SOOT EVERYWHERE WITH FOOT PRINTS GOING "4A2/
     2" ACROSS THE ROOM FROM DOOR TO DOOR AND ALSO GOING "4A2/" OUT ",
     3"ANOTHER DOOR.")
      IF(IR .EQ. 3)WRITE(LDEV,3)(IDTN(I,IDW),I=1,4)
    3 FORMAT(/" THERE IS A STAIRWAY LEADING UP AND SOME WELL WORN ",
     1"STEPS LEADING DOWN INTO"/" THE DARKNESS WHERE YOU CAN HEAR ",
     2"STRANGE SOUNDS. THERE IS ALSO A DOOR LEADING"/X,4A2)
      IF(IR .EQ. 4)WRITE(LDEV,4)
    4 FORMAT(/" THERE IS AN AWKWARD STAIRWAY LEADING UP TO AT LEAST ",
     1"TWO OTHER LEVELS."/" YOU CAN GO ANY DIRECTION BUT DOWN HERE")
      IF(IR .EQ. 5)WRITE(LDEV,5)(IDTN(I,IDS),I=1,4)
    5 FORMAT(/" THERE ARE MANY COFFINS HERE CONTAINING THE REMAINS OF ",
     1"THE ANCESTORS OF"/" MYSTERY MANSION. ALL THE COFFINS APPEAR ",
     2"TO BE UNDISTURBED AND SEALED EXCEPT"/" FOR ONE. UNLESS ",
     3"YOU CAN OPEN A SECRET PANEL, YOU HAVE TO GO "4A2/
     4" TO GET OUT OF HERE.")
      IF(IR .EQ. 6)WRITE(LDEV,6)(IDTN(I,IDN),I=1,4)
    6 FORMAT(/" THE WINE RACKS ARE COMPLETELY EMPTY, PROBABLY FINISHED ",
     1"BY PREVIOUS PLAYERS."/" ALL THAT IS LEFT IS AN EMPTY ",
     2"BARREL AND BROKEN BOTTLES. A DOOR GOING "4A2/" IS THE ONLY ",
     3"WAY OUT OF HERE.")
      IF(IR .EQ. 7)WRITE(LDEV,7)(IDTN(I,IDE),I=1,4)
    7 FORMAT(/" THE ROOM IS CLUTTERED WITH MOSTLY USELESS JUNK. THERE ",
     1"IS A LARGE INTERESTING"/" LOOKING CRATE HERE. YOU CAN GO UP ",
     2"A WELL WORN WOOD LADDER OR "4A2/" THROUGH A HEAVY WOOD ",
     3"DOOR WITH A SMALL WINDOW WITH IRON BARS.")
      IF(IR.EQ.7.AND.IXT(320).NE.0)WRITE(LDEV,107)
  107 FORMAT(" THERE ARE ALSO SOME STEPS CUT IN THE ROCK LEADING DOWN.")
      IF(IR.EQ.7.AND.IXT(320).EQ.0)WRITE(LDEV,207)
  207 FORMAT(" A CAVE-IN BLOCKS THE STEPS LEADING DOWN.")
      IF(IR .EQ. 8)WRITE(LDEV,8)(IDTN(I,IDW),I=1,4)
    8 FORMAT(/" THE SKELETAL REMAINS OF TWO FORMER PLAYERS HANG BY ",
     1"SHACKLES ON THE FAR"/" WALL. BETWEEN THEM IS AN EMPTY SET OF ",
     2"SHACKLES. YOU CAN HEAR THE SQUEAKING OF"/" SEVERAL RATS AS THEY ",
     3"SCURRY ABOUT. THE ONLY WAY OUT IS "4A2/" WHERE YOU CAN HEAR ",
     4"SOMEONE ON THE OTHER SIDE OF THE DOOR THEY JUST CLOSED")
      IF(IXT(184).EQ.0.AND.IR.EQ.8)WRITE(LDEV,108)
  108 FORMAT(" AND LOCKED.")
      IF(IR .EQ. 9)WRITE(LDEV,9)(IDTN(I,IDS),I=1,4)
    9 FORMAT(/" IT LOOKS LIKE THE RATS HAVE GOTTEN INTO MOST OF THE ",
     1"FOOD. YOU CAN GO "4A2/" THROUGH A DOOR LABELED WINE CELLAR ",
     2"OR UP THE LADDER YOU CAME DOWN FROM THE"/" KITCHEN.")
      IF(IR .EQ. 10)WRITE(LDEV,10)(IDTN(I,IDE),I=1,4)
   10 FORMAT(/" IT IS A LARGE AND COMFORTABLE ROOM, WITH A LARGE OIL ",
     1"LAMP ON A STAND IN"/" ONE CORNER. THERE IS A LARGE PICTURE ON ",
     2"ONE WALL. SEEMS LIKE GOING "4A2/" IS THE ONLY WAY OUT.")
      IF(IR .EQ. 11)WRITE(LDEV,11)
   11 FORMAT(/" THERE IS AN OLD CRANK TYPE TELEPHONE ",
     2"ON THE WALL BY THE FRONT DOOR."/" A LARGE WINDOW OVER LOOKS THE ",
     3"GROUNDS IN FRONT OF THE MANSION. THERE "/" ARE FOUR DOORS SO ",
     4"THAT YOU CAN GO LEFT, RIGHT, FORWARD, OR BACKWARD.")
      IF(IR .EQ. 12)WRITE(LDEV,12)(IDTN(I,IDW),I=1,4)
   12 FORMAT(/" THE ROOM IS DILAPIDATED AND HAS THE REMAINS OF VARIOUS ",
     1"OLD STYLE GAMES SUCH"/" AS DARTS, DUCKPINS, SEVERAL CARD GAMES ",
     2"AND AN OLD RADIO. THERE IS A STAIRWAY"/" GOING UP AND DOWN, AS ",
     3"WELL AS A DOOR YOU CAN EXIT BY GOING "4A2)
      IF(IR.EQ.13)WRITE(LDEV,13)(IDTN(I,IDW),I=1,4)
   13 FORMAT(/" THERE IS AN AWKWARD STAIRWAY LEADING UP AND DOWN TO ",
     1"OTHER LEVELS."/" YOU CAN GO IN ANY DIRECTION BUT "4A2)
      IF(IR .EQ. 14)WRITE(LDEV,14)(IDTN(I,IDW),I=1,4)
   14 FORMAT(/" THE ROOM IS HUGE AND EMPTY. THE SLIGHTEST SOUND ECHOES ",
     1"THROUGHOUT THE"/" HALL. A LARGE FIREPLACE WITH SOME FIREWOOD ",
     2"BY IT IS THE ONLY THING OF"/" INTEREST. THERE IS A STAIRWAY ",
     3"LEADING UP AS WELL AS A DOOR ON EACH SIDE"/" OF THE ROOM ",
     4"EXCEPT FOR ONE GOING "4A2)
      IF(IR.EQ.15)WRITE(LDEV,15)(IDTN(I,IDN),I=1,4),(IDTN(J,IDW),J=1,4)
   15 FORMAT(/" YOU HAVE TO GO AROUND ROWS OF TABLES TO GET ",
     1"ANYWHERE. THERE"/" ARE HUNDREDS OF WOODEN INDIANS, WITH ",
     2"DRAWN BOWS, STANDING ON"/" PLATFORMS MOUNTED HIGH ON THE ",
     3"WALLS ALL AROUND THE HALL."/" THERE ARE TWO INTERIOR DOORS ",
     4"YOU CAN USE BY GOING "4A2/" OR "4A2)
      IC=9-ITST(6)/3600
      IF(IR.EQ.16)WRITE(LDEV,16)
   16 FORMAT(/" THERE IS AN ALTAR IN FRONT OF THE CHAPEL WITH SOME ",
     1"COMMUNION WINE ON IT.")
      IF(IR.EQ.16.AND.IVEN(19).EQ.1216)WRITE(LDEV,116)IC
  116 FORMAT(" THERE IS ALSO A BURNING CANDLE ON THE ALTAR ABOUT"
     1I2" INCHES LONG.")
      IF(IR.EQ.16.AND.IVEN(5).EQ.1316)WRITE(LDEV,216)
  216 FORMAT(" A SILVER CROSS ABOUT A FOOT LONG HANGS ON THE WALL ",
     1"BEHIND THE ALTAR.")
      IF(IR.EQ.16.AND.IVEN(5).NE.1316)WRITE(LDEV,316)
  316 FORMAT(" YOU CAN SEE THE OUTLINE OF THE CROSS THAT USE TO ",
     1"HANG ON THE WALL.")
      IF(IR.EQ.16)WRITE(LDEV,416)(IDTN(I,IDE),I=1,4)
  416 FORMAT(" THERE IS A STAIRWELL LEADING DOWN ",
     2"INTO THE DARKNESS AND A WAY TO GO "4A2/" THROUGH ",
     3"AN OPEN ARCH WHERE YOU CAN SEE PART OF A LIBRARY.")
      IF(IR.EQ.17.AND.IVEN(88).NE.1017)WRITE(LDEV,17)
   17 FORMAT(/" YOU ARE STANDING NEXT TO A SMALL STAND WITH AN OLD ",
     1"PAPYRUS SCROLL ON IT.")
      IF(IR.EQ.17.AND.IVEN(88).EQ.1017)WRITE(LDEV,117)
  117 FORMAT(/" YOU ARE NEXT TO THE STAND WITH THE CRUMBLED REMAINS ",
     1"OF THE SCROLL ON IT.")
      IF(IR.EQ.17)WRITE(LDEV,217)(IDTN(I,IDW),I=1,4),(IDTN(J,IDN),J=1,4)
  217 FORMAT(" THERE ARE ROWS OF BOOKSHELVES WHERE SOMEONE COULD ",
     1"HIDE. YOU CAN EXIT "4A2/" THROUGH AN OPEN ARCH WHERE YOU CAN ",
     2"SEE PART OF A CHAPEL, OR "4A2/" THROUGH ONE OF THE TWO ",
     3"MATCHING DOORS AT BOTH ENDS OF THE LIBRARY.")
      IF(IR.EQ.18)WRITE(LDEV,18)(IDTN(I,IDS),I=1,4)
   18 FORMAT(/" IT LOOKS LIKE A GALLEY DESIGNED TO FIX MEALS FOR A ",
     1"LARGE GROUP OF PEOPLE."/" THERE IS A LADDER GOING DOWN ",
     2"AND A DOOR YOU CAN EXIT BY GOING "4A2)
      IF(IR.EQ.19)WRITE(LDEV,19)(IDTN(I,IDE),I=1,4)
   19 FORMAT(/" THIS IS A SMALL CONFINING CLOSET. IT SEEMS YOU CAN ",
     1"ONLY GO "4A2/" THROUGH THE DOOR WHICH OPENS BY ITSELF WHEN ",
     2"NOT LOCKED. THE WALLS,"/" THE FLOORS AND EVEN THE CEILING LOOK ",
     3"LIKE THEY MIGHT HAVE A SECRET"/" PANEL OR A WAY THROUGH THEM.")
      IF(IR.EQ.20)WRITE(LDEV,20)(IDTN(I,IDW),I=1,4),(IDTN(J,IDN),J=1,4),
     1(IDTN(K,IDS),K=1,4)
   20 FORMAT(/" THE ROOM IS VERY MASCULINE. THERE ARE SEVERAL LARGE ",
     1"ANIMAL HEADS"/" MOUNTED ON THE WALLS AS WELL AS OTHER THINGS. ",
     2"YOU CAN GO "4A2/" INTO A SMALL CLOSET, OR YOU CAN EXIT EITHER ",
     3"BY GOING "4A2/" TO THE HALLWAY OR OUTSIDE ON THE FIRE ",
     4"ESCAPE BY GOING "4A2)
      IF(IR.EQ.21)WRITE(LDEV,21)(IDTN(I,IDN),I=1,4),(IDTN(J,IDE),J=1,4)
   21 FORMAT(/" THERE IS A LARGE BELL IN THE CENTER OF THE TOWER WITH ",
     1"A KNOTTED CORD"/" ATTACHED TO THE CLAPPER THAT YOU CAN'T REACH",
     2". YOU CAN GO "4A2/" THROUGH A LONG SLOPING PASSAGE, OR DOWN A ",
     3"CIRCULAR STAIRWAY, OR "4A2/" OUT A LARGE WINDOW OVERLOOKING THE ",
     4"OCEAN BELOW.")
      IF(IR.EQ.22)WRITE(LDEV,22)(IDTN(I,IDW),I=1,4)
   22 FORMAT(/" THERE IS AN AWKWARD STAIRWAY LEADING DOWN TO AT LEAST ",
     1"TWO OTHER LEVELS."/" YOU CAN GO IN ANY DIRECTION BUT UP OR "4A2)
      IF(IR.EQ.23)WRITE(LDEV,23)(IDTN(I,IDN),I=1,4)
   23 FORMAT(/" THERE ARE MANY PILES OF DIRT ON THE FLOOR. YOU COULD GO",
     1" IN ANY "/" DIRECTION BUT UP. IT IS A VERY LONG HALLWAY WITH ",
     2"A SMALL WINDOW"/" AT THE FAR END YOU CAN SEE BY LOOKING "4A2)
      IF(IR.EQ.24)WRITE(LDEV,24)(IDTN(I,IDN),I=1,4),(IDTN(J,IDW),J=1,4),
     1(IDTN(K,IDS),K=1,4)
   24 FORMAT(/" THIS IS THE BEDROOM OF AN OLDER WOMAN, WITH A SEWING ",
     1"MACHINE, A LARGE"/" MIRROR AND A DRESS FORM, AMONG OTHER ",
     2"THINGS. YOU CAN GO "4A2/" INTO A CLOSET, OR YOU CAN EXIT THE ",
     3"ROOM BY GOING EITHER "4A2/" OR "4A2)
      IF(IR.EQ.25)WRITE(LDEV,25)
   25 FORMAT(/" THE ROOM IS VERY FEMININE WITH FRILLY CURTAINS. ",
     1"RIGHT IN FRONT OF")
      IF(IR.EQ.25.AND.IVEN(30).NE.325)WRITE(LDEV,125)
  125 FORMAT(" YOU IS A SOFT COMFORTABLE CANOPY BED WITH A SMALL ",
     1"INDENTATION RIGHT")
      IF(IR.EQ.25.AND.IVEN(30).EQ.325)WRITE(LDEV,225)
  225 FORMAT(" YOU IS A SOFT COMFORTABLE CANOPY BED WITH THE GLOBE ",
     1"RESTING GENTLY")
      IF(IR.EQ.25)WRITE(LDEV,325)(IDTN(I,IDE),I=1,4)
  325 FORMAT(" IN THE MIDDLE. THE ONLY WAY YOU CAN SEE TO EXIT IS ",
     1"GOING "4A2)
      IF(IR.EQ.26)WRITE(LDEV,26)(IDTN(I,IDS),I=1,4),(IDTN(J,IDW),
     1J=1,4),(IDTN(L,IDE),L=1,4)
   26 FORMAT(/" THERE IS A SMALL WINDOW HERE BUT IT WOULD GET DARK IF ",
     1"YOU WERE TO GO "4A2/" TO THE OTHER END OF THE HALL. YOU CAN ",
     2"ENTER A DOOR BY GOING "4A2/" OR "4A2)
      IF(IR.EQ.27.OR.IR.EQ.88)WRITE(LDEV,27)(IDTN(I,IDS),I=1,4)
   27 FORMAT(/" THIS CLOSET IS LARGE AND FEATURELESS, EXCEPT FOR A ",
     1"PILE OF RAGS IN ONE"/" CORNER AND A SMALL DOOR IN THE WALL ",
     2"ON THE LEFT AS YOU ENTERED. YOU"/" CAN SEE NO OTHER WAY OUT ",
     3"EXCEPT THE DOOR GOING "4A2)
      IF ((IR .GT. 27) .AND. (IR .LT. 35))WRITE(LDEV,28)
   28 FORMAT(/" YOU ARE IN A MAZE OF TWISTY LITTLE PASSAGES. THE ",
     1"PASSAGES ARE LOW"/" AND YOU HAVE TO STOOP TO GET AROUND. ",
     2"THERE IS EVIDENCE THAT SOMEBODY OR"/" SOMETHING SPENDS A LOT ",
     3"OF TIME HERE.")
      IF(IR.EQ.35.AND.ITST(17).LT.10)WRITE(LDEV,35)
   35 FORMAT(/" THE HIGHWAY GOES STRAIGHT SOUTH AS FAR AS YOU CAN SEE ",
     1"BETWEEN THE DENSE"/" FOREST TO THE WEST AND A 500 FOOT SHEER ",
     2"CLIFF TO THE EAST.")
      IC=ITST(17)*200
      IF(IR.EQ.35.AND.ITST(17).LT.5)WRITE(LDEV,135)IC
  135 FORMAT(" THE MANSION GATE IS ABOUT"I4" YARDS TO THE NORTH.")
      IF(IR.EQ.35.AND.ITST(17).GT.4.AND.ITST(17).LT.10)WRITE(LDEV,235)
  235 FORMAT(" YOU CAN JUST SEE THE GATE TO THE NORTH.")
      IF(IR.EQ.35.AND.ITST(17).GE.10)WRITE(LDEV,335)
  335 FORMAT(" IT GOES STRAIGHT NORTH AND SOUTH AS FAR AS YOU CAN SEE.")
      IF(IR .EQ. 36)WRITE(LDEV,36)
   36 FORMAT(/" THE WALLS AND FLOOR ARE DAMP AND COVERED WITH A SLIMY ",
     1"KIND OF MOSS MAKING"/" IT SLIPPERY AND SLOW GOING. THE WALL TO ",
     2"THE LEFT AS YOU LOOK DOWN THE CORRIDOR"/" SEEMS TO BE MOVING ",
     3"TOWARD YOU AND THERE IS A DOOR TO THE RIGHT. A COLD"/" BREEZE ",
     4"BLOWS OUT INTO THE SECRET PASSAGE.")
      IF(IR .EQ. 37)WRITE(LDEV,37)
   37 FORMAT(/" ALMOST ALL YOU CAN SEE ARE THE SLIMY WALLS AND FLOOR. ",
     1"THE CORRIDOR QUICKLY"/" TURNS TO A GLOOMY DARKNESS GOING DOWN ",
     2"BUT YOU CAN SEE THE SECRET PASSAGE. IT"/" IS QUIET EXCEPT ",
     3"FOR AN OCCASIONAL DROP OF WATER DRIPPING FROM THE CEILING.")
      IF(IR .EQ. 38)WRITE(LDEV,38)
   38 FORMAT(/" YOU MUST BE OVER HALFWAY DOWN THE CORRIDOR BECAUSE YOU ",
     1"CAN BARELY SEE A"/" LADDER AT THE LOWER END AND THE SECRET ",
     2"PASSAGE AT THE OTHER END.")
      IF(IR .EQ. 39)WRITE(LDEV,39)
   39 FORMAT(/" YOU ARE AT THE LOWER END OF THE CORRIDOR. A LADDER ",
     1"LEADS UP AND DOWN."/" THE RUNGS OF THE LADDER ARE COVERED ",
     2"WITH THE SAME SLIMY MOSS.")
      IF(IR .EQ. 40)WRITE(LDEV,40)
   40 FORMAT(/" YOU ARE IN A LONG PASSAGE PARRALLEL TO THE CORRIDOR. ",
     1"THE FLOOR IS CLEAN"/" AND DRY HERE, MAKING IT EASY TO GET ",
     2"AROUND; ESPECIALLY TO THE OTHER END.")
      IF(IR.EQ.40.AND.IXT(140).NE.0)WRITE(LDEV,140)(IDTN(I,IDS),I=1,4)
  140 FORMAT(" YOU CAN GO DOWN A LADDER AT THE OTHER END OR ",
     1"YOU CAN GO "4A2/" OUT THE DOOR NEXT TO YOU.")
      IF(IR.EQ.40.AND.IXT(140).EQ.0)WRITE(LDEV,240)
  240 FORMAT(" THE CORRIDOR WALLS HAVE CLOSED AND BLOCKED ALL THE ",
     1"EXITS.")
      IF(IR .EQ. 41)WRITE(LDEV,41)
   41 FORMAT(/" YOU ARE IN A LARGE TREASURE ROOM. IT LOOKS LIKE THERE ",
     1"USE TO BE A LOT"/" OF VALUABLE ARTICLES HERE ONCE. YOU NOTICE ",
     3"A SMALL CAVITY IN THE MIDDLE"/" OF A DRAWING ON THE WALL. ",
     2"THERE IS A LADDER GOING UP, WHICH IS ALL SLIMY.")
      IF(IR.EQ.41.AND.IXT(320).EQ.0)WRITE(LDEV,141)
  141 FORMAT(" THERE ARE STEPS CARVED IN THE SIDES OF A HUGE SHAFT ",
     1"LEADING DOWN.")
      IF(IR.GT.41.AND.IR.LT.52.AND.IXT(320).NE.0)WRITE(LDEV,42)
   42 FORMAT(/" YOU ARE IN A MAZE OF LARGE PASSAGES. SOME OF THE ",
     1"PASSAGES LOOK"/" FRESHLY DUG. THERE ARE LARGE ODD LOOKING ",
     2"FOOT PRINTS EVERYWHERE"/" AND A FEW BONES HERE AND THERE.")
      IF(IR.GT.41.AND.IR.LT.51.AND.IXT(320).EQ.0)WRITE(LDEV,142)
  142 FORMAT(/" YOU ARE IN A CAVERN DEEP BELOW THE MANSION. A LOT ",
     1"OF WORK HAS"/" GONE INTO CARVING STEPS AND TUNNELS IN THE ",
     2"ROCK WALLS AND FLOOR."/" THERE ARE LOOSE ROCKS EVERYWHERE.")
      IF(IR.EQ.52.AND.IXT(320).NE.0)WRITE(LDEV,52)(IWP(L),L=1,4)
   52 FORMAT(/" THERE ARE MANY BONES SCATTERED ABOUT, SOME OF WHICH ",
     1"LOOK HUMAN."/" THERE IS A MESSAGE WRITTEN IN BLOOD ON ONE WALL ",
     2"THAT SAYS THE"/" MURDER WAS COMMITTED WITH THE "4A2)
      IF(IR.GT.50.AND.IR.LT.54.AND.IXT(320).EQ.0)WRITE(LDEV,152)
  152 FORMAT(/" THE ROOM WAS CARVED OUT OF SOLID ROCK A LONG LONG ",
     1"TIME AGO.")
      IF((IR.EQ.51.OR.IR.EQ.53).AND.IXT(320).EQ.0)WRITE(LDEV,51)
   51 FORMAT(" THERE IS A TROLL SLEEPING FITFULLY IN ONE CORNER ",
     1"AND IS OBVIOUSLY "/" TOO LARGE TO FIT DOWN THE ONLY EXIT IN ",
     2"THE MIDDLE OF THE ROOM.")
      IF(IR.EQ.51.AND.IVEN(42).EQ.1151)WRITE(LDEV,151)
  151 FORMAT(" IT HAS A RUBY NECKLACE DANGLING FORM ONE HAND AND A ",
     1"BLUDGEON IN THE OTHER.")
      IF(IR.EQ.51.AND.IVEN(40).EQ.1151)WRITE(LDEV,251)
  251 FORMAT(" NEXT TO THE TROLL IS AN ANIMATED STATUE OF A BEAUTIFUL ",
     1"NAKED WOMAN THAT"/" IS PART BIRD AND IS SINGING PEACEFULLY AND ",
     2"SEDUCTIVELY WHILE SHE ENTICES"/" YOU WITH SEVERAL DIAMONDS ",
     3"CUPPED IN HER OUTSTRETCHED HANDS.")
      IF(IR.EQ.51.AND.IXT(320).EQ.0)WRITE(LDEV,351)
  351 FORMAT(" ACROSS FROM THE TROLL IS A GOLD FIGURINE OF A BULL ON ",
     1"A PILE OF GOLD BARS.")
      IF(IR.EQ.53.AND.IVEN(39).EQ.1253)WRITE(LDEV,153)
  153 FORMAT(" IT HAS A SILVER GOBLET RESTING IN ONE HAND AND A ",
     1"BLUDGEON IN THE OTHER.")
      IF(IR.EQ.53.AND.IVEN(37).EQ.1153)WRITE(LDEV,253)
  253 FORMAT(" NEXT TO THE TROLL IS A STONE IDOL WITH A LARGE EMERALD ",
     1"FOR ONE EYE.")
      IF(IR.EQ.53.AND.IXT(320).EQ.0)WRITE(LDEV,353)
  353 FORMAT(" ACROSS FROM THE TROLL IS A SACRIFICIAL STONE SLAB ",
     1"WITH A DAGGER IN IT.")
      IF(IR .EQ. 53.AND.IXT(320).NE.0)WRITE(LDEV,53)
   53 FORMAT(/" THIS CAVE IS ABOVE THE DOMAIN OF THE GIANT MOLE. AS ",
     1"LONG AS YOU ARE"/" NEAR, HE WILL CONSTANTLY CHANGE HIS TUNNELS ",
     2"TRYING TO CONFUSE YOU IF HE CAN."/" THERE IS A PATH LEADING UP ",
     3"AND DOWN.")
      IF(IR.EQ.52.AND.IXT(320).EQ.0)WRITE(LDEV,252)
  252 FORMAT(" IT IS EMPTY EXCEPT FOR SEVERAL BOULDERS AND SOME ",
     2"SKELETONS COVERED WITH"/" CRABS. THE FLOOR IS UNEVEN, ",
     3"BEING FULL OF CRATERS.")
      IF(IR.EQ.52.AND.IXT(320).EQ.0.AND.IXT(319).NE.0)WRITE(LDEV,452)
  452 FORMAT(" THE ONLY WAY OUT IS DOWN THE TUNNEL THAT IS IN THE ",
     1"MIDDLE OF THE DEN.")
      IF (IR .EQ. 54)WRITE(LDEV,54)
   54 FORMAT(/" A LARGE GARDEN WITH HIGH HEDGES STRETCHES AROUND YOU.",
     1" THE MAIN PATH"/" GOES NORTH WITH A ONEWAY EXIT GATE ON ",
     2"EACH SIDE. A SIGN SAYS THAT"/" THE GARDEN CLOSES AT SUNSET ",
     3"FOR YOUR SAFETY.")
      IF(IR .EQ. 55)WRITE(LDEV,55)
   55 FORMAT(/" A SIGN SAYS: DON'T PICK THE FLOWERS,NO SWIMMING,AND ",
     1"STAY OFF THE GRASS."/" YOU CAN GO SOUTH TO THE VERANDA OR ",
     2"EAST OR WEST.")
      IF((IR .EQ. 56) .OR. (IR .EQ. 57))WRITE(LDEV,56)
   56 FORMAT(/" A SIGN SAYS: HOPE YOU ENJOYED YOUR VISIT. YOU CAN GO ",
     1"NORTH INTO THE GARDEN"/" OR YOU CAN GO ONTO THE VERANDA.")
      IF((IR .GE. 58) .AND. (IR .LE. 63))WRITE(LDEV,58)
   58 FORMAT(/" HIGH HEDGES BLOCK THE VIEW AROUND YOU BUT YOU CAN SEE ",
     1"SOME OF THE"/" GARGOYLES ALONG THE ROOF OF THE MANSION. THERE ",
     2"ARE PATHS GOING IN SEVERAL"/" DIRECTIONS.")
      IF((IR .EQ. 64) .OR. (IR .EQ. 65))WRITE(LDEV,64)
   64 FORMAT(/" YOU ARE ON THE SOUTHERN EDGE OF A GRASSY MEADOW.")
      IF(IR .EQ. 66)WRITE(LDEV,66)
   66 FORMAT(/" YOU ARE ON THE WESTERN EDGE OF THE GRASSY MEADOW.")
      IF(IR .EQ. 67)WRITE(LDEV,67)
   67 FORMAT(/" YOU ARE ON THE EASTERN EDGE OF THE GRASSY MEADOW. ",
     1"THE WALL"/" IS TO THE EAST BUT PATHS GO EVERY OTHER WAY.")
      IF(IR .EQ. 68)WRITE(LDEV,68) (IVRB(L,7),L=1,3)
   68 FORMAT(/" YOU ARE ON THE NORTHERN EDGE OF THE GRASSY MEADOW ",
     1"AND THE WESTERN EDGE"/" OF A POND. AS YOU LOOK UP YOU CAN SEE ",
     2"THE WORD "3A2"WRITTEN UNDERNEATH"/" A BRIDGE CROSSING THE POND.")
      IF(IR .EQ. 69)WRITE(LDEV,69) (IVRB(L,11),L=1,3)
   69 FORMAT(/" YOU ARE ON THE NORTHERN EDGE OF A GRASSY ",
     1"MEADOW AND THE"/" EASTERN EDGE OF A POND. AS YOU LOOK UP YOU ",
     2"CAN SEE THE WORD"/X,3A2"WRITTEN UNDERNEATH A BRIDGE CROSSING ",
     3"THE POND")
      IF(IR.EQ.70)WRITE(LDEV,70)
   70 FORMAT(/" YOU ARE ON THE NORTHERN SHORE OF THE POND. THE WALL ",
     1"IS TO THE NORTH.")
      IF(IR.EQ.71.OR.IR.EQ.72)WRITE(LDEV,71)
   71 FORMAT(/" THE GRASS IS TALL AND THERE ARE MANY BUSHES AROUND.")
      IF(IR.GT.63.AND.IR.LT.73.AND.IR.NE.67.AND.IR.NE.70)
     1WRITE(LDEV,164)
  164 FORMAT(" YOU CAN GO IN ANY DIRECTION FROM HERE.")
      IF((IR .EQ. 73) .OR. (IR .EQ. 74))WRITE(LDEV,73)
   73 FORMAT(/" THE FOUNTAIN HAS NOT BEEN USED IN YEARS AND IS DRY. ",
     1"THE IS A PATH IN"/" EACH DIRECTION BUT NORTH.")
      IF(IR .EQ. 75)WRITE(LDEV,75)
   75 FORMAT(/" THE WELL IS DEEP AND DARK. PATHS GO EAST AND WEST.")
      IF(IR .EQ. 76)WRITE(LDEV,76)
   76 FORMAT(/" YOU ARE ON THE EASTERN EDGE OF A GRASSY MEADOW. ",
     1"PATHS GO NORTH AND WEST.")
      IF(IR .EQ. 77)WRITE(LDEV,77)
   77 FORMAT(/" YOU ARE ON THE WESTERN EDGE OF A GRASSY MEADOW. ",
     1"PATHS GO NORTH AND EAST.")
      IF(IRES(15).LT.10000.AND.((IR.GT.63.AND.IR.LT.70).OR.
     1IR.EQ.76.OR.IR.EQ.77))WRITE(LDEV,177)
  177 FORMAT(" AS YOU LOOK OUT OVER THE GRASSY MEADOW YOU CAN SEE ",
     1"SOMETHING MOVING"/" TOWARD YOU IN THE GRASS.")
      IF((IR .EQ. 78) .OR. (IR .EQ. 80))WRITE(LDEV,78)
   78 FORMAT(/" THE WALLS ARE SLIPPERY AND YOU CANNOT GET OUT.")
      IF(IR .EQ. 79)WRITE(LDEV,79)
   79 FORMAT(/" IT IS DRY HERE. THE WALLS ARE MADE WITH UNEVEN BRICKS ",
     1"YOU CAN EASILY CLIMB.")
      IF(IR .EQ. 81)WRITE(LDEV,81) (IVRB(L,10),L=1,3)
   81 FORMAT(/" YOU ARE OVER A SMALL POND. AS YOU CROSS ",
     1"YOU CAN SEE THE "/" WORD "3A2"REFLECTED IN THE WATER. ",
     2"THE BRIDGE GOES NORTH AND SOUTH.")
      IF(IR .EQ. 82)WRITE(LDEV,81) (IVRB(L,6),L=1,3)
      IF(IR.EQ.83)WRITE(LDEV,83) (IVRB(L,8),L=1,3),(IVRB(L,4),L=1,3)
   83 FORMAT(/" YOU ARE WAIST DEEP IN WATER. YOU CAN SEE TWO ",
     1"BRIDGES WITH THE WORDS"/X,3A2"AND "3A2"WRITTEN UNDERNEATH ",
     2"THEM. THE BANKS ARE STEEP AND YOU"/" CANNOT GET OUT.")
      IF (IR .EQ. 84)WRITE (LDEV,84)
   84 FORMAT(/" YOU ARE STANDING IN THE MIDDLE OF A SMALL COTTAGE ON ",
     1"A PLATEAU ON"/" THE SIDE OF THE CANYON. AS YOU LOOK AROUND, ",
     2"YOU CAN SEE A")
      IF(IR.EQ.84.AND.IVEN(28).EQ.1184)WRITE(LDEV,184)
  184 FORMAT(" SMALL ROAD MAP LIGHTLY TACKED TO ONE WALL. ALSO, ",
     1"THERE ARE SOME")
      IF(IR.EQ.84.AND.IVEN(28).NE.1184)WRITE(LDEV,284)
  284 FORMAT(" MESSAGE ON THE WALL WHERE THE MAP USE TO BE THAT SAYS: ",
     1"GO CRAZY"/" IN THE WOODS TO GET QUICK ASYLUM HERE. ALSO, ",
     2"THERE ARE SOME")
      IF(IR.EQ.84)WRITE(LDEV,384)
  384 FORMAT(" STEPS GOING OUT THE BACK DOOR TO A PATH CONTINUING ",
     3"UP THE"/" EMBANKMENT. THERE IS ALSO THE WAY YOU CAME IN, BUT",
     4" THAT JUST"/" LEADS BACK DOWN TO THE STREAM BY THE WOODS.")
      IF ((IR .EQ. 85) .OR. (IR .EQ. 86))WRITE(LDEV,85)
   85 FORMAT(/" IT IS MADE OF RUSTY WROUGHT IRON. THE STEPS ARE "/
     1" HINGED SO THAT ONCE YOU GO DOWN YOU CANNOT GO BACK UP. BUT"/
     2" THE HINGE HAS A HABIT OF RUSTING SO IT CANNOT MOVE.")
      IF(IR.EQ.86)WRITE(LDEV,86)
   86 FORMAT(/" THE LADDER IN THE ATTIC WAS DESTROYED WHEN YOU CLIMBED ",
     1"UP IT AND YOU"/" CANNOT GIT BACK DOWN IT.")
      IF(IR.EQ.86)IXT(265)=0
      IF(IR.EQ.86)ITST(14)=86
      IF (IR .EQ. 87)WRITE(LDEV,87)
   87 FORMAT(/" YOU ARE IN A DUSTY ROOM THICK WITH COBWEBS. YOU MUST ",
     1"STOOP TO GET AROUND.")
      IF(IR.EQ.87.AND.ITST(5).LT.300)WRITE(LDEV,187)
  187 FORMAT(" A SMALL GRATE LETS IN JUST ENOUGH LIGHT TO SEE.")
      IF(IR.EQ.87.AND.IXT(265).NE.0)WRITE(LDEV,287)
  287 FORMAT(" THERE IS A HALF ROTTED LADDER LEADING UP TO A FIRE ",
     1"ESCAPE.")
      IF (IR .EQ. 89)WRITE(LDEV,89)
   89 FORMAT(/" IT IS THE LABORATORY OF THE MAD SCIENTIST. THERE ARE ",
     1"SEVERAL PIECES OF"/" EQUIPMENT HERE WHICH ARE ALL HUMMING REA",
     2"DY TO WORK. IT SORT OF LOOKS LIKE"/" THE TRANSPORTER ROOM OUT ",
     3"OF A STAR TREK MOVIE. LARGE WINDOWS OVERLOOK THE "/" GROUNDS. ",
     4"THERE IS A DOOR TO THE SOUTH AND A SMALL DOOR ON THE FLOOR.")
      IF (IR .EQ. 90)WRITE(LDEV,90)(IDTN(I,IDW),I=1,4)
   90 FORMAT(/" YOU CAN SEE ALL THE USUAL FIXTURES; ESPECIALLY A VERY ",
     1"NICE SHOWER."/" THERE IS A SMALL DOOR IN THE WALL IN FRONT OF ",
     2"YOU AS YOU ENTERED AND "/" ANOTHER SMALL DOOR IN THE CEILING. ",
     3"A SMALL WINDOW OVER LOOKS THE"/" GROUNDS FAR BELOW.  SEEMS ",
     4"THE ONLY OTHER WAY OUT IS BY GOING "4A2)
      IF (IR .EQ. 91)WRITE(LDEV,91)
   91 FORMAT(/" YOU ARE ON A SCREENED IN PORCH IN FRONT OF THE MANS",
     1"ION. THERE IS"/" A SMALL PLAQUE ON THE DOOR WITH WRITING ON ",
     2"IT. YOU CAN EITHER"/" GO NORTH INTO THE MANSION OR GO WEST ",
     3"TO THE DRIVEWAY.")
      IF (IR .EQ. 92)WRITE(LDEV,92)
   92 FORMAT(/" YOU ARE ON A LONG DRIVE THAT LEADS EASTERLY FROM THE ",
     1"GATE TO THE"/" MANSION. A SIGN ALONG THE DRIVEWAY READS: STOP ",
     2"LOOK AND LISTEN."/" THE WALL IS TO THE SOUTH AND TREES LINE ",
     3"THE NORTHERN SIDE.")
      IF (IR .EQ. 93)WRITE(LDEV,93)
   93 FORMAT(/" YOU ARE SOUTH OF THE HEAVY IRON GATE. A SIGN SAYS ENTER",
     1" AT YOUR OWN RISK.")
      IF(IR.EQ.93.AND.IVEN(4).EQ.493)WRITE(LDEV,193)
  193 FORMAT(" THERE IS A SHINY BRASS LANTERN HANGING ON THE GATE ",
     1"POST BY THE SIGN.")
      IF(IR.EQ.93.AND.IVEN(4).EQ.1493)WRITE(LDEV,293)
  293 FORMAT(" THERE IS A BRIGHTLY SHINING LANTERN HANGING ON A ",
     1"BRASS HOOK NEXT TO THE SIGN.")
      IF(IR.EQ.93.AND.IVEN(4).NE.493.AND.IVEN(4).NE.1493)WRITE(LDEV,393)
  393 FORMAT(" THERE IS A EMPTY SHINY BRASS HOOK ON THE GATE POST ",
     1"NEXT TO THE SIGN.")
      IF(IR.EQ.93)WRITE(LDEV,493)
  493 FORMAT(" YOU CAN SEE THE ROAD TURN NORTH ALONG THE ",
     2"WALL ABOUT"/" A QUARTER MILE TO THE EAST AND TO THE WEST. YOU ",
     3"ARE ALSO, AT THE END"/" OF THE HIGHWAY WHICH GOES SOUTH TO THE ",
     4"BIG CITY.")
      IF (IR .EQ. 94)WRITE(LDEV,94)
   94 FORMAT(/" YOU ARE OUTSIDE THE WESTERN WALL OF THE MANSION. ",
     1"THE ROAD ENDS HERE"/" BUT THE WALL CONTINUES NORTH INTO A ",
     2"DENSE FOREST. THE FOREST IS"/" ALSO TO THE WEST OF THE ROAD ",
     3"BUT HAS BEEN PARTIALLY CLEARED. YOU"/" CAN SEE THE ROAD ",
     4"TURN EAST ABOUT A QUARTER MILE TO THE SOUTH.")
      IF (IR .EQ. 95)WRITE(LDEV,95)
   95 FORMAT(/" YOU ARE ON THE ROAD AT THE BACK GATE OF THE MANSION. ",
     1"THE HINGES HAVE"/" RUSTED THROUGH AND THE GATE HANGS HALF ",
     2"OPEN. THERE IS A PATH LEADING"/" SOUTH THROUGH THE GATE AND ",
     3"BETWEEN TWO ROWS OF HEDGES. TO THE NORTH"/" OF THE ROAD ",
     4"IS A 500 FOOT SHEER CLIFF,OVER LOOKING THE SEA SHORE. THE"/
     5" ROAD ENDS HERE BUT THE WALL CONTINUES WEST INTO THE ",
     6"DENSE FOREST.")
      IF (IR .EQ. 96)WRITE(LDEV,96)
   96 FORMAT(/" YOU ARE OUTSIDE THE EASTERN WALL OF THE MANSION. ",
     1"THE WALL FORMS "/" PART OF THE MANSION TO THE SOUTH WHERE ",
     2"THE ROAD GOES UNDER IT"/" BEFORE TURNING WEST. THE ROAD ",
     3"ALSO TURNS TO THE WEST ALONG"/" THE WALL ABOUT A ",
     4"QUARTER MILE TO THE NORTH. THERE IS A 500"/" FOOT SHEER CLIFF ",
     5"TO THE EAST OF THE ROAD.")
      IF (IR .EQ. 97)WRITE(LDEV,97)
   97 FORMAT(/" YOU ARE IN A LIGHTLY WOODED PART OF THE FOREST. THERE ",
     1"ARE NO PATHS"/" AND YOU CANNOT GO STRAIGHT IN ANY DIRECTION ",
     2"VERY LONG.")
      IF (IR .EQ. 98)WRITE(LDEV,98)
   98 FORMAT(/" YOU ARE IN A DENSELY WOODED PART OF THE FOREST. YOU ",
     1"CAN NO LONGER TELL"/" CARDINAL DIRECTIONS. THERE IS NO WAY ",
     2"TO TELL IF YOU ARE GOING"/" STRAIGHT AND YOU COULD EASILY ",
     3"GO IN CIRCLES AND NOT KNOW IT.")
      IF (IR .EQ. 99)WRITE(LDEV,99)
   99 FORMAT(/" THE STREAM FLOWS NORTH TO SOUTH IN A DEEP CANYON. ",
     1"THERE ARE"/" SOME STEPS CUT IN THE ROCK THAT GO DOWN INTO ",
     2"A CAVE AND UP THE "/" SIDE OF THE CANYON TO A COTTAGE ",
     3"BUILT ON A SMALL PLATEAU.")
 2000 IF (LU.NE.IPR(1).OR.ITST(21).EQ.0)GOTO 3000
      LU=ITST(21)
      GOTO 999
 3000 NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
      STOP
      END
$CONTROL SEGMENT=MMSF
      SUBROUTINE MMSF
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      DIMENSION ITIM(5)
      INTEGER MOVEAS
      IFSD(I)=I-(I/100)*100
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      RN(R)=R*7.7-INT(R*7.7)
      NAME(2)=MOVEAS("SG")
      LU=IPR(1)
      IR=ITST(1)
      R=RND
      GOTO(1000,2000,2000,3000,4000,5000,5000,6000,7000,8000,
     18000,9000,10000,10000,11000,11000,12000),IWRD(6,1)-19
 1000 IF(ITST(5)-(ITST(5)/25)*25.EQ.13.AND.IWRD(6,1).EQ.20.AND.IWRD(5,
     12).EQ.3.AND.IWRD(6,2).EQ.71.AND.ITST(5).LT.450)ITST(2)=ITST(2)+2
      IF(ITST(5)-(ITST(5)/25)*25.EQ.13.AND.IWRD(6,1).EQ.20.AND.
     1IWRD(5,2).EQ.3.AND.IWRD(6,2).EQ.71.AND.ITST(5).LT.450)
     2CALL EXEC(8,NAME,LU,1040,0)
      IF(IWRD(6,1).EQ.20.AND.IWRD(5,2).EQ.3.AND.IWRD(6,2).EQ.71)
     1CALL EXEC(8,NAME,LU,520,0)
      IF (IWRD(7,1) .GT. 1) CALL EXEC(8,NAME,LU,320,0)
      ISC=ITST(2)
      ISCP=ITST(3)
      ISCL=(ISC/85+1)*85-ISC
      NAME(2)=MOVEAS("SB")
      WRITE(LDEV,1005)ISC,ISCP
 1005 FORMAT(/" SO FAR YOU HAVE SCORED"I4" POINTS. ",
     1"YOU CAN STILL REACH"I4" POINTS")
      IF(IWRD(6,1).EQ.20)CALL EXEC(8,NAME,0,0,0)
      WRITE(LDEV,1010)(ICLS(L,ISC/85+1),L=1,4),ISCL
 1010 FORMAT(" OF THE ORIGINAL 999 IF YOU CONTINUE. THIS RATES YOU ",
     1"AS A "4A2/" SLEUTH. YOU NEED"I3" MORE POINTS TO REACH THE ",
     2"NEXT LEVEL OF SKILL."/" ENTER SCORE NEXT TIME IF THAT IS WHAT ",
     3"YOU WANT.")
      CALL OURTIME(ITIM)
      ITR=60*ITIM(4)+ITIM(3)-60*(ITST(19)/100)-IFSD(ITST(19))
      IF(ITR.LT.0)ITR=ITR+1440
      TG=ITST(5)/25.
C     ADDED TO REMOVE INTEGER OVERFLOW PROBLEM
      IF(ITR/ITST(5).LE.163) GOTO 1012
      IEF=99
      GOTO 1013
 1012 IEF=200*ITR/ITST(5)
      IF(IEF.GT.99)IEF=99
 1013 WRITE(LDEV,1011)ITR,TG,IEF
 1011 FORMAT(/" YOU PLAYED"I4" MINUTES REAL TIME AND"F5.1" HOURS GAME ",.
     1"TIME OR"I3" % UTILIZATION.")
      NAME(2)=MOVEAS("SG")
 1021 WRITE(LDEV,1020)
 1020 FORMAT(/" DO YOU REALLY WANT TO QUIT NOW?  ")
 1015 READ(IDEV,1030) IANS
 1030 FORMAT(A2)
      IF (IANS .EQ. MOVEAS("NO")) CALL EXEC(8,NAME,LU,1040,0)
      IF (IANS .EQ. MOVEAS("YE")) NAME(2)=MOVEAS("SD")
      IF (IANS .EQ. MOVEAS("YE")) CALL EXEC(8,NAME,LU,1032,0)
      WRITE(LDEV,1035)
 1035 FORMAT(/" WHAT?  PLEASE ANSWER YES OR NO.")
      GOTO 1021
 2000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(7,1).GT.2.AND.(IWRD(5,3).NE.5.OR.IWRD(6,3).NE.7.OR.
     1IWRD(5,2).NE.3.OR.IWRD(5,4).NE.4))CALL EXEC(8,NAME,LU,320,0)
      IF(IWRD(5,2) .NE. 3) CALL EXEC(8,NAME,LU,2011,0)
      IF(IWRD(6,2).EQ.99.AND.IWRD(6,1).EQ.22)GOTO 2100
 2019 IF (IVEN(IWRD(6,2)) .GT. 20000) CALL EXEC(8,NAME,LU,2020,0)
      IF ((IWRD(7,1) .GT. 2) .AND. (IFSD(IVEN(IWRD(6,2)))
     1.NE. IWRD(6,4)) .AND. (IVEN(IWRD(6,2)) .LT. 10000))
     2CALL EXEC(8,NAME,LU,2025,0)
      IF(IVEN(IWRD(6,2)).EQ.0.AND.IWRD(6,2).GT.53)
     1CALL EXEC(8,NAME,LU,320,0)
      IF (((IFSD(IVEN(IWRD(6,2))) .NE. IR) .AND.
     1(IVEN(IWRD(6,2)) .LT. 10000)) .OR. ((IVEN(IWRD(6,2)) .GE. 10000)
     2.AND.(IRES(IVEN(IWRD(6,2))-(IVEN(IWRD(6,2))/
     3100)*100)-(IRES(IVEN(IWRD(6,2))-(IVEN(IWRD(6,2))/100)*100)/100)*
     4100 .NE. IR)).OR.(IVEN(IWRD(6,2)).GT.10000.AND.IWRD(6,1).EQ.21))
     5CALL EXEC(8,NAME,LU,2030,0)
      IF(IWRD(6,2).EQ.88)CALL EXEC(8,NAME,LU,2037,0)
      IF(IWRD(6,2).GT.99.AND.IWRD(6,2).LT.103)CALL EXEC(8,NAME,LU,
     A2041,0)
      IF(IWRD(6,2).EQ.103)CALL EXEC(8,NAME,LU,2042,0)
      IF(IWRD(6,2).EQ.29.AND.ITST(5).GT.50.AND.IVEN(29).EQ.1214)
     1CALL EXEC(8,NAME,LU,2035,0)
      IF (IWRD(6,2).GT.53) CALL EXEC(8,NAME,LU,2040,0)
      IC=ITD(IVEN(IWRD(6,2)))
      DO 2050 J=1,53
      IF (IVEN(J) .LT. 20000) GOTO 2050
      IC=IC+ITD(IVEN(J))
 2050 CONTINUE
      IF (IC .GT. 16.AND.IVEN(48).LT.20000) CALL EXEC(8,NAME,LU,2060,0)
      IF (IC .GT. 24) CALL EXEC(8,NAME,LU,2060,0)
      K=IWRD(6,2)
      IF(K.NE.5.AND.K.NE.17.AND.K.NE.29.AND.K.NE.36.AND.K.NE.37.AND.K.
     1NE.39.AND.K.NE.40.AND.K.NE.42.AND.K.NE.46.AND.K.NE.4.AND.K.NE.28)
     2GOTO 2052
      IF(IFD(IVEN(K)).EQ.1.AND.K.NE.4)IVEN(K)=IVEN(K)-1000
      IF(ITD(IVEN(4)).EQ.4.AND.K.EQ.4)IVEN(4)=IVEN(4)-100
 2052 R=RN(R)
      IF(IWRD(6,2) .EQ. 21) ITST(16)=INT(R*89+1)
      IF(IWRD(6,2).EQ.21.AND.IVRB(1,ITST(16)).EQ.MOVEAS("  "))GOTO 2052
      IVEN(IWRD(6,2))=(IVEN(IWRD(6,2))/100)*100-(IVEN(IWRD(6,2))
     1/10000)*10000+20000
      IF(ITST(5).LT.100.OR.ITST(5).GT.400)GOTO 2095
      DO 2090 J=2,14
      IF((IRES(J) .GT. 10000) .OR. (ITD(IRES(J)) .EQ. 0) .OR.
     1(IFSD(IRES(J)) .EQ. 0)) GOTO 2090
      DO 2090 K=1,53
      IF((IVEN(K).GT.10000).OR.(IFSD(IRES(J)).NE.IFSD(IVEN(K))))
     1GOTO 2090
      R=RN(R)
      IF(R.GT..2.AND.ITST(5).LT.250)GOTO 2090
      IF(R.GT..1.AND.ITST(5).GT.250)GOTO 2090
      IC=ITD(IVEN(K))
      DO 2080 L=1,53
      IF((IVEN(L) .LT. 10000) .OR. (IVEN(L) .GT. 20000) .OR.
     1(IFSD(IVEN(L)) .NE. J)) GOTO 2080
      IC=IC+ITD(IVEN(L))
 2080 CONTINUE
      R=RN(R)
      IF(R.GT..3)GOTO 2090
      IF(IC .LE. ITD(IRES(J))) IVEN(K)=10000+(IVEN(K)/100)*100+J
      IF(IC.LE.ITD(IRES(J)).AND.IFSD(IRES(J)).EQ.IR)WRITE(LDEV,2081)
     1(IRSN(I,J),I=1,4)
 2081 FORMAT(/" YOU JUST SAW "4A2/" PICK UP_")
      IF(IC.LE.ITD(IRES(J)).AND.IFSD(IRES(J)).EQ.IR)CALL MMRI(4,K)
 2090 CONTINUE
 2095 CALL EXEC(8,NAME,LU,2070,0)
 2100 IF(IR.NE.90)CALL EXEC(8,NAME,LU,2110,0)
      DO 2130 I=1,52
      IF(IVEN(I).GT.20000)CALL EXEC(8,NAME,LU,2120,0)
 2130 CONTINUE
      IF(IVEN(53).GT.20000)CALL EXEC(8,NAME,LU,2140,0)
      ITST(32)=1
      CALL EXEC(8,NAME,LU,2150,0)
 3000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(7,1).EQ.2.AND.IWRD(5,2).EQ.5.AND.IWRD(6,2).EQ.11)GOTO 3200
      IF(IWRD(7,1).GT.2.OR.IWRD(5,2).NE.3)CALL EXEC(8,NAME,LU,320,0)
      IF (IVEN(IWRD(6,2)) .LT. 20000) CALL EXEC(8,NAME,LU,3010,0)
      IF(IR.EQ.35)IVEN(IWRD(6,2))=ITD(IVEN(IWRD(6,2)))+98
      IF(IR.EQ.35)CALL EXEC(8,NAME,LU,3015,0)
      IF ((IR .LT. 75) .OR. (IR .GT. 77)) GOTO 3100
      DO 3020 J=326,328
      IF (IFSD(IXT(J)) .NE. IR) GOTO 3020
      IVEN(IWRD(6,2))=IVEN(IWRD(6,2))-20000+IXT(J)/100
      IF (IXT(J)/100 .EQ. 79) CALL EXEC(8,NAME,LU,3030,0)
      IF (IXT(J)/100 .NE. 79) CALL EXEC(8,NAME,LU,3040,0)
 3020 CONTINUE
 3100 IF(IWRD(6,2).EQ.30.AND.IR.NE.25)IVEN(30)=0
      IF(IWRD(6,2).EQ.30.AND.IR.NE.25)CALL EXEC(8,NAME,LU,3045,0)
      IVEN(IWRD(6,2))=IVEN(IWRD(6,2))-20000+IR
      DO 3120 J=2,14
      IF((ITD(IRES(J)) .EQ. 0) .OR. (IRES(J) .GT. 10000)) GOTO 3120
      R=RN(R)
      IF(R.GT..1.AND.ITST(5).LT.250)GOTO 3130
      IF(R.GT..2.AND.ITST(5).GT.250)GOTO 3130
      DO 3120 K=1,53
      IF((IVEN(K) .LT. 10000) .OR. (IVEN(K) .GT. 20000) .OR. (IFSD
     1(IVEN(K)) .NE. J)) GOTO 3120
      R=RN(R)
      IF(R.GT..3)GOTO 3120
      IVEN(K)=IVEN(K)-10000-J+IFSD(IRES(J))
      IF(IFSD(IRES(J)).EQ.IR)WRITE(LDEV,3115)(IRSN(L,J),L=1,4)
 3115 FORMAT(/" YOU JUST SAW "4A2/" PUT DOWN_")
      IF(IFSD(IRES(J)).EQ.IR)CALL MMRI(4,K)
 3120 CONTINUE
 3130 CALL EXEC(8,NAME,LU,3110,0)
 3200 IF(IR.EQ.35)CALL EXEC(8,NAME,LU,3210,0)
      IC=0
      IX=0
      DO 3220 I=1,52
      IF(I.EQ.30.AND.IVEN(I).GT.20000)IX=1
      IF(IVEN(I).LT.20000)GOTO 3220
      IVEN(I)=IVEN(I)-20000+IR
      IC=1
 3220 CONTINUE
      IF(IC.EQ.0)CALL EXEC(8,NAME,LU,520,0)
      IF(IX.EQ.1.AND.IR.NE.25)IVEN(30)=0
      IF(IX.EQ.1.AND.IR.NE.25)CALL EXEC(8,NAME,LU,3045,0)
      IF(IX.EQ.1)IVEN(30)=1325
      CALL EXEC(8,NAME,LU,1040,0)
 4000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(7,1).NE.4.OR.IWRD(5,2).NE.3.OR.IWRD(5,4).NE.4.OR.
     1IWRD(5,3).NE.5.OR.IWRD(6,3).NE.5)CALL EXEC(8,NAME,LU,320,0)
      IF(IVEN(IWRD(6,2)).LT.20000) CALL EXEC(8,NAME,LU,3010,0)
      IF(IFSD(IRES(IWRD(6,4))).NE.IR)CALL EXEC(8,NAME,LU,4030,0)
      IC=ITD(IVEN(IWRD(6,2)))
      DO 4020 J=1,53
      IF ((IVEN(J)/10000 .NE. 1) .OR. (IWRD(6,4) .NE. IFSD(IVEN(J))
     1)) GOTO 4020
      IC=IC+ITD(IVEN(J))
 4020 CONTINUE
      IF (IC .GT. ITFD(IRES(IWRD(6,4)))) CALL EXEC(8,NAME,LU,4030,0)
      IVEN(IWRD(6,2))=IVEN(IWRD(6,2))-10000+IWRD(6,4)
      CALL EXEC(8,NAME,LU,3110,1)
 5000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(6,1).EQ.25.AND.IWRD(5,2).EQ.5.AND.IWRD(6,2).EQ.1.AND.
     1IWRD(6,3).EQ.64)IWRD(6,2)=4
      IF(IWRD(6,1).EQ.26.AND.(IWRD(5,2).NE.3.OR.(IWRD(6,2).NE.3.AND.
     1IWRD(6,2).NE.6.AND.IWRD(6,2).NE.18.AND.IWRD(6,2).NE.21.AND.
     2IWRD(6,2).NE.22.AND.IWRD(6,2).NE.28.AND.IWRD(6,2).NE.29.AND.
     3IWRD(6,2).NE.90.AND.IWRD(6,2).NE.88)))CALL EXEC(8,NAME,LU,320,0)
      IF(IWRD(6,1) .EQ. 26) IWRD(5,3)=IWRD(5,2)
      IF(IWRD(6,1) .EQ. 26) IWRD(6,3)=IWRD(6,2)
      IF(IWRD(6,1) .EQ. 26) IWRD(5,2)=5
      IF(IWRD(6,1) .EQ. 26) IWRD(6,2)=4
      IF ((IWRD(5,2) .NE. 5) .OR. (IWRD(6,2) .NE. 4))
     1CALL EXEC(8,NAME,LU,320,0)
      IF ((IWRD(5,3) .NE. 3) .AND. (IWRD(5,3) .NE. 4))
     1CALL EXEC(8,NAME,LU,5010,0)
      IF(IWRD(5,3).EQ.3)GOTO 5100
 5019 IF (IFSD(IRES(IWRD(6,3))) .NE. IR)
     1CALL EXEC(8,NAME,LU,5020,0)
      IC=0
      WRITE(LDEV,5030) (IRSN(L,IWRD(6,3)),L=1,4)
 5030 FORMAT(/" YOU ARE LOOKING AT THE "4A2/" WHO HAS:")
      CALL MMRI(3,IWRD(6,3))
      CALL EXEC(8,NAME,LU,5070,0)
 5100 IF(IVEN(IWRD(6,3)).LT.20000.AND.IWRD(6,3).LT.54)
     1CALL EXEC(8,NAME,LU,5110,0)
      IF(IXT(320).EQ.0.AND.(IR.EQ.51.OR.IR.EQ.53))IVEN(79)=IR
      IF(IFSD(IVEN(IWRD(6,3))).NE.IR.AND.IWRD(6,3).GT.53)
     1CALL EXEC(8,NAME,LU,8030,0)
      IF (IWRD(6,3) .EQ. 30) CALL EXEC(8,NAME,LU,5130,0)
      IF(IWRD(6,3).EQ.15) CALL EXEC(8,NAME,LU,5140,0)
      IF (IWRD(6,3) .NE. 28) GOTO 5200
      IC=0
      ID=0
      DO 5160 J=1,360
      IF (IFSD(IXT(J)) .NE. IR) GOTO 5160
      IF(ITFD(IXT(J)).LT.92.AND.ITFD(IXT(J)).NE.35.AND.
     1ITFD(IXT(J)).NE.0)GOTO 5160
      IC=(J-1)/60+1
      IF(ID.EQ.0)WRITE(LDEV,5150)
 5150 FORMAT(/" THE MAP SHOWS THAT IT IS:")
      ID=1
      IF(ITFD(IXT(J)).NE.0)WRITE(LDEV,5151)(IDTN(L,IC),L=1,3),
     1(IRNM(L,IFSD(IROM(ITFD(IXT(J))))),L=1,8)
 5151 FORMAT(X,3A2"TO THE "8A2)
      IF(ITFD(IXT(J)).EQ.0)WRITE(LDEV,5152)(IDTN(L,IC),L=1,3)
 5152 FORMAT(X,3A2"TO THE 500 FOOT SHEER CLIFF")
 5160 CONTINUE
      IF (IC .EQ. 0) CALL EXEC(8,NAME,LU,5170,0)
      CALL EXEC(8,NAME,LU,0,0)
 5200 IF(IWRD(6,3) .NE. 19) GOTO 5300
      IWRD(6,3)=9-ITST(6)/3600
      CALL EXEC(8,NAME,LU,5210,0)
 5300 IF(IWRD(6,3).EQ.27)CALL EXEC(8,NAME,LU,5310,0)
      IF(IWRD(6,3) .EQ. 9) CALL EXEC(8,NAME,LU,5410,0)
 5500 IF(IWRD(6,3) .NE. 3) GOTO 5600
      IHR=6+ITST(5)/25
      IF(IHR .GT. 12) IHR=IHR-12
      IF(IHR .GT. 12) IHR=IHR-12
      MIN=INT((ITST(5)-(ITST(5)/25)*25)*2.4)
       IDUMMY=IHR*100+MIN
      CALL EXEC(8,NAME,LU,5510,IDUMMY)
 5600 IF(IWRD(6,3) .EQ. 21) CALL EXEC(8,NAME,LU,5610,0)
      IF(IWRD(6,3) .EQ. 6) CALL EXEC(8,NAME,LU,5710,ITST(4)/1000)
      IF((IWRD(6,3) .EQ. 13) .AND. (ITST(10) .EQ. 13))
     1CALL EXEC(8,NAME,LU,5720,0)
      IF(IWRD(6,3) .EQ. 13) CALL EXEC(8,NAME,LU,5730,0)
      IF((IWRD(6,3) .GT. 9) .AND. (IWRD(6,3) .LT. 13) .AND. (IWRD(6,3)
     1.EQ. ITST(10))) CALL EXEC(8,NAME,LU,5740,0)
      IF(IWRD(6,3).EQ.22.AND.IVEN(22).LT.21000)CALL EXEC(8,NAME,LU,
     A5750,0)
      IF(IWRD(6,3).EQ.22.AND.IVEN(22).GT.21000)CALL EXEC(8,NAME,LU,
     A5775,0)
      IF (IWRD(6,3) .EQ. 20) CALL EXEC(8,NAME,LU,5780,0)
      IF(IWRD(6,3) .EQ. 18) CALL EXEC(8,NAME,LU,5781,0)
      IF(IWRD(6,3).EQ.35) CALL EXEC(8,NAME,LU,5782,0)
      IF(IWRD(6,3).NE.64)GOTO 5820
      IC=0
      DO 5800 I=2,14
      IF(I.EQ.5)GOTO 5800
      IF(IFSD(IRES(I)).EQ.IR)IC=I
 5800 CONTINUE
      CALL EXEC(8,NAME,LU,5810,IC)
 5820 IF(IWRD(6,3).EQ.17)CALL EXEC(8,NAME,LU,5830,0)
      IF(IWRD(6,3).EQ.67)CALL EXEC(8,NAME,LU,5860,0)
      IF(IWRD(6,3).EQ.29)CALL EXEC(8,NAME,LU,5870,0)
      IF(IWRD(6,3).EQ.90)CALL EXEC(8,NAME,LU,5880,0)
      IF(IWRD(6,3).EQ.88.AND.IVEN(88).EQ.1017)CALL EXEC(8,NAME,LU,
     A2037,0)
      IF(IWRD(6,3).EQ.88)CALL EXEC(8,NAME,LU,5885,0)
      IF(IWRD(6,3).EQ.65.OR.IWRD(6,3).EQ.66)CALL EXEC(8,NAME,LU,5886,0)
      IF(IWRD(6,3).EQ.79.AND.IR.EQ.51)CALL EXEC(8,NAME,LU,5888,0)
      IF(IWRD(6,3).EQ.79.AND.IR.EQ.53)CALL EXEC(8,NAME,LU,5890,0)
      IF(IWRD(6,3).EQ.49)CALL EXEC(8,NAME,LU,5891,0)
      IF(IWRD(6,3).EQ.48)CALL EXEC(8,NAME,LU,5892,0)
      IF(IWRD(6,3).EQ.97.OR.IWRD(6,3).EQ.98)CALL EXEC(8,NAME,LU,5893,0)
 5900 CALL EXEC(8,NAME,LU,5910,0)
 6000 IF(IWRD(5,2).EQ.3)GOTO 6100
      IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(5,2).NE.4.OR.IWRD(7,1).NE.2)CALL EXEC(8,NAME,LU,320,0)
      IF(IFSD(IRES(IWRD(6,2))).EQ.IR)CALL EXEC(8,NAME,LU,6005,0)
      IF (IVEN(30) .LT. 20000) CALL EXEC(8,NAME,LU,6010,0)
      IC=IFSD(IRES(IWRD(6,2)))
      IF(IC .EQ. 0) CALL EXEC(8,NAME,LU,520,0)
      IC=IFSD(IROM(IC))
      CALL EXEC(8,NAME,LU,6020,IC)
 6100 IF (IWRD(7,1).NE.2)CALL EXEC(8,NAME,LU,320,0)
      IF(IVEN(IWRD(6,2)).GT.20000)CALL EXEC(8,NAME,LU,2020,0)
      IF(IVEN(IWRD(6,2)).GT.10000.AND.IFSD(IVEN(IWRD(6,2))).EQ.IR)
     1CALL EXEC(8,NAME,LU,6005,0)
      IF(IVEN(49).LT.20000)CALL EXEC(8,NAME,LU,6030,0)
      IF(IFSD(IVEN(IWRD(6,2))).EQ.0)CALL EXEC(8,NAME,LU,6035,0)
      CALL EXEC(8,NAME,LU,6040,0)
 7000 IF(IWRD(7,1).NE.1.AND.(IWRD(7,1).NE.2.OR.IWRD(5,2).NE.5.OR.
     1IWRD(6,2).NE.11))CALL EXEC(8,NAME,LU,320,0)
      WRITE(LDEV,7010)
 7010 FORMAT(/" YOUR BOOTY CONTAINS:")
      CALL MMRI(2,0)
      CALL EXEC(8,NAME,LU,0,0)
 8000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF((IWRD(6,1) .EQ.30) .AND. (((IWRD(5,2) .EQ. 5) .AND. (IWRD(6,
     12) .NE. 2)) .OR. ((IWRD(5,3) .EQ. 5) .AND. (IWRD(6,3) .NE. 2))
     2.OR. ((IWRD(5,2) .NE. 5) .AND. (IWRD(5,3) .NE. 5)))) GOTO 11000
      IF(((IWRD(5,2) .NE. 3) .AND. (IWRD(5,3) .NE. 3))
     1 .OR. (IWRD(7,1).GT. 3) .OR. (IWRD(7,1)
     2.EQ. 1) .OR. ((IWRD(7,1) .EQ. 2) .AND. (IWRD(6,1) .EQ.30)))
     3CALL EXEC(8,NAME,LU,320,0)
      IF (IWRD(5,2) .EQ. 5) IWRD(6,2)=IWRD(6,3)
      IF ((IWRD(6,2) .LT. 54) .AND. (IVEN(IWRD(6,2)) .LT. 20000))
     1CALL EXEC(8,NAME,LU,3012,0)
      IF ((IWRD(6,2) .GT. 47) .AND. (IVEN(IWRD(6,2))-(IVEN(IWRD(6,2))/
     1100)*100 .NE. IR)) CALL EXEC(8,NAME,LU,8031,0)
      IF ((IWRD(6,2) .NE. 4) .AND. (IWRD(6,2) .NE. 19) .AND.
     1(IWRD(6,2) .NE. 26) .AND. (IWRD(6,2) .NE. 27) .AND.
     2(IWRD(6,2) .NE. 31) .AND. (IWRD(6,2) .NE. 75) .AND.
     3(IWRD(6,2) .NE. 76) .AND. (IWRD(6,2) .NE. 89))
     4CALL EXEC(8,NAME,LU,8010,0)
      IF (IVEN(IWRD(6,2))/1000-(IVEN(IWRD(6,2))/10000)*10 .EQ. 1)
     1CALL EXEC(8,NAME,LU,8020,0)
      IF(IWRD(6,2).EQ.27)CALL EXEC(8,NAME,LU,8060,0)
      IF(IWRD(6,2).NE.19.AND.IWRD(6,2).NE.76.AND.IWRD(6,2).NE.89)
     1GOTO 8010
      IF(IVEN(31).LT.20000.AND.IVEN(19).LT.21000.AND.(IR.NE.10.OR.
     1IVEN(76).LT.1000).AND.(IR.NE.14.OR.IVEN(89).LT.1000))
     2CALL EXEC(8,NAME,LU,8050,0)
      IF(((IWRD(6,2).EQ.76.OR.IWRD(6,2).EQ.89).AND.IVEN(19).LT.21000)
     1.OR.(IWRD(6,2).EQ.19.AND.(IR.NE.10.OR.IVEN(76).LT.1000).AND.
     2(IR.NE.14.OR.IVEN(89).LT.1000)))IVEN(31)=21100
 8010 IF((IWRD(6,2) .EQ. 4) .AND. (ITST(6)-(ITST(6)/1000)*1000
     1.GT. 119) .AND. (IVEN(8) .LT. 20000))CALL EXEC(8,NAME,LU,8035,0)
      IF((IWRD(6,2) .EQ. 4) .AND. (ITST(6)-(ITST(6)/1000)*1000 .GT.
     1119)) ITST(6)=ITST(6)-2
      IVEN(IWRD(6,2))=IVEN(IWRD(6,2))+1000
      IF (IWRD(6,2).EQ.75.AND.ITST(8).NE.0) CALL EXEC(8,NAME,LU,8040,0)
      IF (IWRD(6,2).EQ.75.AND.ITST(8).EQ.0) CALL EXEC(8,NAME,LU,8045,0)
      IF(ITFD(IROM(IR)).EQ.50)CALL EXEC(8,NAME,LU,1040,0)
      IWRD(7,1)=1
      IWRD(6,1)=25
      NAME(2)=MOVEAS("SC")
      CALL EXEC(8,NAME,0,0,0)
 9000 IF(IWRD(7,1).GT.1)CALL EXEC(8,NAME,LU,320,0)
      R=RN(R)
      IC=R*4+9040
      IF(IR.EQ.93.AND.ITST(14).EQ.93)IC=9044
      IF(IR.EQ.98.OR.IR.EQ.97)IC=9045
      IF(IR.EQ.83)IC=9046
      IF(IR.EQ.19)IC=9047
      IF(IR.EQ.40.AND.IXT(141).EQ.0)IC=9048
      IF(IR.EQ.78.OR.IR.EQ.80)IC=9049
      IF(IR.EQ.86)IC=9050
      IF((IR.LT.35.AND.IR.GT.27).OR.(IR.LT.52.AND.IR.GT.41))IC=9051
      IF(IR.EQ.8.AND.IXT(84).EQ.0)IC=9048
      IF(IC.GT.9043)WRITE(LDEV,9010)
      IF(IC.LT.9044)WRITE(LDEV,9015)
 9010 FORMAT(/" HINTS COST 20 POINTS EACH. DO YOU WANT ONE?  ")
 9015 FORMAT(/" HINTS WASTE 20 POINTS EACH. DO YOU WANT ONE?  ")
 9020 READ(IDEV,9025)IANS
 9025 FORMAT(A2)
      IF(IANS.EQ.MOVEAS("NO"))CALL EXEC(8,NAME,LU,1040,0)
      IF(IANS.NE.MOVEAS("YE"))WRITE(LDEV,1035)
      IF(IANS.NE.MOVEAS("YE"))GOTO 9020
      IF(ITST(2).LT.20)CALL EXEC(8,NAME,LU,9027,0)
      ITST(2)=ITST(2)-20
      ITST(3)=ITST(3)-20
      CALL EXEC(8,NAME,LU,IC,0)
10000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(7,1).NE.2.OR.IWRD(5,2).NE.3)CALL EXEC(8,NAME,LU,320,0)
      IF((IR .EQ. 19) .AND. (IWRD(6,1) .EQ.33) .AND.(IWRD(6,2)
     1.EQ. 92)) IXT(11)=2219
      IF((IR .EQ. 19) .AND. (IWRD(6,1) .EQ.33) .AND. (IWRD(6,2)
     1.EQ. 92)) CALL EXEC(8,NAME,LU,1095,IR)
      IF(IR.EQ.5.AND.IWRD(6,1).EQ.32.AND.IWRD(6,2).EQ.70)IXT(183)=405
      IF(IR.EQ.5.AND.IWRD(6,1).EQ.32.AND.IWRD(6,2).EQ.70)CALL EXEC(8,
     ANAME,LU,1095,IR)
      IF(IR.EQ.7.AND.IWRD(6,1).EQ.32.AND.IWRD(6,2).EQ.69)IXT(123)=407
      IF(IR.EQ.7.AND.IWRD(6,1).EQ.32.AND.IWRD(6,2).EQ.69)
     1CALL EXEC(8,NAME,LU,1095,IR)
      IF(IWRD(6,2).EQ.88.AND.IR.EQ.17)CALL EXEC(8,NAME,LU,2037,0)
      IF(IWRD(6,2).NE.92)GOTO 10050
      IF((IR.GT.27.AND.IR.NE.91.AND.IR.NE.54.AND.IR.NE.36.AND.IR.NE.
     190).OR.IR.EQ.3.OR.IR.EQ.4.OR.IR.EQ.13.OR.IR.EQ.16.OR.IR.EQ.21
     2.OR.IR.EQ.22)CALL EXEC(8,NAME,LU,2030,0)
      DO 10030 J=1,240
      IF(IFSD(IXT(J)).NE.IR)GOTO 10030
      IF((J-1)/60+1.NE.ITST(4)/1000)GOTO 10030
      IC=ITFD(IXT(J))
      IF(IC.EQ.4.OR.IC.EQ.13.OR.IC.EQ.22.OR.J.EQ.62.OR.J.EQ.70.OR.J
     1.EQ.133.OR.J.EQ.182.OR.J.EQ.190)CALL EXEC(8,NAME,LU,15030,0)
      IF(IXT(J).GT.20000.AND.IWRD(6,1).EQ.32)CALL EXEC(8,NAME,LU,
     A10035,0)
      IF(IWRD(6,1).EQ.32)CALL EXEC(8,NAME,LU,10045,0)
      CALL EXEC(8,NAME,LU,10046,0)
10030 CONTINUE
      CALL EXEC(8,NAME,LU,15030,0)
10050 IF(IWRD(6,2) .NE. 91) GOTO 10100
      IF((IR .GT. 26) .OR. (IR .EQ. 21) .OR. (IROM(IR) .LT. 10000))
     1CALL EXEC(8,NAME,LU,10010,0)
      IF(((IROM(IR) .GT. 20000) .AND. (IWRD(6,1) .EQ. 32)) .OR.
     1((IROM(IR) .LT. 20000) .AND. (IWRD(6,1) .EQ.33))) CALL EXEC
     2(8,NAME,LU,8020,0)
      IF(IWRD(6,1) .EQ. 32) IROM(IR)=IROM(IR)+10000
      IF(IWRD(6,1) .EQ.33) IROM(IR)=IROM(IR)-10000
      IF((IWRD(6,1) .NE. 32) .OR. (IFSD(IRES(5)) .NE. IR) .OR.
     1(ITST(1) .GT. 300)) GOTO 10090
      DO 10080 J=1,360
      IF(IFSD(IXT(J)) .NE. IR) GOTO 10080
      IF(IXT(J) .GT. 20000) GOTO 10080
      IF(ITFD(IXT(J)).EQ.16.OR.ITFD(IXT(J)).GT.27)GOTO 10080
      IF(IROM(ITFD(IXT(J))) .GT. 20000) GOTO 10080
      IRES(5)=IRES(5)-IR+ITFD(IXT(J))
      GOTO 10090
10080 CONTINUE
      IRES(5)=0
      IVEN(1)=100+IR
      ITST(2)=ITST(2)+75
      CALL EXEC(8,NAME,LU,10085,0)
10090 IF(ITFD(IROM(IR)).EQ.50)GOTO 10095
      IWRD(7,1)=1
      IWRD(6,1)=25
      NAME(2)=MOVEAS("SC")
      CALL EXEC(8,NAME,0,0,0)
10095 CALL EXEC(8,NAME,LU,1040,0)
10100 IF(IWRD(6,2) .NE. 93) GOTO 10200
      IF(IR.NE.93.AND.IR.NE.92.AND.IR.NE.95.AND.IR.NE.54.AND.IR.NE.55)
     1CALL EXEC(8,NAME,LU,2030,0)
      IF((IXT(27).EQ.0).AND.(IR.EQ.54.OR.IR.EQ.55))CALL EXEC(8,NAME,
     1LU,10105,0)
      IF(((IR .EQ. 95) .OR. (IR .EQ. 55)) .AND. (IWRD(6,1) .EQ. 32))
     1CALL EXEC(8,NAME,LU,8020,0)
      IF(((IR .EQ.95) .OR. (IR .EQ. 55)) .AND. (IWRD(6,1) .EQ.33))
     1CALL EXEC(8,NAME,LU,10110,0)
      IF(((IWRD(6,1) .EQ.33) .AND. (IXT(54) .GT. 20000)) .OR.
     1((IWRD(6,1) .EQ. 32) .AND. (IXT(54) .LT. 20000)))
     2CALL EXEC(8,NAME,LU,8020,0)
      DO 10120 J=1,14
      IF((IFSD(IRES(J)).NE.IR.OR.IRES(J).GT.10000).AND.
     1IVEN(48).LT.20000)GOTO 10120
      IF(IWRD(6,1) .EQ. 32) IXT(54)=19293
      IF(IWRD(6,1) .EQ. 32) IXT(234)=19392
      IF(IWRD(6,1) .EQ.33) IXT(54)=29293
      IF(IWRD(6,1) .EQ.33) IXT(234)=29392
      IF(J.GT.1)CALL EXEC(8,NAME,LU,10115,J)
      CALL EXEC(8,NAME,LU,10116,0)
10120 CONTINUE
      CALL EXEC(8,NAME,LU,10130,0)
10200 IF(IWRD(6,2).LT.54.AND.IVEN(IWRD(6,2)).LT.20000)CALL EXEC
     1(8,NAME,LU,3010,0)
      IF(IWRD(6,2).NE.35) GOTO 10300
      IF((IWRD(6,1).EQ.32.AND.IFD(IVEN(35)).EQ.2).OR.(IWRD(6,1).EQ.33
     1.AND.IFD(IVEN(35)).LT.2))CALL EXEC(8,NAME,LU,8020,0)
      IF(IWRD(6,1).EQ.33)IVEN(35)=IVEN(35)-1000
      IF(IWRD(6,1).EQ.33)CALL EXEC(8,NAME,LU,1040,0)
      IF(IFD(IVEN(35)).EQ.0)CALL EXEC(8,NAME,LU,5783,0)
      IF(ITD(IVEN(35)).EQ.5)IVEN(35)=IVEN(35)+1000
      IF(ITD(IVEN(35)).EQ.5)CALL EXEC(8,NAME,LU,1040,0)
      IVEN(35)=IVEN(35)+1000
      DO 10220 J=1,360
      IF(IFSD(IXT(J)).NE.IR.OR.IXT(J).GT.20000)GOTO 10220
      IVEN(35)=IVEN(35)-100
      CALL EXEC(8,NAME,LU,10210,0)
10220 CONTINUE
      CALL EXEC(8,NAME,LU,10230,0)
10300 CONTINUE
10900 CALL EXEC(8,NAME,LU,10910,0)
11000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(6,1).EQ.30.AND.((IWRD(5,2).EQ.5.AND.IWRD(6,2).NE.10)
     1.OR.(IWRD(5,3).EQ.5.AND.IWRD(6,3).NE.10).OR.(IWRD(5,2).NE.5
     2.AND.IWRD(5,3).NE.5))) GOTO 12000
      IF(IWRD(6,1).EQ.35.AND.((IWRD(6,2).EQ.2.AND.IWRD(5,2).EQ.5.AND.
     1IWRD(6,3).EQ.88.AND.IWRD(5,3).EQ.3.AND.IWRD(7,1).EQ.3).OR.
     2(IWRD(7,1).EQ.2.AND.IWRD(6,2).EQ.88.AND.IWRD(5,2).EQ.3)))
     3CALL EXEC(8,NAME,LU,2038,0)
      IF(((IWRD(7,1) .EQ. 2) .AND. (IWRD(6,1) .NE. 34)) .OR.
     1((IWRD(7,1) .EQ. 3) .AND. (IWRD(5,2) .NE. 5) .AND.
     2(IWRD(5,3) .NE. 5))) CALL EXEC(8,NAME,LU,320,0)
      IF(((IWRD(5,2) .EQ. 5) .AND. (IWRD(6,2) .NE. 10) .AND.
     1(IWRD(6,2) .NE. 8)) .OR. ((IWRD(5,3) .EQ. 5) .AND.
     2(IWRD(6,3) .NE. 10) .AND. (IWRD(6,3) .NE. 12)))
     3CALL EXEC(8,NAME,LU,320,0)
      IF(IWRD(7,1) .GT. 3) CALL EXEC(8,NAME,LU,320,0)
      IF(IWRD(5,2) .EQ. 5) IWRD(6,2)=IWRD(6,3)
      IF(IWRD(5,2) .EQ. 5) IWRD(1,2)=IWRD(1,3)
      IF(IWRD(5,2) .EQ. 5) IWRD(2,2)=IWRD(2,3)
      IF(IWRD(5,2) .EQ. 5) IWRD(3,2)=IWRD(3,3)
      IF(IWRD(5,2) .EQ. 5) IWRD(4,2)=IWRD(4,3)
      IF(IWRD(5,2) .EQ. 5) IWRD(5,2)=IWRD(5,3)
      IC=IWRD(6,2)
      IF((IC.LT.36).AND.(IVEN(IC).LT.20000)) CALL EXEC(8,NAME,LU,
     A3010,0)
      IF((IC .GT. 35) .AND. (IFSD(IVEN(IC)) .NE. IR))
     1CALL EXEC(8,NAME,LU,8031,0)
      IF((IC .NE. 4) .AND. (IC .NE. 19) .AND. (IC .NE. 26) .AND.
     1(IC .NE. 27) .AND. (IC .NE. 31) .AND. (IC .NE. 44) .AND.
     2(IC .NE. 45)) CALL EXEC(8,NAME,LU,8010,0)
      IF(IVEN(IC)/1000-(IVEN(IC)/10000)*10 .EQ. 0)
     1CALL EXEC(8,NAME,LU,8020,0)
      IVEN(IC)=IVEN(IC)-1000
      CALL EXEC(8,NAME,LU,1040,0)
12000 IF((IR .EQ. 10) .AND. (IWRD(5,2) .EQ. 3) .AND. (IWRD(6,2)
     1.EQ. 72) .AND. (IWRD(7,1) .EQ. 2))IXT(5)=1310
      IF((IR .EQ. 10) .AND. (IWRD(5,2) .EQ. 3) .AND. (IWRD(6,2)
     1.EQ. 72) .AND. (IWRD(7,1) .EQ. 2)) CALL EXEC(8,NAME,LU,1095,IR)
      IF(IWRD(5,2).EQ.3.AND.IWRD(6,2).EQ.17.AND.IWRD(7,1).EQ.2)
     1GOTO 12100
      IC=IWRD(6,2)
      IF((IWRD(7,1) .NE. 2) .OR. (IWRD(5,2) .NE. 2) .OR. (IC .EQ. 5)
     1.OR. (IC .EQ. 6) .OR. (IC .GT. 10)) CALL EXEC(8,NAME,LU,320,0)
      IF((IC .LT. 5) .AND. (IVEN(6) .LT. 20000) .AND. (IR .LT. 54))
     1CALL EXEC(8,NAME,LU,1005,0)
      IF(IC .LT. 5) ITST(4)=ITST(4)-(ITST(4)/1000)*1000 +IC*1000
      IF(IC .LT. 5) CALL EXEC(8,NAME,LU,1040,0)
      ITST(4)=ITST(4)+1000*(IC-9)
      IF(ITST(4).LT.1000)ITST(4)=ITST(4)+4000
      IF(ITST(4).GT.5000)ITST(4)=ITST(4)-4000
      CALL EXEC(8,NAME,LU,1040,0)
12100 IF(IVEN(17).GT.20000.OR.(IFSD(IVEN(17)).EQ.IR.AND.IFD(IVEN(17))
     1.NE.1.AND.IVEN(17).LT.10000))CALL EXEC(8,NAME,LU,1040,0)
      IF((IFSD(IVEN(17)).NE.IR.AND.IVEN(17).LT.10000).OR.
     1IVEN(17).GT.10000)CALL EXEC(8,NAME,LU,8031,0)
      DO 12110 I=1,360
      IF((ITFD(IXT(I)).GT.41.AND.ITFD(IXT(I)).LT.54).OR.(IFSD(IXT(I))
     1.GT.41.AND.IFSD(IXT(I)).LT.54))IXT(I)=0
12110 CONTINUE
      IROM(42)=5153
      DO 12120 I=43,50
12120 IROM(I)=5053
      IROM(51)=6555
      IROM(52)=6554
      IROM(53)=6555
      DO 12130 I=1,53
      IF(IVEN(I).LT.10000.AND.IFSD(IVEN(I)).GT.41.AND.IFSD(IVEN(I))
     1.LT.54)IVEN(I)=0
12130 CONTINUE
      IVEN(40)=1151
      IVEN(42)=1151
      IVEN(37)=1153
      IVEN(39)=1253
      IRES(4)=10000
      ITST(32)=ITST(5)
      IXT(22)=4243
      IXT(23)=4244
      IXT(82)=4442
      IXT(83)=4445
      IXT(84)=4544
      IXT(85)=4750
      IXT(86)=4948
      IXT(87)=5049
      IXT(142)=4344
      IXT(143)=4443
      IXT(202)=4342
      IXT(203)=4345
      IXT(204)=4543
      IXT(205)=5047
      IXT(254)=4142
      IXT(255)=4547
      IXT(256)=5148
      IXT(257)=5249
      IXT(258)=5350
      IXT(315)=4241
      IXT(316)=4648
      IXT(317)=4647
      IXT(318)=4745
      IXT(351)=4849
      IXT(352)=4851
      IXT(353)=4950
      IXT(319)=4952
      IXT(354)=5053
      CALL EXEC(8,NAME,LU,12140,0)
      NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
      STOP
      END
$CONTROL SEGMENT=MMSG
      SUBROUTINE MMSG
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      INTEGER MOVEAS
      IFSD(I)=I-(I/100)*100
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      RN(R)=R*7.7-INT(R*7.7)
      CALL RMPAR(IPR)
      LU=IPR(1)
      IRIT=IPR(2)
      IW63=IWRD(6,3)
      R=RND
      IFC=ITST(4)/1000
      IDN=1
      IDE=2
      IDS=3
      IDW=4
      IF(IVEN(6).LT.20000)IDN=10-IFC
      IF(IDN.EQ.6)IDN=10
      IF(IVEN(6).LT.20000)IDE=11-IFC
      IF(IVEN(6).LT.20000)IDS=12-IFC
      IF(IDS.EQ.11)IDS=7
      IF(IVEN(6).LT.20000)IDW=13-IFC
      IF(IDW.GT.10)IDW=IDW-4
  999 IF (IRIT .EQ. 320) WRITE(LDEV,320)
  320 FORMAT(/" I CANNOT FIGURE OUT WHAT YOU ARE TRYING TO SAY")
      IF (IRIT .EQ. 520) WRITE(LDEV,520)
  520 FORMAT(/" NOTHING HAPPENS")
      IF(IRIT.EQ.1000)WRITE(LDEV,1000)(IWRD(L,1),L=1,4)
 1000 FORMAT(/" I AM NOT A MIND READER, YOU WILL HAVE TO TELL ME ",
     1"WHAT TO "4A2)
      IF (IRIT .EQ. 1040) WRITE(LDEV,1040)
 1040 FORMAT(/" OKAY")
      IF(IRIT .EQ. 1065) WRITE(LDEV,1065) IPR(3)
 1065 FORMAT(/" PROGRAM ERROR AT LINE"I6)
      IF(IPR(3).EQ.7.OR.IPR(3).EQ.16.OR.IPR(3).EQ.25)IC=IDS
      IF(IPR(3).EQ.5.OR.IPR(3).EQ.14.OR.IPR(3).EQ.23)IC=IDW
      IF(IPR(3).EQ.1.OR.IPR(3).EQ.10.OR.IPR(3).EQ.19)IC=IDN
      IF(IRIT .EQ. 1095) WRITE(LDEV,1095)(IDTN(I,IC),I=1,4)
 1095 FORMAT(/" YOUR ACTION OPENED A PANEL INTO THE SECRET PASSAGE ",
     1"THAT YOU CAN"/" ENTER BY GOING "4A2)
      IF(IRIT.EQ.1095.AND.ITST(1).EQ.5.AND.ITST(5).GT.50)WRITE(LDEV,
     A1096)
 1096 FORMAT(/" THE COFFIN IS EMPTY AND THE LID WILL NOT STAY OPEN")
      IF(IRIT.EQ.1095.AND.ITST(1).EQ.5.AND.IRES(5).EQ.300)IRES(5)=5
      IF(IRIT.EQ.1095.AND.ITST(1).EQ.5.AND.ITST(5).LE.50
     1.AND.IRES(5).EQ.5)WRITE(LDEV,1097)
 1097 FORMAT(/" THE VAMPIRE IS IN THE COFFIN AND IS WAKING UP.")
      IF (IRIT .EQ. 1150) WRITE(LDEV,1150)
 1150 FORMAT(/" IT IS DARK HERE")
      IF ((IRIT .EQ. 1150) .AND. (IPR(3) .EQ. 1)) WRITE(LDEV,1151)
 1151 FORMAT(/" IT IS AFTER SUNSET")
      IF ((IRIT .EQ. 1150) .AND. (IPR(3) .EQ. 2)) WRITE(LDEV,1152)
 1152 FORMAT(/" A CURTAIN BLOCKS THE LIGHT")
      IF (IRIT .EQ. 2010) WRITE (LDEV,2010)(IWRD(L,1),L=1,2),
     1(IWRD(L,2),L=1,4)
 2010 FORMAT(/" YOU CANNOT "2A2" THE "4A2)
      IF(IRIT.EQ.2011)WRITE(LDEV,2011)(IWRD(L,1),L=1,2),
     1(IWRD(L,2),L=1,4)
 2011 FORMAT(/" YOU CANNOT "2A2"THE "4A2)
      IF (IRIT .EQ. 2020) WRITE(LDEV,2020)(IWRD(L,2),L=1,4)
 2020 FORMAT(/" YOU ALREADY HAVE THE "4A2)
      IF (IRIT .EQ. 2025) WRITE(LDEV,2025)(IWRD(L,4),L=1,4)
 2025 FORMAT(/"  IT IS NOT IN THE POSSESSION OF THE "4A2)
      IF (IRIT .EQ. 2030) WRITE(LDEV,2030)(IWRD(L,2),L=1,4)
 2030 FORMAT(/" I DON'T SEE THE "4A2)
      IF(IRIT.EQ.2035)WRITE(LDEV,2035)
 2035 FORMAT(/" THE WOOD IS STACKED TOO HIGH.")
      IF(IRIT.EQ.2037)WRITE(LDEV,2037)
 2037 FORMAT(/" THE DELICATE PAPYRUS OF THE SCROLL DISINTEGRATED ",
     1"WHEN YOU TOUCHED IT.")
      IF(IRIT.EQ.2038)WRITE(LDEV,2038)
 2038 FORMAT(/" I KNEW YOU WOULD HAVE TO TRY THAT. WELL YOU JUST ",
     1"BLEW PIECES"/" OF PAPYRUS ALL OVER THE LIBRARY.")
      IF(IRIT.EQ.2037.OR.IRIT.EQ.2038)IVEN(88)=1017
      IF (IRIT .EQ. 2040) WRITE(LDEV,2040)(IWRD(L,2),L=1,4)
 2040 FORMAT(/" YOU CANNOT CARRY THE "4A2)
      IF(IRIT.EQ.2041)WRITE(LDEV,2041)
 2041 FORMAT(/" THE GOLD BULL FIGURINE AND BARS WERE DELICATELY ",
     1"BALANCED AND FELL.")
      IF(IRIT.EQ.2042)WRITE(LDEV,2042)
 2042 FORMAT(/" THE DAGGER MADE A LOUD GRATING SOUND WHEN YOU PULLED ",
     1"IT OUT OF THE SLAB.")
      IF(IRIT.EQ.2041.OR.IRIT.EQ.2042)WRITE(LDEV,2043)
 2043 FORMAT(" THE NOISE WOKE THE TROLL AND HE BLUDGEONED YOU TO ",
     1"DEATH.")
      IF(IRIT.EQ.2041.OR.IRIT.EQ.2042)NAME(2)=MOVEAS("SD")
      IF(NAME(2).EQ.MOVEAS("SD"))CALL EXEC(8,NAME,LU,10030,0)
      IF (IRIT .EQ. 2060) WRITE(LDEV,2060)
 2060 FORMAT(/" YOU WILL HAVE TO DROP SOMETHING FIRST")
      IF (IRIT .EQ. 2070) WRITE(LDEV,2070)(IWRD(L,2),L=1,4)
 2070 FORMAT(/" YOUR BOOTY NOW CONTAINS THE "4A2)
      IF(IRIT.EQ.2110)WRITE(LDEV,2110)
 2110 FORMAT(/" I WOULD RECOMMEND THAT YOU TAKE YOUR SHOWERS IN THE ",
     1"BATHROOM.")
      IF(IRIT.EQ.2120)WRITE(LDEV,2120)
 2120 FORMAT(/" YOU BETTER DROP YOUR BOOTY FIRST.")
      IF(IRIT.EQ.2140)WRITE(LDEV,2140)
 2140 FORMAT(/" YOU WOULD JUST GET YOUR CLOTHES WET.")
      IF(IRIT.EQ.2150)WRITE(LDEV,2150)
 2150 FORMAT(/" YOU ARE NOW REFRESHED AND SMELL A LOT BETTER ALSO.")
      IF (IRIT .EQ. 3010) WRITE(LDEV,3010)(IWRD(L,2),L=1,4)
 3010 FORMAT(/" YOU DO NOT HAVE THE "4A2)
      IF(IRIT.EQ.3012)WRITE(LDEV,3012)
 3012 FORMAT(/" YOU DO NOT HAVE IT.")
      IF(IRIT.EQ.3015)WRITE(LDEV,3015)(IWRD(L,2),L=1,4)
 3015 FORMAT(/" A WOOD NYMPH JUST RAN OUT FROM THE FOREST AND RAN BACK ",
     1"IN AFTER PICKING"/" UP THE "4A2)
      IF (IRIT .EQ. 3030) WRITE(LDEV,3030)
 3030 FORMAT(/" YOU HEAR A THUD AS IT HITS THE BOTTOM OF THE WELL")
      IF (IRIT .EQ. 3040) WRITE(LDEV,3040)
 3040 FORMAT(/" YOU HEAR A SPLASH AS IT HITS THE WATER IN THE WELL")
      IF(IRIT.EQ.3045)WRITE(LDEV,3045)
 3045 FORMAT(/" THE GLOBE JUST BROKE INTO A THOUSAND PIECES, ",
     1"MOMENTARILY RELEASING"/" A CLOUD OF HAZY SMOKE THAT QUICKLY ",
     2"SURROUNDS YOU WITH VISIONS OF"/" THE INHABITANTS OF MYSTERY ",
     3"MANSION LAUGHING AT YOU HIDEOUSLY.")
      IF (IRIT .EQ. 3110) WRITE(LDEV,3110)(IWRD(L,2),L=1,4)
 3110 FORMAT(/" YOU NO LONGER HAVE THE "4A2)
      IF(IRIT.EQ.3210)WRITE(LDEV,3210)
 3210 FORMAT(/" I WOULDN'T DO THAT. THE NYMPH WILL TAKE IT ALL.")
      IF (IRIT .EQ. 4010) WRITE(LDEV,4010)(IWRD(L,4),L=1,4)
 4010 FORMAT(/" FIRST YOU HAVE TO FIND THE "4A2)
      IF (IRIT .EQ. 4030) WRITE(LDEV,4030)(IWRD(L,4),L=1,4)
 4030 FORMAT(/" YOU CANNOT GIVE IT TO THE "4A2)
      IF ((IRIT .EQ. 3110) .AND. (IPR(3).EQ. 1)) WRITE(LDEV,4040)
     1(IWRD(L,4),L=1,4)
 4040 FORMAT(/" YOU GAVE IT TO THE "4A2)
      IF(IRIT.EQ.4050)WRITE(LDEV,4050)
 4050 FORMAT(/" THANKS. IT NEEDS THAT AROUND HERE.")
      IF (IRIT .EQ. 5010) WRITE(LDEV,5010)
 5010 FORMAT(/" YOU CAN ONLY LOOK AT ITEMS AND INHABITANTS")
      IF (IRIT .EQ. 5020) WRITE(LDEV,5020)(IWRD(L,3),L=1,4)
 5020 FORMAT(/" I DO NOT SEE THE "4A2)
      IF(IRIT.NE.5070)GOTO 5100
      IF(IRIT.EQ.5070.AND.IRES(IW63).GT.10000)WRITE(LDEV,5030)
 5030 FORMAT(" AND IS DEAD")
      IF(IRES(IW63)/1000.EQ.9)WRITE(LDEV,5032)
 5032 FORMAT(/" IS SEVERLY WOUNDED AND WILL SOON BE DEAD.")
      IF(IRES(IW63)/1000.EQ.8)WRITE(LDEV,5034)
 5034 FORMAT(/" IS BADLY WOUNDED AND MIGHT DIE.")
      IF(IRES(IW63)/1000.EQ.7)WRITE(LDEV,5036)
 5036 FORMAT(/" IS WOUNDED AND HAS PASSED OUT.")
      IF(IRES(IW63)/1000.EQ.6)WRITE(LDEV,5038)
 5038 FORMAT(/" AND HAS BEEN KNOCKED UNCONSCIOUS.")
      IF(IRES(IW63)/1000.EQ.5)WRITE(LDEV,5040)
 5040 FORMAT(/" AND HAS BEEN SHOT IN THE LEG.")
      IF(IRES(IW63)/1000.EQ.4)WRITE(LDEV,5042)
 5042 FORMAT(/" AND IS WOUNDED.")
      IF(IRES(IW63)/1000.EQ.3)WRITE(LDEV,5044)
 5044 FORMAT(/" AND IS WOUNDED BUT MIGHT RECOVER.")
      IF(IRES(IW63)/1000.EQ.2)WRITE(LDEV,5046)
 5046 FORMAT(/" IS WOUNDED AND WILL BE BETTER SOON.")
      IF(IRES(IW63)/1000.EQ.1)WRITE(LDEV,5048)
 5048 FORMAT(/" IS HURT AND MOVING SLOWLY.")
      IF(IRIT.EQ.5070.AND.IRES(IW63).GT.1000.AND.
     1IW63.NE.1)GOTO 5100
      IF(IRIT.EQ.5070.AND.IW63.EQ.2)WRITE(LDEV,5072)
 5072 FORMAT(/" SHE IS AN OLDER THIN WOMAN WEARING A LONG BLACK DRESS.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.3)WRITE(LDEV,5073)
 5073 FORMAT(/" HE IS A HANDSOME YOUNG MAN AND IS SMARTLY DRESSED.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.4)WRITE(LDEV,5074)
 5074 FORMAT(/" IT IS A HUGE UGLY THING, THAT IS SLOW AND BLIND.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.5)WRITE(LDEV,5075)
 5075 FORMAT(/" HE IS PALE, HAS A LONG BLACK CAPE AND IS BREATHING ",
     1"HEAVILY THROUGH"/" HIS LONG CANINES.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.6)WRITE(LDEV,5076)
 5076 FORMAT(/" HE IS A FRIENDLY LOOKING HUSKY CHAP.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.7)WRITE(LDEV,5077)
 5077 FORMAT(/" HE IS A SMALL MAN WITH DIRTY CLOTHES AND HANDS.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.8)WRITE(LDEV,5078)
 5078 FORMAT(/" SHE IS A SEXY YOUNG WOMAN WITH LONG BLOND HAIR.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.9)WRITE(LDEV,5079)
 5079 FORMAT(/" SHE IS DRESSED IN WHITE AND HAS BLOOD ON HER APRON.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.10)WRITE(LDEV,5080)
 5080 FORMAT(/" HE IS A HAIRY BEAST AND HIS EYES ARE LOOKING DIRECTLY ",
     1"AT YOU.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.11)WRITE(LDEV,5081)
 5081 FORMAT(/" HE IS A LITTLE FELLOW WITH FUNNY CLOTHES AND SNEAKY ",
     1"EYES.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.12)WRITE(LDEV,5082)
 5082 FORMAT(/" HE IS A HEALTHY LOOKING MAN WITH A FULL BEARD.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.13)WRITE(LDEV,5083)
 5083 FORMAT(/" HE IS A MEAN LOOKING LITTLE THING WITH GLOWING EYES.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.14)WRITE(LDEV,5084)
 5084 FORMAT(/" HE IS AN OLDER GENTLEMAN WITH GRAY HAIR AND THICK ",
     1"GLASSES.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.15)WRITE(LDEV,5085)
 5085 FORMAT(/" IT IS A LARGE HUNGRY LOOKING ANIMAL.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.16)WRITE(LDEV,5086)
 5086 FORMAT(/" HE IS A LARGE MUSCULAR MAN WITH HATE IN HIS EYES.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.1)WRITE(LDEV,5090)
 5090 FORMAT(/" FROM THE LOOK OF THE BODY IT HAS NOT BEEN DEAD VERY ",
     1"LONG.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.1.AND.ITST(10).LT.13)WRITE(LDEV,
     A5091)
 5091 FORMAT(/" THE VICTIMS ARMS ARE OUTSTRETCHED AS IF HE WAS DRAGGED ",
     1"HERE."/" HIS SHIRT IS TORN AND ALL BLOODY.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.1.AND.ITST(10).EQ.13)WRITE(LDEV,
     A5092)
 5092 FORMAT(/" IT IS ALL DOUBLED OVER WITH HIS ARMS COVERING HIS ",
     1"STOMACH.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.1.AND.ITST(10).EQ.14)WRITE(LDEV,
     A5093)
 5093 FORMAT(/" IT IS ALL BEATEN AND HIS HEAD IS BASHED IN.")
      IF(IRIT.EQ.5070.AND.IW63.EQ.ITST(9))WRITE(LDEV,5095)
 5095 FORMAT(/" YOU NOTICE A LOOK OF APREHENSION.")
 5100 CONTINUE
      IF (IRIT .EQ. 5110) WRITE(LDEV,5110)(IWRD(L,2),L=1,4)
 5110 FORMAT(/" YOU DO NOT HAVE THE "4A2)
      IF (IRIT .EQ. 5130) WRITE(LDEV,5130)
 5130 FORMAT(/" ON CLOSER INSPECTION IT APPEARS AS THOUGH THE GLOBE ",
     1"IS REALLY A DUSTY"/" CRYSTAL BALL WITH MAGICAL POWERS TO HELP ",
     2"YOU FIND INHABITANTS")
      IF(IRIT.EQ.5140)WRITE(LDEV,5140)
 5140 FORMAT(/" THE ROPE IS ABOUT 50 FEET LONG WITH A GRAPLING HOOK ",
     1"ON ONE END")
      IF (IRIT .EQ. 5170) WRITE(LDEV,5170)
 5170 FORMAT(/" THE MAP IS ONLY OF THE WOODS AND THE ROAD WHICH YOU ",
     1"ARE NOT NEAR.")
      IF(IRIT .EQ. 5210) WRITE(LDEV,5210) IW63
 5210 FORMAT(/" THE CANDLE IS ABOUT"I2" INCHES LONG")
      IF(IRIT .EQ. 5310.AND.IVEN(27).GT.21000) WRITE(LDEV,5310)
 5310 FORMAT(/" THE TORCH IS LIT")
      IF(IRIT.EQ.5310.AND.IVEN(27).LT.21000) WRITE(LDEV,5311)
 5311 FORMAT(/" THE TORCH IS ALL BURN OUT")
      IF(IRIT .EQ. 5410) WRITE(LDEV,5410)ITST(11)
 5410 FORMAT(/" YOUR GUN HAS"I2" SHOTS LEFT")
      IF(IRIT .EQ. 5510) WRITE(LDEV,5510)IPR(3)/100,IPR(3)-
     A((IPR(3)/100)*100)
 5510 FORMAT(/" THE TIME IS"I3":"I2)
      IF(IRIT .EQ. 5610) WRITE(LDEV,5610)(IVRB(L,ITST(16)),L=1,4)
 5610 FORMAT(/" THE BOOK CONTAINS WORDS I KNOW LIKE THE VERB "4A2)
      IF(IRIT .EQ. 5710) WRITE(LDEV,5710)(IDTN(L,IPR(3)),L=1,4)
 5710 FORMAT(/" YOU ARE FACING "4A2)
      IF(IRIT .EQ. 5720) WRITE(LDEV,5720)
 5720 FORMAT(/" THE VIAL IS EMPTY BUT SMELLS LIKE POISON")
      IF(IRIT .EQ. 5730) WRITE(LDEV,5730)
 5730 FORMAT(/" THE VIAL IS FULL OF POISON")
      IF(IRIT .EQ. 5740) WRITE(LDEV,5740)
 5740 FORMAT(/" THERE IS BLOOD ON IT")
      IF(IRIT.EQ.5750.AND.LU.NE.ITST(21)) IVEN(22)=IVEN(22)+1000
      IF(IRIT .EQ. 5750) WRITE(LDEV,5750)
 5750 FORMAT(/" THE NOTE SAYS:")
      IF((IRIT .EQ. 5750) .AND. (ITST(5) .LE. 50)) WRITE(LDEV,5751)
 5751 FORMAT(" I CAN HELP YOU OPEN THE GATE")
      IF((IRIT .EQ. 5750) .AND. (ITST(5) .GT. 50) .AND. (ITST(5)
     1.LE. 100)) WRITE(LDEV,5752)
 5752 FORMAT(" YOU CAN GO IN ANY DIRECTION BY JUST ENTERING THE FIRST ",
     1"LETTER")
      IF(IRIT.EQ.5750.AND.ITST(5).GT.100.AND.ITST(5).LE.150.AND.
     1ITST(8).NE.0)WRITE(LDEV,5753)
 5753 FORMAT(" IF YOU HAVE THE MURDER WEAPON AND CAN GET THE MURDERER ",
     A"TO RETURN TO"/" THE SCENE OF THE CRIME WITH YOU, YOU WILL SCORE ",
     1"POINTS")
      IF(IRIT.EQ.5750.AND.ITST(5).GT.100.AND.ITST(5).LE.150.AND.
     1ITST(8).EQ.0)WRITE(LDEV,5754)
 5754 FORMAT(/" CONGRATULATIONS FOR SOLVING THE MURDER SO ",
     1"QUICKLY.")
      IF(IRIT.EQ.5750.AND.ITST(5).GT.150.AND.ITST(5).LE.200.AND.
     1IRES(5).NE.0)WRITE(LDEV,5755)
 5755 FORMAT(" WATCH OUT FOR THE VAMPIRE. IF YOU CAN DESTROY HIM, ",
     1"YOU WILL SCORE POINTS")
      IF(IRIT.EQ.5750.AND.ITST(5).GT.150.AND.ITST(5).LE.200.AND.
     1IRES(5).EQ.0)WRITE(LDEV,5756)(IRSN(L,ITST(39)),L=1,4)
 5756 FORMAT(/" LAST MONTH, IN THIS MYSTERY, A PLAYER LEFT A ",
     1"CURTAIN OPEN AND THE "4A2/" SAW THE FULL MOON THROUGH ",
     2"IT AND TRANSFORMED INTO A WEREWOLF.")
      IF((IRIT .EQ. 5750) .AND. (ITST(5) .GT. 200) .AND. (ITST(5)
     1.LE. 250)) WRITE(LDEV,5757)
 5757 FORMAT(" YOU WILL HAVE TO GO DOWN INTO THE DARK PIT TO FIND ",
     1"A BATTERY FOR THE LANTERN")
      IF((IRIT .EQ. 5750) .AND. (ITST(5) .GT. 250) .AND. (ITST(5)
     1.LE. 300)) WRITE(LDEV,5758)
 5758 FORMAT(" BEWARE; THE MOON IS FULL TONIGHT AND SOMEONE HERE IS A ",
     1"WEREWOLF."/" KILL IT AND YOU WILL SCORE POINTS.")
      RND1=RND*7.7-INT(RND*7.7)
      IC=INT(RND1*3)
      IF(IRIT.EQ.5750.AND.IC.EQ.0.AND.ITST(5).GT.300.AND.ITST(5).LE.
     1350.AND.ITST(8).NE.0)WRITE(LDEV,5759)(IRNM(L,IFSD(IROM(ITST
     2(8)))),L=1,8)
 5759 FORMAT(" IN CASE YOU HAVEN'T GUESSED, THE SCENE OF THE CRIME IS ",
     1"THE "8A2)
      IF(IRIT.EQ.5750.AND.IC.EQ.1.AND.ITST(5).GT.300.AND.ITST(5)
     1.LE.350.AND.ITST(8).NE.0)WRITE(LDEV,5760)(IWP(L),L=1,4)
 5760 FORMAT(" IN CASE YOU HAVEN'T GUESSED, THE MURDER WAS COMITTED ",
     1"WITH THE "4A2)
      IF(IRIT.EQ.5750.AND.IC.EQ.2.AND.ITST(5).GT.300.AND.ITST(5).
     1LE.350.AND.ITST(8).NE.0)WRITE(LDEV,5761)(IRSN(L,ITST(9)),L=1,4)
 5761 FORMAT(" IN CASE YOU HAVEN'T GUESSED, THE MURDERER IS THE "4A2)
      IF(IRIT.EQ.5750.AND.ITST(5).GT.300.AND.ITST(5).LE.350.AND.
     1ITST(8).EQ.0)WRITE(LDEV,5762)
 5762 FORMAT(/" MAGIC WORDS DO NOT WORK AFTER THE GARDEN CLOSES.")
      IF((IRIT .EQ. 5750) .AND. (ITST(5) .GT. 350) .AND. (ITST(5)
     1.LE. 400)) WRITE(LDEV,5763)
 5763 FORMAT(" YOU MIGHT BE ABLE TO SCORE POINTS WHEN YOU HEAR ",
     1"SOMETHING")
      IF((IRIT .EQ. 5750) .AND.(ITST(5) .GT. 400) .AND.(ITST(5)
     1.LE. 450)) WRITE(LDEV,5764)
 5764 FORMAT(" SOME ONE HAS TAKEN A LOT OF DYNAMITE INTO THE PASSAGES ",
     1"BELOW THE MANSION")
      IF((IRIT .EQ. 5750) .AND. (ITST(5) .GT. 450)) WRITE(LDEV,5765)
 5765 FORMAT(" I'D GET OUT OF HERE IF I WERE YOU")
      IF(IRIT .EQ. 5750) WRITE(LDEV,5766)
 5766 FORMAT(" SIGNED: A FRIEND")
      IF(IRIT .EQ. 5775) WRITE(LDEV,5775)
 5775 FORMAT(/" THE NOTE SAYS THE SAME AS IT DID BEFORE")
      IF(IRIT .EQ. 5780) WRITE(LDEV,5780)
 5780 FORMAT(/" THE BULLET IS OLD AND TARNISHED")
      IF(IRIT .EQ. 5781) WRITE(LDEV,5781)
 5781 FORMAT(/" THE TALISMAN SAYS: HAVING THIS CAN HELP YOU GET ",
     1"REINCARNATED IF YOU DIE")
      IF(IRIT.EQ.5782)WRITE(LDEV,5782)
 5782 FORMAT(/" THE CHEST IS VERY OLD WITH MYSTERIOUS WRITING ON IT")
      IF((IRIT.EQ.5782.OR.IRIT.EQ.5783).AND.IFD(IVEN(35)).EQ.0)
     1WRITE(LDEV,5783)
 5783 FORMAT(/" THERE IS A PADLOCK LOCKING AN UNUSUAL HASP OF KNOTTED ",
     1"WIRE")
      IF(IRIT.EQ.5782.AND.IFSD(IRES(8)).EQ.ITST(1).AND.
     1IRES(8).LT.10000)WRITE(LDEV,5784)
 5784 FORMAT(/" THIS CHEST CONTAINS A CLUE, READS THE MAID BESIDE YOU")
      IF(IRIT.EQ.5782.AND.IFSD(IRES(14)).EQ.ITST(1).AND.
     1IRES(14).LT.10000)WRITE(LDEV,5785)
 5785 FORMAT(/" DON'T OPEN THIS CHEST IN AN UNLOCKED ROOM, READS THE ",
     1"MASTER BEHIND YOU")
      IF(IRIT.EQ.5782.AND.IFSD(IRES(2)).EQ.ITST(1).AND.
     1IRES(2).LT.10000)WRITE(LDEV,5786)
 5786 FORMAT(/" BE SURE TO CLOSE THE CHEST AS QUICKLY AS POSSIBLE, ",
     1"READS THE"/" LADY IN FRONT OF YOU")
      IF(IRIT.EQ.5810)WRITE(LDEV,5810)
 5810 FORMAT(/" YOU CAN SEE YOUR REFLECTION AND THINGS IN THE ROOM ",
     1"BEHIND YOU")
      IF(IRIT.EQ.5810.AND.IPR(3).GT.0)WRITE(LDEV,5820)(IRSN(L,IPR(3)),L=
     11,4)
 5820 FORMAT(/" ALSO, BESIDE YOU IN THE MIRROR IS THE REFLECTION OF ",
     1"THE "4A2)
      IF(IRIT.EQ.5810.AND.IPR(3).EQ.2)WRITE(LDEV,5072)
      IF(IRIT.EQ.5810.AND.IPR(3).EQ.3)WRITE(LDEV,5073)
      IF(IRIT.EQ.5810.AND.IPR(3).EQ.8)WRITE(LDEV,5078)
      IF(IRIT.EQ.5810.AND.IPR(3).EQ.10)WRITE(LDEV,5080)
      IF(IRIT.EQ.5830)WRITE(LDEV,5830)
 5830 FORMAT(/" THE AMULET IS A LARGE ODD SHAPED JEWEL WITH EIGHT ",
     1"FACETS, FOUR BEING HEXAGONS.")
      IF(IRIT.EQ.5860)WRITE(LDEV,5860)
 5860 FORMAT(/" THE WOOD IS A STACK OF SEVERAL LARGE LOGS AND A COUP",
     1"LE OF SMALL"/" LOGS WEDGED AGAINST THE WALL BY THE FIREPLACE.")
      IF(IRIT.EQ.5860.AND.ITST(5).GT.50)WRITE(LDEV,5861)
 5861 FORMAT(" THE LOGS ON THE TOP LOOK LIKE THEY WERE JUST PUT ",
     1"THERE.")
      IF(IRIT.EQ.5870)WRITE(LDEV,5870)
 5870 FORMAT(/" THE WEDGE IS A POINTED PIECE OF WOOD ABOUT A FOOT ",
     1"LONG AND IS USED TO"/" KEEP THE LOGS FROM ROLLING.")
      IF(IRIT.EQ.5880)WRITE(LDEV,5880)
 5880 FORMAT(/" THE PLAQUE IS INSCRIBED:"/" DO NOT STAY HERE LONG.",
     1"THE BOARDS ARE LOOSE AND YOU MIGHT FALL THROUGH.")
      IF(IRIT.EQ.5885)WRITE(LDEV,5885)
 5885 FORMAT(/" THE SCROLL IS ROLLED UP AND YOU CANNOT SEE THE ",
     1"WRITING.")
      IF(IRIT.EQ.5886)WRITE(LDEV,5886)
 5886 FORMAT(/" YOU ARE LOOKING AT A DRAWING OF SOME KIND OF A LEVER ",
     1"SYSTEM CENTERED AROUND"/" A TRIANGULAR CAVITY CUT IN THE WALL.")
      IF(IRIT.EQ.5888.OR.IRIT.EQ.5890)WRITE(LDEV,5888)
 5888 FORMAT(/" THE TROLL IS A HUGE UGLY THING SLEEPING FITFULLY ON A ",
     1"PILE OF BONES.")
      IF(IRIT.EQ.5888.AND.IVEN(36).EQ.1151)WRITE(LDEV,5889)
 5889 FORMAT(" IT HAS A BIG BLUDGEON IN ONE HAND AND A STRING OF ",
     1"PEARLS IN THE OTHER.")
      IF(IRIT.EQ.5890.AND.IVEN(39).EQ.1253)WRITE(LDEV,5890)
 5890 FORMAT(" IT HAS A LARGE MACE IN ONE HAND AND A SILVER GOBLET ",
     1"IN THE OTHER.")
      IF(IRIT.EQ.5891)WRITE(LDEV,5891)
 5891 FORMAT(/" IT IS A COLORFUL BIRD WITH A BAND ON ITS LEG ",
     1"THAT SAYS 'I CAN FIND THINGS.'")
      IF(IRIT.EQ.5892)WRITE(LDEV,5892)
 5892 FORMAT(/" THE GAUNTLET IS A SOFT METAL GLOVE THAT SEEMS TO ",
     1"GIVE YOU EXTRA STRENGTH.")
      IF(IRIT.EQ.5893)WRITE(LDEV,5893)
 5893 FORMAT(/" THE TABELS ARE IN 8 ROWS AND SOME OF THE TABLES HAVE ",
     1"FIGURES CARVED IN THEM."/" THE TWO NEAREST YOU ARE MADE OF ",
     2"DIFFERENT KINDS OF WOOD AND HAVE THE FIGURES "/" OF A KING AND ",
     3"QUEEN ON THEM.")
      IF (IRIT .EQ. 5910) WRITE(LDEV,5910)
 5910 FORMAT(/" I DON'T KNOW WHAT YOU EXPECT TO SEE")
      IF(IRIT.EQ.6005)WRITE(LDEV,6005)(IWRD(L,2),L=1,4)
 6005 FORMAT(/" IF YOU LOOK YOU CAN SEE THE "4A2)
      IF (IRIT .EQ. 6010) WRITE (LDEV,6010)
 6010 FORMAT(/" YOU WOULD NEED A CRYSTAL BALL TO SEE ANYONE ",
     1"NOT WITH YOU")
      IC=1
      IF((IFSD(IRES(IWRD(6,2))).EQ.54).OR.
     1(IFSD(IRES(IWRD(6,2))).EQ. 71).OR.(IFSD(IRES(IWRD(6,2))).EQ.72)
     2.OR.(IFSD(IRES(IWRD(6,2))).EQ.81).OR.(IFSD(IRES(IWRD(6,2))).EQ.
     382).OR.(IFSD(IRES(IWRD(6,2))).EQ.85).OR.(IFSD(IRES(IWRD(6,2)))
     4.EQ.86).OR.IFSD(IRES(IWRD(6,2))).EQ.92.OR.IFSD(IRES(IWRD(6,2)))
     5.EQ.91) IC=2
      IF(((IFSD(IRES(IWRD(6,2))) .GE. 73) .AND. (IFSD(IRES(IWRD(6,2)))
     1.LE. 77)) .OR. (IFSD(IRES(IWRD(6,2))).EQ. 99)) IC=3
      IF((IFSD(IRES(IWRD(6,2))) .EQ. 55) .OR. (IFSD(IRES(IWRD(6,2)))
     1.EQ. 57) .OR. (IFSD(IRES(IWRD(6,2))) .EQ. 93) .OR. (ITST(1)
     2.EQ. 95)) IC=4
      IF (IRIT .EQ. 6020) WRITE (LDEV,6020) (IWRD(L,2),L=1,4),
     1IPRP(1,IC),(IRNM(L,IPR(3)),L=1,8)
 6020 FORMAT(/" AS YOU GAZE INTO THE CRYSTAL BALL, THE FIGURE OF THE "
     14A2/" COMES INTO FOCUS "A2" THE "8A2)
      IF(IRIT.EQ.6030)WRITE(LDEV,6030)
 6030 FORMAT(/" YOU DO NOT YET HAVE THE MEANS TO FIND ITEMS NOT NEAR ",
     1"YOU.")
      IF(IRIT.EQ.6040.OR.IRIT.EQ.6035)WRITE(LDEV,6040)
 6040 FORMAT(/" THE PARROT FLEW AWAY FOR A FEW MINUTES AND CAME BACK ",
     1"SAYING:")
      IF(IRIT.EQ.6040.AND.IVEN(IWRD(6,2)).LT.10000)
     1WRITE(LDEV,6042)(IRNM(L,IFSD(IROM(IFSD(IVEN(IWRD(6,2)))))),L=1,8)
 6042 FORMAT(" BAAAAAAKKK: ",8A2)
      IF(IRIT.EQ.6035)WRITE(LDEV,6044)
 6044 FORMAT(" BAAAAAAKKK: SORRY CHARLIE!")
      IF(IRIT.EQ.6040.AND.IVEN(IWRD(6,2)).GT.10000)
     1WRITE(LDEV,6045)(IRSN(L,IFSD(IVEN(IWRD(6,2)))),L=1,4)
 6045 FORMAT(" BAAAAAAKKK: ",4A2)
      IF (IRIT .EQ. 7050) WRITE(LDEV,7050)
 7050 FORMAT(" NOTHING")
      IF (IRIT .EQ. 8010 ) WRITE(LDEV,8010)
 8010 FORMAT(/" I DON'T KNOW WHAT YOU EXPECT TO HAPPEN")
      IF(IRIT .EQ. 8015) WRITE(LDEV,8015)(IWRD(L,2),L=1,4)
 8015 FORMAT(/" YOUR FOOD HAS BEEN EATEN BY THE "4A2)
      IF (IRIT .EQ. 8020) WRITE(LDEV,8020)
 8020 FORMAT(/" IT ALREADY IS")
      IF(IRIT.EQ.8030)WRITE(LDEV,8030)(IWRD(L,3),L=1,4)
 8030 FORMAT(/" I DON'T SEE THE "4A2)
      IF(IRIT.EQ.8031)WRITE(LDEV,8031)(IWRD(L,2),L=1,4)
 8031 FORMAT(/" I DON'T SEE THE "4A2)
      IF(IRIT .EQ. 8035) WRITE(LDEV,8035)
 8035 FORMAT(/" THE BATTERY IN YOUR LANTERN IS DEAD")
      IF (IRIT .EQ. 8040) WRITE(LDEV,8040)(IRSN(L,ITST(9)),L=1,4)
 8040 FORMAT(/" AFTER THE RADIO WARMS UP AND THE STATIC DIES DOWN YOU ",
     1"HEAR"/" A NEWS REPORT THAT THE POLICE ARE LOOKING FOR THE "4A2/
     2" OF MYSTERY MANSION FOR SEVERAL MURDERS")
      IF(IRIT.EQ.8045)WRITE(LDEV,8045)
 8045 FORMAT(/" THE RADIO PLAYS SOFT MUSIC AFTER IT WARMS UP.")
      IF (IRIT .EQ. 8050) WRITE(LDEV,8050)
 8050 FORMAT(/" YOU NEED A MATCH OR SOMETHING.")
      IF (IRIT .EQ. 8060) WRITE(LDEV,8060)
 8060 FORMAT(/" THE TORCH IS ALL BURNED OUT AND YOU CANNOT LIGHT IT")
      IF(IRIT.EQ.9027)WRITE(LDEV,9027)
 9027 FORMAT(/" YOU DON'T HAVE ENOUGH POINTS")
      IF(IRIT.EQ.9040)WRITE(LDEV,9040)
 9040 FORMAT(/" DON'T ASK FOR HELP ANYMORE")
      IF(IRIT.EQ.9041)WRITE(LDEV,9041)
 9041 FORMAT(/" QUIT WHILE YOU ARE STILL ALIVE")
      IF(IRIT.EQ.9042)WRITE(LDEV,9042)
 9042 FORMAT(/" YOU WILL NEVER FIGURE IT ALL OUT")
      IF(IRIT.EQ.9043)WRITE(LDEV,9043)
 9043 FORMAT(/" READ WHAT I SAY CAREFULLY.")
      IF(IRIT.EQ.9044)WRITE(LDEV,9044)
 9044 FORMAT(/" A GOOD WAY TO START IS BY SAYING 'GO WEST' OR 'GO ",
     1"EAST'")
      IF(IRIT.EQ.9045)WRITE(LDEV,9045)
 9045 FORMAT(/" KEEP MOVING AND YOU WILL GET OUT OF THE WOODS ",
     1"SOONER OR LATER")
      IF(IRIT.EQ.9046)WRITE(LDEV,9046)
 9046 FORMAT(/" TRY SAYING A MAGIC WORD")
      IF(IRIT.EQ.9047)WRITE(LDEV,9047)
 9047 FORMAT(/" TRY BRING A CHAIR IN HERE OR CLOSING THE DOOR")
      IF(IRIT.EQ.9048)WRITE(LDEV,9048)
 9048 FORMAT(/" UNLESS YOU KNOW A MAGIC WOOD, THERE IS NOTHING I CAN ",
     1"DO FOR YOU")
      IF(IRIT.EQ.9049)WRITE(LDEV,9049)
 9049 FORMAT(/" THERE IS NOTHING YOU CAN DO UNLESS YOU KNOW A MAGIC ",
     1"WORD OR HAVE A SHOVEL.")
      IF(IRIT.EQ.9050)WRITE(LDEV,9050)
 9050 FORMAT(/" UNLESS YOU KNOW A MAGIC WORD OR CAN OIL THE HINGE ON ",
     1"THE FIRE ESCAPE,"/" THERE IS NOTHING I CAN DO FOR YOU.")
      IF(IRIT.EQ.9051)WRITE(LDEV,9051)
 9051 FORMAT(/" TRY DROPPING THINGS TO USE AS A POINT OF REFERENCE.")
      IF(IRIT.EQ.10020)WRITE(LDEV,10020)
10020 FORMAT(/" YOU HAVE NOT FIGURED OUT HOW NOT DO THAT YET.")
      IF(IRIT.EQ.10035)WRITE(LDEV,10035)
10035 FORMAT(/" THE DOOR IS LOCKED")
      IF(IRIT.EQ.10045)WRITE(LDEV,10045)
10045 FORMAT(/" THE DOOR IS OPEN")
      IF(IRIT.EQ.10046)WRITE(LDEV,10046)
10046 FORMAT(/" THE DOOR IS CLOSED")
      IF(IRIT .EQ. 10010) WRITE(LDEV,10010)
10010 FORMAT(/" THERE IS NO CURTAIN HERE")
      IF(IRIT.EQ.10085)WRITE(LDEV,10085)
10085 FORMAT(/" YOU TRAPPED THE VAMPIRE IN THE DAYLIGHT AND HE ",
     1"SHRIVELED INTO NOTHING.")
      IF(IRIT.EQ.10105)WRITE(LDEV,10105)
10105 FORMAT(/" THE GARDEN GATE IS NOW CLOSED PERMANENTLY.")
      IF(IRIT .EQ. 10110) WRITE(LDEV,10110)
10110 FORMAT(/" THE GATE IS STUCK OPEN")
      IF(IRIT.EQ.10115)WRITE(LDEV,10115)(IRSN(L,IPR(3)),L=1,4)
10115 FORMAT(/" WITH A MIGHTY SHOVE, YOU MOVE THE GATE WITH THE ",
     1"HELP OF THE "4A2)
      IF(IRIT.EQ.10116)WRITE(LDEV,10116)
10116 FORMAT(/" THE GAUNTLET ALLOWS YOU TO EASILY MOVE THE GATE.")
      IF(IRIT .EQ. 10130) WRITE(LDEV,10130)
10130 FORMAT(/" THE GATE IS TOO HEAVY FOR YOU TO OPEN ALONE.")
      IF(IRIT.EQ.10210)WRITE(LDEV,10210)
10210 FORMAT(/" 1000 SCREAMING DEMONS FLEE THE CONFINES OF THE CHEST ",
     1"AFTER CENTURIES OF"/" IMPRISONMENT AND SCATTER ABOUT THE ",
     2"MANSION AND GROUNDS TO TORMENT YOU AND"/" IMPEDE YOUR EVERY ",
     3"MOVE")
      IF(IRIT.EQ.10230)WRITE(LDEV,10230)(IRNM(L,IFSD(IROM(ITST(8))))
     1,L=1,8)
10230 FORMAT(/" 1000 SCREAMING DEMONS FLEE THE CONFINES OF THE CHEST ",
     1"AND SCATTER ABOUT"/" THE ROOM LOOKING FOR A WAY OUT. FINDING ",
     2"NO WAY OUT THEY RETURN TO THE CHEST"/" MURMURING SOMETHING ",
     3"ABOUT MURDER AND THE "8A2)
      IF(IRIT .EQ. 10910) WRITE(LDEV,10910)(IWRD(L,2),L=1,4)
10910 FORMAT(/" YOU CANNOT OPEN THE "4A2)
      IF(IRIT.EQ.12140)WRITE(LDEV,12140)
12140 FORMAT(/" THE FLOOR SLID HALFWAY INTO THE WALL. AS YOU ",
     1"LOOK DOWN, YOU CAN"/" SEE A DEEP SHAFT WITH A SPIRAL WALKWAY ",
     2"CARVED INTO THE RIM"/" DECENDING INTO THE VAST DARKNESS.")
      IF(IRIT .EQ. 15020) WRITE(LDEV,15020)
15020 FORMAT(/" THE DOOR YOU ARE FACING HAS NO LOCK")
      IF(IRIT .EQ. 15030) WRITE(LDEV,15030)
15030 FORMAT(/" YOU ARE NOT FACING A DOOR")
      IF(IRIT .EQ. 15040) WRITE(LDEV,15040)
15040 FORMAT(/" YOU NEED A KEY")
      IF(IRIT.EQ.15110)WRITE(LDEV,15110)
15110 FORMAT(/" YOUR KEY WILL NOT FIT THE PADLOCK")
      IF (IRIT .EQ. 16010) WRITE(LDEV,16010)
16010 FORMAT(/" YOU NEED A GUN TO SHOOT ANYONE")
      IF(IRIT .EQ. 16020) WRITE(LDEV,16020)
16020 FORMAT(/" YOUR GUN IS OUT OF BULLETS")
      IF(IRIT .EQ. 16030) WRITE(LDEV,16030)
16030 FORMAT(/" YOU MISSED")
      IF(IRIT.EQ.16035)WRITE(LDEV,16035)
16035 FORMAT(/" YOU JUST SMASHED THE PADLOCK TO PIECES")
      IF(IRIT.EQ.16035)IVEN(35)=IVEN(35)+1000
      IF(IRIT .EQ. 16040) WRITE(LDEV,16040)(IWRD(L,2),L=1,4)
16040 FORMAT(/" YOU JUST WASTED A SHOT. IT DID YOU NO GOOD TO SHOOT ",
     1"THE "4A2)
      IF(IRIT.EQ.16045)WRITE(LDEV,16045)
16045 FORMAT(/" YOU KILLED THE DWARF AND HE DISAPPEARED IN A CLOUD OF ",
     1"GREASY BLACK SMOKE")
      IF(IRIT.EQ.16045)IRES(13)=IRES(13)+100
      IF(IRIT .EQ. 16050) WRITE(LDEV,16050)(IWRD(L,2),L=1,4)
16050 FORMAT(/" YOU JUST SHOT AND KILLED THE "4A2)
      IF(IRIT .EQ. 20030) WRITE(LDEV,20030)
20030 FORMAT(/" DON'T BE SILLY")
      IF(LU.NE.IPR(1).OR.ITST(21).EQ.0)GOTO 9999
      LU=ITST(21)
      GOTO 999
 9999 NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
      STOP
      END
$CONTROL SEGMENT=MMSH
      SUBROUTINE MMSH
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      DIMENSION ITIM(5),IVRBX(4,8)
C
      INTEGER MOVEAS,THAW,FREEZE
      IFSD(I)=I-(I/100)*100
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      RN(R)=R*7.7-INT(R*7.7)
      NAME(2)=MOVEAS("SI")
      LU=IPR(1)
      IR=ITST(1)
      IW71=IWRD(7,1)
      IW52=IWRD(5,2)
      IW62=IWRD(6,2)
      R=RND
      GOTO(1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,
     A10000,11000,12000,13000,14000,15000,16000,17000),IWRD(6,1)-35
 1000 IF(IW71.NE.1.AND.(IW52.NE.3.OR.IW62.GT.35))
     1CALL EXEC(8,NAME,LU,320,0)
      IF(IW71.EQ.1)IW62=24
      IF(IVEN(IW62).LT.20000)CALL EXEC(8,NAME,LU,3010,0)
      IF(IW62.NE.22.AND.IW62.NE.24.AND.IW62.NE.28.AND.
     1IW62.NE.29.AND.IW62.NE.31)CALL EXEC(8,NAME,LU,2010,0)
      IVEN(IW62)=0
      IF(IW62.EQ.24)CALL EXEC(8,NAME,LU,1010,0)
      CALL EXEC(8,NAME,LU,1020,0)
 2000 IF((IW52.NE.3.AND.IW52.NE.4).OR.(IW52.EQ.4.AND.
     1IW62.NE.8).OR.(IW52.EQ.3.AND.IVEN(IW62).EQ.0))
     2CALL EXEC(8,NAME,LU,320,0)
      CALL MMRL
      IF(IWRD(6,2).EQ.88.AND.IR.EQ.17)CALL EXEC(8,NAME,LU,2037,0)
      IF((IW52.EQ.4.AND.IFSD(IRES(8)).NE.IR).OR.(IW52.EQ.3
     1.AND.IW62.GT.35.AND.IVEN(IW62).NE.IR))CALL EXEC
     2(8,NAME,LU,2030,0)
      IF(IW52.EQ.4.AND.IR.NE.25)CALL EXEC(8,NAME,LU,2080,0)
      IF(IW52.EQ.4)IXT(134)=2225
      IF(IW52.EQ.4)CALL EXEC(8,NAME,LU,1095,IR)
      IF(IW62.LT.36.AND.IVEN(IW62).LT.20000)
     1CALL EXEC(8,NAME,LU,3010,0)
      IF(IW62.NE.45)CALL EXEC(8,NAME,LU,520,0)
      CALL EXEC(8,NAME,LU,2090,0)
 3000 IF(IW71.NE.2.OR.IW52.NE.2.OR.(IW62.NE.5.AND.
     1IW62.NE.6))CALL EXEC(8,NAME,LU,320,0)
      IF(IW62.EQ.5.AND.IVEN(23).LT.20000)CALL EXEC(8,NAME,LU,3050,0)
      IF(IW62.EQ.5)ITST(1)=89
      IF(IW62.EQ.5)CALL EXEC(8,NAME,LU,3060,0)
      IF(IR.NE.89)CALL EXEC(8,NAME,LU,3070,0)
      IC=IFSD(IVEN(26))
      IF(IVEN(26).EQ.789.OR.IVEN(26).GT.20000.OR.(IVEN(26).LT.20000
     1.AND.IVEN(26).GT.10000.AND.IFSD(IRES(IC)).EQ.89))
     2CALL EXEC(8,NAME,LU,3080,0)
      IF(IVEN(26).GT.10000)IC=IFSD(IRES(IC))
      IF(IC.EQ.0)CALL EXEC(8,NAME,LU,520,0)
      ITST(1)=IC
      CALL EXEC(8,NAME,LU,3090,IC)
 4000 IF(IW71.NE.1)CALL EXEC(8,NAME,LU,320,0)
      IF(IVEN(25).LT.20000)CALL EXEC(8,NAME,LU,4055,0)
      CALL MMRL
      IF(IR.NE.23)CALL EXEC(8,NAME,LU,4050,0)
      IXT(191)=2223
      CALL EXEC(8,NAME,LU,1095,IR)
 5000 IF(IW52.NE.3.OR.IW62.LT.55.OR.IW62.GT.58)
     1CALL EXEC(8,NAME,LU,320,0)
      IF(IR.NE.11) CALL EXEC(8,NAME,LU,8032,0)
      IC=0
      IF(IW62.EQ.55.AND.ITST(8).EQ.0.AND.IXT(54).LT.20000
     1.AND.IFSD(IRES(ITST(9))).EQ.IR)IC=1
      IF(IC.EQ.1) IRES(ITST(9))=0
      IF(IC.EQ.1)ITST(2)=ITST(2)+50
      IF(IC.EQ.1) CALL EXEC(8,NAME,LU,5001,0)
      IF(IW62.EQ.58.AND.IXT(52).NE.0.AND.ITST(5).GT.400)IXT(52)=0
      IF(IXT(52).EQ.0.AND.IW62.EQ.58)CALL EXEC(8,NAME,LU,5002,0)
      CALL EXEC(8,NAME,LU,5009,0)
 6000 IF(IW71.NE.2.OR.IW52.NE.3.OR.IVEN(IW62).EQ.0)
     1CALL EXEC(8,NAME,LU,320,0)
      CALL MMRL
      IF((IW62.EQ.94.OR.IW62.EQ.97.OR.IW62.EQ.98).AND.IR.EQ.15)
     1CALL EXEC(8,NAME,LU,6005,0)
      IF(IW62.EQ.95.AND.IR.EQ.15.AND.IVEN(48).EQ.0)
     1CALL EXEC(8,NAME,LU,6015,0)
      IF(IWRD(6,2).EQ.88.AND.IR.EQ.17)CALL EXEC(8,NAME,LU,2037,0)
      IF(IW62.EQ.68.AND.IR.EQ.27)CALL EXEC(8,NAME,LU,6030,0)
      IF(IW62.EQ.68.AND.IR.EQ.88)CALL EXEC(8,NAME,LU,6040,0)
      IF(IW62.EQ.84.AND.(IR.LT.42.OR.IR.GT.50))CALL EXEC(8,NAME,LU,
     A8031,0)
      IF(IW62.EQ.84.AND.IXT(320).NE.0)CALL EXEC(8,NAME,LU,1040,0)
      R=RN(R)
      IF(IW62.EQ.84.AND.R.LT..333.AND.IR.GT.42.AND.IR.LT.47)IVEN(38)=
     1100+IR
      IF(IW62.EQ.84.AND.R.LT..333.AND.IR.GT.42.AND.IR.LT.47)
     1CALL EXEC(8,NAME,LU,6010,0)
      IF(IW62.EQ.84)CALL EXEC(8,NAME,LU,1040,0)
      IF(IW62.EQ.83.AND.(IXT(320).NE.0.OR.IR.NE.52))
     1CALL EXEC(8,NAME,LU,8031,0)
      IF(IW62.EQ.83.AND.IVEN(48).LT.20000)CALL EXEC(8,NAME,LU,6041,0)
      IF(IW62.EQ.83.AND.IVEN(36).NE.0.AND.IXT(319).EQ.4952)
     1CALL EXEC(8,NAME,LU,6042,0)
      IF(IW62.EQ.83.AND.R.GT..67.AND.IXT(319).NE.0)IVEN(36)=152
      IF(IW62.EQ.83.AND.R.GT..67.AND.IXT(319).NE.0)
     1CALL EXEC(8,NAME,LU,6043,0)
      IF(IW62.EQ.83)CALL EXEC(8,NAME,LU,6044,0)
      IF(IVEN(IW62).NE.IR.AND.IW62.GT.47)
     1CALL EXEC(8,NAME,LU,8031,0)
      IF(IW62.LT.54.AND.IVEN(IW62).LT.20000)
     1CALL EXEC(8,NAME,LU,8005,0)
      IF(IW62.EQ.67)IXT(187)=1314
      IF(IW62.EQ.67)CALL EXEC(8,NAME,LU,1095,IR)
      CALL EXEC(8,NAME,LU,8010,0)
 7000 IF(IW52 .NE. 3.OR.IW62.NE.73.OR.IW71.NE.2)
     1CALL EXEC(8,NAME,LU,320,0)
      CALL MMRL
      IF(IR .NE. 11) CALL EXEC(8,NAME,LU,8031,0)
      IC=ITD(IVEN(73))
      IF(IC.NE.0)IVEN(73)=1000
      IF(IC.NE.0)CALL EXEC(8,NAME,LU,7010,IC)
      CALL EXEC(8,NAME,LU,7090,0)
 8000 IF(IW71.NE.2.OR.(IW52.NE.4.AND.IW62.NE.63))CALL
     1EXEC(8,NAME,LU,320,0)
      CALL MMRL
      IF(IR.NE.1.AND.IW62.EQ.63)CALL EXEC(8,NAME,LU,2030,0)
      IF((IR .EQ. 1) .AND. (IW62 .EQ. 63)) IXT(1)=401
      IF((IR.EQ.1).AND.(IW62.EQ.63)) CALL EXEC(8,NAME,LU,1095,IR)
      IF(IVEN(24).LT.20000)CALL EXEC(8,NAME,LU,8006,0)
      IF(IFSD(IRES(IW62)) .NE. IR) CALL EXEC(8,NAME,LU,2030,0)
      IVEN(24)=309
      CALL EXEC(8,NAME,LU,8015,0)
 9000 CALL EXEC(8,NAME,LU,320,0)
10000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IW71.NE.2.OR.IW52.NE.4)CALL EXEC(8,NAME,LU,320,0)
      CALL MMRL
      IC=IW62
      IF(IFSD(IRES(IC)).NE.IR)CALL EXEC(8,NAME,LU,2030,0)
      IF(IRES(IC).GT.10000)CALL EXEC(8,NAME,LU,20030,0)
      IF(IC.EQ.5.AND.IR.EQ.5.AND.IRES(5).EQ.5.AND.IVEN(29).GE.20000.
     1AND.(IVEN(11).GT.20000.OR.IVEN(14).GT.20000).AND.ITST(5).LT.50
     2.AND.IXT(183).EQ.405) CALL EXEC(8,NAME,LU,10011,0)
      IF(IC.EQ.5.OR.IC.EQ.10)CALL EXEC(8,NAME,LU,10020,0)
      IF(IC.EQ.15.OR.IC.EQ.10)CALL EXEC(8,NAME,LU,10030,0)
      IP=IRES(IC)/1000-ITST(31)
      DO 10010 I=1,89
      IF(I.NE.10.AND.I.NE.11.AND.I.NE.12.AND.I.NE.14.AND.I.NE.34.AND.
     1I.NE.45.AND.I.NE.48.AND.I.NE.49)GOTO 10010
      IF(IVEN(I).GT.20000)IP=IP+IFD(IVEN(I))
      IF(IFSD(IVEN(I)).EQ.IC.AND.IVEN(I).GT.10000.AND.IVEN(I).LT.
     120000) IP=IP-IFD(IVEN(J))
10010 CONTINUE
      R=RN(R)
      IP=IP+5*R-2
      IF(IP.EQ.6)IP=8
      IF(IP.EQ.7)IP=9
      IF(IP.EQ.-6)IP=-8
      IF(IP.EQ.-7)IP=-9
      IF(IP.GT.9)IP=10
      IF(IP.LT.-9)IP=-10
      IF(IP.LT.0)ITST(31)=-1*IP
      IF(IP.GT.0)IRES(IC)=IRES(IC)-1000*(IRES(IC)/1000)+1000*IP
      IF(IABS(IP).LT.2.AND.IC.NE.16)GOTO 10050
      IF(IP.LT.-9)CALL EXEC(8,NAME,LU,10030,0)
      IF(IP.GT.9.AND.IC.EQ.13.AND.IR.EQ.33)IRES(13)=534
      IF(IP.GT.9.AND.IC.EQ.13.AND.IR.NE.33)IRES(13)=533
      IF(IP.GT.9.AND.IC.EQ.13)CALL EXEC(8,NAME,LU,16045,0)
      IF(IP.GT.9)CALL EXEC(8,NAME,LU,10040,0)
      IF(IP.GT.0)CALL EXEC(8,NAME,LU,10041,0)
      CALL EXEC(8,NAME,LU,10031,0)
10050 DO 10070 J=1,360
      IF(IFSD(IXT(J)).NE.IR.OR.IXT(J).GT.20000)GOTO 10070
      IRES(IC)=IRES(IC)-IR+ITFD(IXT(J))
      CALL EXEC(8,NAME,LU,10060,0)
10070 CONTINUE
      R=RN(R)
      IF(R.LT..3)CALL EXEC(8,NAME,LU,10030,0)
      IRES(IC)=10000+IR
      CALL EXEC(8,NAME,LU,10040,0)
11000 IF(IW71 .GT. 1) CALL EXEC(8,NAME,LU,320,0)
      DO 11080 I=1,8
      DO 11080 J=1,4
11080 IVRBX(J,I)=IVRB(J,3+I)
      IDUMMY=FREEZE(IVRBX,IROM,IRES,IVEN,IXT,ITST,IWP)
      IF(IDUMMY.LT.-1) CALL EXEC(8,NAME,LU,1040,0)
      IF(IDUMMY.GE.0) CALL EXEC(8,NAME,LU,11040,IDUMMY)
      CALL EXEC(8,NAME,LU,11050,0)
12000 IF(IW71 .GT. 1) CALL EXEC(8,NAME,LU,320,0)
      IF(ITST(5).GT.1) CALL EXEC(8,NAME,LU,12050,0)
      IXX=ITST(19)
      IDUMMY=THAW(IVRBX,IROM,IRES,IVEN,IXT,ITST,IWP)
      IF(IDUMMY.EQ.52) CALL EXEC(8,NAME,LU,12070,0)
      IF(IDUMMY.GE.0) CALL EXEC(8,NAME,LU,12060,IDUMMY)
      DO 12080 I=1,8
      DO 12080 J=1,4
12080 IVRB(J,3+I)=IVRBX(J,I)
      CALL OURTIME(ITIM)
      ITST(19)=IXX
      ITST(18)=ITIM(4)*1200+ITIM(3)*20+ITIM(2)/3
      ITST(20)=ITST(20)+1
      CALL EXEC(8,NAME,LU,12040,0)
13000 IF(IW71.NE.1.AND.IW62.NE.13.AND.IW62.NE.60.AND.IW62.NE.62)
     1CALL EXEC(8,NAME,LU,320,0)
      IF(IW71.GT.2)CALL EXEC(8,NAME,LU,320,0)
      IF(IW71.EQ.1)IW62=62
      IF(IW62.EQ.60.AND.IR.NE.16)CALL EXEC(8,NAME,LU,2030,0)
      IF(IW62.EQ.60)IXT(128)=1316
      IF(IW62.EQ.60)CALL EXEC(8,NAME,LU,1095,IR)
      IF(IW62.EQ.13.AND.(IVEN(13).LT.20000.OR.ITST(10).EQ.13))
     1CALL EXEC(8,NAME,LU,2030,0)
      IF(IW62.EQ.13)NAME(2)=MOVEAS("SD")
      IF(IW62.EQ.13)CALL EXEC(8,NAME,LU,13010,0)
      IF(IW62.EQ.62.AND.(IR.LT.68.OR.IR.GT.83).AND.IR.NE.99)
     1CALL EXEC(8,NAME,LU,2030,0)
      IF(IW62.EQ.62)CALL EXEC(8,NAME,LU,1010,0)
      CALL EXEC(8,NAME,LU,320,0)
14000 IF(IW71.GT.1)GOTO 14100
      IF(ITST(5).GT.2)CALL EXEC(8,NAME,LU,14010,0)
14020 WRITE(LDEV,14030)
14030 FORMAT(/"MYSTERY #? _")
      READ(IDEV,*)IC
      IF(IC.LT.1.OR.IC.GT.999)GOTO 14020
      RND=.001*IC
      WRITE(LDEV,14035)IC
14035 FORMAT(/" THIS GAME IS NOW SET UP FOR MYSTERY #"I4)
      ITST(23)=IC
      NAME(2)=MOVEAS("SA")
      CALL EXEC(8,NAME,0,0,0)
14100 IF(IWRD(7,1).GT.2.OR.IWRD(6,2).NE.107)CALL EXEC(8,NAME,LU,320,0)
      CALL EXEC(8,NAME,LU,14110,0)
15000 IF(IW71.NE.2.OR.IW52.NE.4)CALL EXEC(8,NAME,LU,320,0)
      IF(IFSD(IRES(IW62)).NE.IR) CALL EXEC(8,NAME,LU,2030,0)
      IF(IVEN(7).LT.20000)CALL EXEC(8,NAME,LU,15200,0)
      IF(IRES(IW62).GT.10000)CALL EXEC(8,NAME,LU,15400,0)
      IC=0
      IG=IW62
      IM=ITST(9)
      IR=ITST(8)
      IF(IM.EQ.2.AND.IR.GT.53.AND.(IG.EQ.7.OR.IG.EQ.8.OR.IG.EQ.9))IC=1
      IF(IM.EQ.2.AND.IR.LT.28.AND.(IG.EQ.3.OR.IG.EQ.8.OR.IG.EQ.14))IC=1
      IF(IM.EQ.3.AND.IR.GT.18.AND.(IG.EQ.2.OR.IG.EQ.8.OR.IG.EQ.14))IC=1
      IF(IM.EQ.3.AND.IR.LT.10.AND.(IG.EQ.7.OR.IG.EQ.9.OR.IG.EQ.14))IC=1
      IF(IM.EQ.7.AND.IR.GT.53.AND.(IG.EQ.2.OR.IG.EQ.8.OR.IG.EQ.9))IC=1
      IF(IM.EQ.7.AND.IR.LT.10.AND.(IG.EQ.3.OR.IG.EQ.9.OR.IG.EQ.14))IC=1
      IF(IM.EQ.8.AND.IR.GT.53.AND.(IG.EQ.2.OR.IG.EQ.7.OR.IG.EQ.9))IC=1
      IF(IM.EQ.8.AND.IR.LT.28.AND.(IG.EQ.2.OR.IG.EQ.3.OR.IG.EQ.14))IC=1
      IF(IM.EQ.9.AND.IR.GT.53.AND.(IG.EQ.2.OR.IG.EQ.7.OR.IG.EQ.8))IC=1
      IF(IM.EQ.9.AND.IR.LT.10.AND.(IG.EQ.3.OR.IG.EQ.7.OR.IG.EQ.14))IC=1
      IF(IM.EQ.14.AND.IR.GT.9.AND.(IG.EQ.2.OR.IG.EQ.3.OR.IG.EQ.8))IC=1
      IF(IM.EQ.14.AND.IR.LT.10.AND.(IG.EQ.3.OR.IG.EQ.7.OR.IG.EQ.9))IC=1
      IF(IC.EQ.0)CALL EXEC(8,NAME,LU,15400,0)
      IVEN(7)=0
      IRES(IG)=0
      CALL EXEC(8,NAME,LU,15500,0)
16000 IF(IWRD(7,1).EQ.1) CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(7,1).NE.2.OR.IWRD(5,2).NE.4)CALL EXEC(8,NAME,LU,320,0)
      IF(IFSD(IRES(IWRD(6,2))).NE.IR)CALL EXEC(8,NAME,LU,2030,0)
      IF(IRES(IWRD(6,2)).GE.1000.OR.IWRD(6,2).EQ.4.OR.IWRD(6,2).EQ.15)
     1CALL EXEC(8,NAME,LU,20030,0)
      R=RN(R)
      IF(ITST(5)-2.GT.ITST(13).AND.R.LT..5)CALL EXEC(8,NAME,LU,23120,0)
      IF(ITST(5)-4.GT.ITST(13))CALL EXEC(8,NAME,LU,23145,0)
      IF(ITST(5)-2.GT.ITST(13))CALL EXEC(8,NAME,LU,23140,0)
      IF(IWRD(6,2).EQ.5)CALL EXEC (8,NAME,LU,23010,0)
      IF(IWRD(6,2).EQ.10)CALL EXEC (8,NAME,LU,23015,0)
      IF(IWRD(6,2).EQ.11.OR.IWRD(6,2).EQ.13)CALL EXEC(8,NAME,LU,23020,0)
      IF(IWRD(6,2).NE.6.AND.IWRD(6,2).NE.12)GOTO 23130
      IF(IXT(54).GT.20000.AND.IR.NE.93.AND.R.LT..3)CALL EXEC(8,NAME,
     1LU,23030,0)
      IF(IXT(54).GT.20000.AND.IR.EQ.93.AND.RND.LT..3)CALL EXEC(8,NAME,
     1LU,23040,0)
      IF(IXT(54).LT.20000.AND.R.LT..3)CALL EXEC(8,NAME,LU,23050,0)
      IF(R.LT..4)CALL EXEC(8,NAME,LU,23060,0)
      IF(R.LT..5)CALL EXEC(8,NAME,LU,23070,0)
      IF(R.LT..58)CALL EXEC(8,NAME,LU,23080,0)
      IF(R.LT..66)CALL EXEC(8,NAME,LU,23090,0)
      IF(R.LT..74)CALL EXEC(8,NAME,LU,23100,0)
      IF(R.LT..82)CALL EXEC(8,NAME,LU,23110,0)
      CALL EXEC(8,NAME,LU,23120,0)
23130 IF(IWRD(6,2).NE.ITST(9))GOTO 23160
      IF(R.LT..33)CALL EXEC(8,NAME,LU,23120,0)
      IF(R.LT..67)CALL EXEC(8,NAME,LU,23140,0)
      CALL EXEC(8,NAME,LU,23150,0)
23160 IF(IWRD(6,2).NE.3.AND.IWRD(6,2).NE.14)GOTO 23250
      IF(R.LT..3)GOTO 23200
      IF(ITST(8).LT.28.AND.R.LT..15)CALL EXEC(8,NAME,LU,23170,0)
      IF(ITST(8).LT.28)CALL EXEC(8,NAME,LU,23180,0)
      IF(IVEN(ITST(10)).LT.10000.AND.IFSD(IVEN(ITST(10))).LT.28)
     1CALL EXEC(8,NAME,LU,23190,0)
      CALL EXEC(8,NAME,LU,23150,0)
23200 IF(R.LT..4)CALL EXEC(8,NAME,LU,23210,0)
      IF(R.LT..5)CALL EXEC(8,NAME,LU,23220,0)
      IF(R.LT..6)CALL EXEC(8,NAME,LU,23230,0)
      IF(R.LT..7)CALL EXEC(8,NAME,LU,23240,0)
      IF(R.LT..8)CALL EXEC(8,NAME,LU,23140,0)
      CALL EXEC(8,NAME,LU,23120,0)
23250 IF(IWRD(6,2).NE.8.AND.IWRD(6,2).NE.2)GOTO 23310
      IF(R.LT..3)GOTO 23260
      IF(ITST(8).GT.9.AND.R.LT..15)CALL EXEC(8,NAME,LU,23170,0)
      IF(ITST(8).GT.9)CALL EXEC(8,NAME,LU,23180,0)
      IF(IVEN(ITST(10)).LT.10000.AND.IFSD(IVEN(ITST(10))).GT.9)
     1CALL EXEC(8,NAME,LU,23190,0)
      CALL EXEC(8,NAME,LU,23150,0)
23260 IF(R.LT..4)CALL EXEC(8,NAME,LU,23270,0)
      IF(R.LT..5)CALL EXEC(8,NAME,LU,23280,0)
      IF(R.LT..6)CALL EXEC(8,NAME,LU,23290,0)
      IF(R.LT..7)CALL EXEC(8,NAME,LU,23300,0)
      IF(R.LT..8)CALL EXEC(8,NAME,LU,23140,0)
      CALL EXEC(8,NAME,LU,23150,0)
23310 IF(R.LT..3)GOTO 23320
      IF(ITST(8).LT.10.OR.ITST(8).GT.27.AND.R.LT..15)
     1CALL EXEC(8,NAME,LU,23170,0)
      IF(ITST(8).LT.10.OR.ITST(8).GT.27)CALL EXEC(8,NAME,LU,23180,0)
      IF(IVEN(ITST(10)).LT.10000.AND.IFSD(IVEN(ITST(10))).GT.9)
     1CALL EXEC(8,NAME,LU,23190,0)
      CALL EXEC(8,NAME,LU,23150,0)
23320 IF(R.LT..4)CALL EXEC(8,NAME,LU,23330,0)
      IF(R.LT..5)CALL EXEC(8,NAME,LU,23340,0)
      IF(R.LT..6)CALL EXEC(8,NAME,LU,23350,0)
      IF(R.LT..7)CALL EXEC(8,NAME,LU,23360,0)
      IF(R.LT..8)CALL EXEC(8,NAME,LU,23140,0)
      CALL EXEC(8,NAME,LU,23150,0)
17000 IF(IWRD(7,1).NE.1)CALL EXEC(8,NAME,LU,320,0)
      IX=0
      IC=0
      ID=24000+IR
      IF(IR.GT.53)ID=24100
      IF(IVEN(3).GT.20000.OR.IVEN(3).EQ.200+IR.OR.(IVEN(3).GT.10000.
     1AND.IFSD(IVEN(3)).EQ.IR))IX=24108
      DO 24010 I=2,15
      IF(IRES(I).GT.10000.OR.IFSD(IRES(I)).NE.IR)GOTO 24010
      IX=24110
      IF(I.NE.4.AND.I.NE.10.AND.I.NE.15)IC=IC+1
      IF(IC.EQ.1)IX=24120
      IF(IC.LT.2)GOTO 24010
      IF(IC.EQ.2)IX=24130
      IF(IC.EQ.3)IX=24140
24010 CONTINUE
      IF(IRES(6)+IRES(12).LT.10000.AND.IFSD(IRES(6)).EQ.IR.AND.
     1IFSD(IRES(12)).EQ.IR)IX=24150
      IF(IRES(3)+IRES(14).LT.10000.AND.IFSD(IRES(3)).EQ.IR.AND.
     1IFSD(IRES(14)).EQ.IR.AND.ITST(9).NE.3.AND.ITST(9).NE.14.
     2AND.ITST(8).LT.28)IX=24160
      RNX=77.7*IR/253.-INT(77.7*IR/253.)
      IF(IX.EQ.24160.AND.RNX.GT..8)IX=24164
      IF(IX.EQ.24160.AND.RNX.GT..6)IX=24162
      IF(IRES(7)+IRES(9).LT.10000.AND.IFSD(IRES(7)).EQ.IR.AND.
     1IFSD(IRES(9)).EQ.IR.AND.ITST(9).NE.7.AND.ITST(9).NE.9.AND.
     2(ITST(8).LT.10.OR.ITST(8).GT.27))IX=24170
      IF(IX.EQ.24170.AND.RNX.GT..8)IX=24174
      IF(IX.EQ.24170.AND.RNX.GT..6)IX=24172
      IF(IRES(2)+IRES(8).LT.10000.AND.IFSD(IRES(2)).EQ.IR.AND.
     1IFSD(IRES(8)).EQ.IR.AND.ITST(9).NE.2.AND.ITST(9).NE.8.AND.
     2ITST(8).GT.27)IX=24180
      IF(IX.EQ.24180.AND.RNX.GT..8)IX=24184
      IF(IX.EQ.24180.AND.RNX.GT..6)IX=24182
      IF(ID.EQ.24100.AND.IX.NE.0)ID=24105
      CALL EXEC(8,NAME,LU,ID,IX)
      STOP
      END
$CONTROL SEGMENT=MMSI
      SUBROUTINE MMSI
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      INTEGER MOVEAS
      IFSD(I)=I-(I/100)*100
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      CALL RMPAR(IPR)
      LU=IPR(1)
      IRIT=IPR(2)
      IW63=IWRD(6,3)
      IFC=ITST(4)/1000
      IDN=1
      IDE=2
      IDS=3
      IDW=4
      IF(IVEN(6).LT.20000)IDN=10-IFC
      IF(IDN.EQ.6)IDN=10
      IF(IVEN(6).LT.20000)IDE=11-IFC
      IF(IVEN(6).LT.20000)IDS=12-IFC
      IF(IDS.EQ.11)IDS=7
      IF(IVEN(6).LT.20000)IDW=13-IFC
      IF(IDW.GT.10)IDW=IDW-4
  999 IF (IRIT .EQ. 320) WRITE(LDEV,320)
  320 FORMAT(/" I CANNOT FIGURE OUT WHAT YOU ARE TRYING TO SAY")
      IF (IRIT .EQ. 520) WRITE(LDEV,520)
  520 FORMAT(/" NOTHING HAPPENS")
      IF(IRIT.EQ.1000)WRITE(LDEV,1000)(IWRD(L,1),L=1,4)
 1000 FORMAT(/" PLEASE TRY AGAIN. I NEED TO KNOW WHO OR WHAT TO "4A2)
      IF(IRIT.EQ.1010)WRITE(LDEV,1010)
 1010 FORMAT(/" THANKS. THAT TASTED GOOD.")
      IF(IRIT.EQ.1020)WRITE(LDEV,1020)
 1020 FORMAT(/" UGH! THAT TASTED AWFUL.")
      IF (IRIT .EQ. 1040) WRITE(LDEV,1040)
 1040 FORMAT(/" OKAY")
      IF(IRIT .EQ. 1065) WRITE(LDEV,1065) IPR(3)
 1065 FORMAT(/" PROGRAM ERROR AT LINE"I6)
      IF(IPR(3).EQ.7.OR.IPR(3).EQ.16.OR.IPR(3).EQ.25)IC=IDS
      IF(IPR(3).EQ.5.OR.IPR(3).EQ.14.OR.IPR(3).EQ.23)IC=IDW
      IF(IPR(3).EQ.1.OR.IPR(3).EQ.10.OR.IPR(3).EQ.19)IC=IDN
      IF(IRIT .EQ. 1095) WRITE(LDEV,1095)(IDTN(I,IC),I=1,4)
 1095 FORMAT(/" YOUR ACTION OPENED A PANEL INTO THE SECRET PASSAGE ",
     1"THAT YOU CAN"/" ENTER BY GOING "4A2)
      IF (IRIT .EQ. 1150) WRITE(LDEV,1150)
 1150 FORMAT(/" IT IS DARK HERE")
      IF ((IRIT .EQ. 1150) .AND. (IPR(3) .EQ. 1)) WRITE(LDEV,1151)
 1151 FORMAT(/" IT IS AFTER SUNSET")
      IF ((IRIT .EQ. 1150) .AND. (IPR(3) .EQ. 2)) WRITE(LDEV,1152)
 1152 FORMAT(/" A CURTAIN BLOCKS THE LIGHT")
      IF (IRIT .EQ. 2010) WRITE (LDEV,2010)(IWRD(L,1),L=1,2),
     1(IWRD(L,2),L=1,4)
 2010 FORMAT(/" YOU CANNOT "2A2" THE "4A2)
      IF(IRIT.EQ.2030)WRITE(LDEV,2030)(IWRD(L,2),L=1,4)
 2030 FORMAT(/" I DON'T SEE THE "4A2)
      IF(IRIT.EQ.2037)WRITE(LDEV,2037)
 2037 FORMAT(/" YOU MUST REALIZE BY NOW THAT THE DELICATE PAPYRUS ",
     1"WILL CRUMBLE WHEN"/" YOU SO MUCH AS EVEN BLOW ON IT.")
      IF(IRIT.EQ.2080)WRITE(LDEV,2080)
 2080 FORMAT(/" YOU JUST GOT SLAPPED BY THE MAID")
      IF(IRIT.EQ.2090)WRITE(LDEV,2090)
 2090 FORMAT(/" YOU ARE NOT ALLADIN. BESIDES, YOU KNOW HOW MUCH ",
     1"TROUBLE HE GOT INTO")
      IF (IRIT .EQ. 3010) WRITE(LDEV,3010)(IWRD(L,2),L=1,4)
 3010 FORMAT(/" YOU DO NOT HAVE THE "4A2)
      IF(IRIT.EQ.9040)ITST(34)=INT(500.1*RND)
      IF(IRIT.EQ.3050)WRITE(LDEV,3050)
 3050 FORMAT(/" YOU NEED A MATTER TRANSMITTER TO BEAM UP")
      IF(IRIT.EQ.3060)WRITE(LDEV,3060)
 3060 FORMAT(/" YOU DEMATERIALIZE IN SECONDS AND REMATERIALIZE ",
     1"IN THE LABORATORY")
      IF(IRIT.EQ.3070)WRITE(LDEV,3070)
 3070 FORMAT(/" YOU HAVE TO BE IN THE LABORATORY TO BEAM DOWN")
      IF(IRIT.EQ.3080)WRITE(LDEV,3080)
 3080 FORMAT(/" THE MATTER RECEIVER HAS TO BE SOMEWHERE ELSE TO BEAM ",
     1"DOWN")
      IF(IRIT.EQ.3090)WRITE(LDEV,3090)(IRNM(L,IFSD(IROM(IPR(3))))
     1,L=1,8)
 3090 FORMAT(/" YOU DEMATERIALIZE IN SECONDS AND REMATERIALIZE IN THE "
     18A2)
      IF (IRIT .EQ. 3110) WRITE(LDEV,3110)(IWRD(L,2),L=1,4)
 3110 FORMAT(/" YOU NO LONGER HAVE THE "4A2)
      IF(IRIT.EQ.4010)WRITE(LDEV,4010)(IWRD(L,4),L=1,4)
 4010 FORMAT(/" FIRST YOU HAVE TO FIND THE "4A2)
      IF(IRIT.EQ.4050)WRITE(LDEV,4050)
 4050 FORMAT(/" THANKS. IT NEEDS THAT AROUND HERE.")
      IF(IRIT.EQ.4055)WRITE(LDEV,4055)
 4055 FORMAT(/" YOU DON'T HAVE A BROOM OR ANYTHING TO SWEEP WITH")
      IF (IRIT .EQ. 5020) WRITE(LDEV,5020)(IWRD(L,3),L=1,4)
 5020 FORMAT(/" I DO NOT SEE THE "4A2)
      IF(IRIT.EQ.5001) WRITE(LDEV,5001)
 5001 FORMAT(/" THE POLICE CAME AND ARRESTED THE MURDERER")
      IF(ITST(24).NE.0.AND.IRIT.EQ.5001)ITST(1)=8
      IF(ITST(24).NE.0.AND.IRIT.EQ.5001.AND.IVEN(2).GT.20000)IVEN(2)=0
      IF(ITST(24).NE.0.AND.IRIT.EQ.5001.AND.IVEN(9).GT.20000)IVEN(9)=0
      IF(ITST(24).NE.0.AND.IRIT.EQ.5001)WRITE(LDEV,5003)
 5003 FORMAT(/" SINCE YOU KILLED AN INNOCENT BYSTANDER, THE POLICE ",
     1"LOCKED YOU IN"/" THE DUNGEON.")
      IF(IRIT.EQ.5002)WRITE(LDEV,5002)
 5002 FORMAT(/" THE DISPATCHER SAID THAT A TAXI WOULD BE THERE IN ",
     1"ABOUT 2 HOURS.")
      IF(IRIT.EQ.5009)WRITE(LDEV,5009)
 5009 FORMAT(/" ALL YOU CAN GET IS A BUSY SIGNAL")
      IF(IRIT.EQ.6005)WRITE(LDEV,6005)
 6005 FORMAT(/" A DOZEN OR SO OF THE INDIANS AIMING IN YOUR ",
     1"DIRECTION, SHOT THEIR"/" ARROWS AND YOU WERE HIT BY ",
     2"SEVERAL OF THEM AND DIED A PAINFUL DEATH.")
      IF(IRIT.EQ.6005)NAME(2)=MOVEAS("SD")
      IF(IRIT.EQ.6005)CALL EXEC(8,NAME,LU,6005,0)
      IF(IRIT.EQ.6010)WRITE(LDEV,6010)
 6010 FORMAT(/" YOU JUST UNCOVERED SOME GOLD COINS.")
      IF(IRIT.EQ.6015)WRITE(LDEV,6015)
 6015 FORMAT(/" AFTER MOVING THE TABLE, A TRAP DOOR OPENED REVEALING ",
     1"A GAUDY GAUNTLET.")
      IF(IRIT.EQ.6015)IVEN(48)=9115
      IF(IRIT.EQ.6030)WRITE(LDEV,6030)
 6030 FORMAT(/" UNDER THE RAGS IS A STRANGE DRAWING OF A COMPASS WITH ",
     1"THE NEEDLE BENT"/" IN A U-SHAPE AND A CLOCK WITH TWO MINUTE ",
     2"HANDS, ONE ON THE 10 AND THE OTHER"/" ON THE 12")
      IF(IRIT.EQ.6040)WRITE(LDEV,6040)
 6040 FORMAT(/" UNDER THE RAGS IS A STRANGE DRAWING OF A COMPASS WITH ",
     1"THE NEEDLE"/" POINTING NORTH AND A CLOCK WITH ONLY A MINUTE ",
     2"HAND WHICH IS ON THE 12")
      IF(IRIT.EQ.6041)WRITE(LDEV,6041)
 6041 FORMAT(/" YOU CANNOT QUITE MOVE ANY OF THE BOULDERS.")
      IF(IRIT.EQ.6042)WRITE(LDEV,6042)
 6042 FORMAT(/" IN YOUR GREED TO FIND MORE LOOT, YOU MANAGED TO ",
     1"MOVE ONE OF THE BOULDERS"/" IN THE WRONG DIRECTION AND IT ",
     2"ROLLED INTO AND BLOCKED THE ONLY EXIT.")
      IF(IRIT.EQ.6042)IXT(319)=0
      IF(IRIT.EQ.6043)WRITE(LDEV,6043)
 6043 FORMAT(/" WITH A HEAVY PUSH, YOU MOVED ONE OF THE BOULDERS ",
     1"A FEW FEET AND"/" UNCOVERED A BAG OF PEARLS IN ONE OF THE ",
     2"CRATERS THAT WAS UNDER IT.")
      IF(IRIT.EQ.6044)WRITE(LDEV,6044)
 6044 FORMAT(/" THANKS TO THE GAUNTLET, YOU WERE ABLE TO MOVE A ",
     1"BOULDER A FEW FEET"/" BUT THERE WAS NOTHING UNDER IT.")
      IF(IRIT .EQ. 7010) WRITE(LDEV,7010)
 7010 FORMAT(/" A VOICE ON THE LINE SAYS:")
      IF(IRIT .EQ. 7010) IVEN(42)=1000
      IF(IRIT .EQ. 7010.AND.IPR(3).EQ.1) WRITE(LDEV,7015)
 7015 FORMAT(" WHY DON'T YOU DROP THE NOTE? YOU DON'T NEED IT ANYMORE.")
      IF(IRIT.EQ.7010.AND.IPR(3).EQ.2)WRITE(LDEV,7020)
 7020 FORMAT(" WHY DON'T YOU LOOK AT SOME OF THE ITEMS YOU HAVE")
      IF(IRIT.EQ.7010.AND.IPR(3).EQ.3)WRITE(LDEV,7025)
 7025 FORMAT(" IF I WERE YOU, I WOULD WATCH THE MURDERER AND CALL ",
     1"THE POLICE.")
      IF(IRIT.EQ.7010.AND.IPR(3).EQ.4)WRITE(LDEV,7030)
 7030 FORMAT(" IT WOULD PROBABLY BE WISE TO GO BACK TO THE MAIN ",
     1"GATE AND"/" GET THE LANTERN BEFORE YOU GO MUCH FARTHER.")
      IF(IRIT .EQ. 7010) WRITE(LDEV,7080)
 7080 FORMAT(" AND HANGS UP")
      IF(IRIT .EQ. 7090) WRITE(LDEV,7090)
 7090 FORMAT(/" THERE IS NO ONE ON THE LINE")
      IF (IRIT .EQ. 7050) WRITE(LDEV,7050)
 7050 FORMAT(" NOTHING")
      IF(IRIT .EQ. 8005) WRITE(LDEV,8005)(IWRD(L,2),L=1,4)
 8005 FORMAT(/" YOU DO NOT HAVE THE "4A2)
      IF(IRIT.EQ.8006)WRITE(LDEV,8006)
 8006 FORMAT(/" YOU DO NOT HAVE ANY FOOD.")
      IF (IRIT .EQ. 8010 ) WRITE(LDEV,8010)
 8010 FORMAT(/" I DON'T KNOW WHAT YOU EXPECT TO HAPPEN")
      IF(IRIT .EQ. 8015) WRITE(LDEV,8015)(IWRD(L,2),L=1,4)
 8015 FORMAT(/" YOUR FOOD HAS BEEN EATEN BY THE "4A2)
      IF (IRIT .EQ. 8020) WRITE(LDEV,8020)
 8020 FORMAT(/" IT ALREADY IS")
      IF (IRIT .EQ. 8030) WRITE(LDEV,8030)(IWRD(L,3),L=1,4)
      IF (IRIT .EQ. 8031) WRITE(LDEV,8030)(IWRD(L,2),L=1,4)
 8030 FORMAT(/" I DON'T SEE THE "4A2)
      IF(IRIT.EQ.8032)WRITE(LDEV,8032)
 8032 FORMAT(/" I DON'T SEE HOW YOU CAN DO THAT.")
      IF(IRIT .EQ. 8035) WRITE(LDEV,8035)
 8035 FORMAT(/" THE BATTERY IN YOUR LANTERN IS DEAD")
      IF(IRIT.EQ.9027)WRITE(LDEV,9027)
 9027 FORMAT(/" YOU DON'T HAVE ENOUGH POINTS")
      IF(IRIT.EQ.9035)ITST(25)=10
      IF(IRIT.EQ.9035)WRITE(LDEV,9035)
 9035 FORMAT(/" GIVE UP."/" YOU WILL NEVER FIGURE IT OUT.")
      IF(IRIT.EQ.10020)WRITE(LDEV,10020)
10020 FORMAT(/" YOU HAVE NOT FIGURED OUT HOW NOT DO THAT YET.")
      IF(IRIT.EQ.10030)WRITE(LDEV,10030)
10030 FORMAT(/" YOU WERE KILLED IN THE STRUGGLE")
      IF(IRIT.EQ.10030)NAME(2)=MOVEAS("SD")
      IF(IRIT.EQ.10030)CALL EXEC(8,NAME,LU,10030,0)
      IF(IRIT.EQ.10031)WRITE(LDEV,10031)
10031 FORMAT(/" YOU WERE WOUNDED IN THE FIGHT.")
      IF(IRIT.EQ.10035)WRITE(LDEV,10035)
10035 FORMAT(/" THE DOOR IS LOCKED")
      IF(IRIT.EQ.10040)WRITE(LDEV,10040)(IWRD(L,2),L=1,4)
10040 FORMAT(/" YOU KILLED THE "4A2)
      IF(IRIT.EQ.10041)WRITE(LDEV,10041)(IWRD(L,2),L=1,4)
10041 FORMAT(/" YOU WOUNDED THE "4A2)
      IF(IRIT.EQ.10045)WRITE(LDEV,10045)
10045 FORMAT(/" THE DOOR IS OPEN")
      IF(IRIT.EQ.10046)WRITE(LDEV,10046)
10046 FORMAT(/" THE DOOR IS CLOSED")
      IF(IRIT.EQ.10060)WRITE(LDEV,10060)
10060 FORMAT(/" YOUR OPPONENT FLED DURING THE STRUGGLE")
      IF(IRIT.EQ.10011)WRITE(LDEV,10011)
10011 FORMAT(/" YOU JUST DROVE A STAKE INTO THE VAMPIRE'S HEART AND ",
     1"HE HAS AGED"/" A THOUSAND YEARS AND DISAPPEARED.")
      IF(IRIT.EQ.10011)IRES(5)=0
      IF(IRIT.EQ.10011)IVEN(1)=105
      IF(IRIT.EQ.10011)IVEN(29)=0
      IF(IRIT.EQ.10011.AND.LU.NE.ITST(21))ITST(2)=ITST(2)+75
      IF(IRIT .EQ. 11040)WRITE(LDEV,11040) IPR(3)
11040 FORMAT(/" I WAS UNALBE TO SAVE YOUR SITUATION DUE TO MPE ERROR",
     1" #"I3)
C
      IF(IRIT.EQ.11050) WRITE(LDEV,11050)
11050 FORMAT(" YOUR CURRENT SITUATION HAS BEEN SAVED. YOU MAY"/
     1" RESUME THIS MYSTERY AT A LATER TIME BY ENTERING RESTORE"/
     2" DURING YOUR FIRST MOVE OF A FUTURE GAME.")
      IF((IRIT .EQ. 12040) .AND. (ITST(15) .EQ. 17)) WRITE(LDEV,12040)
12040 FORMAT(/" YOU ARE NOW IN THE SAME SITUATION YOU WERE IN WHEN ",
     1"YOU SUSPENDED THIS DATA")
      IF((ITST(15) .NE. 17) .AND. (IRIT .EQ. 12040)) WRITE(LDEV,12050)
12050 FORMAT(/" THE DATA YOU LOADED IS FOR A DIFFERENT REVISION")
      IF(IRIT.EQ.12060) WRITE(LDEV,12060)IPR(3)
12060 FORMAT(" ERROR"I3" WHILE RESTORING FROZEN GAME")
      IF(IRIT.EQ.14010)WRITE(LDEV,14010) ITST(23)
      IF(IRIT.EQ.12070) WRITE(LDEV,12070)
12070 FORMAT(" I WAS UNABLE TO FIND YOUR OLD GAME FILE!")
14010 FORMAT(/" YOU CAN SET THE MYSTERY ON THE FIRST MOVE. YOU ARE ",
     1"IN MYSTERY #"I4)
      IF(IRIT.EQ.14110)WRITE(LDEV,14110)
14110 FORMAT(/" THAT IS THE NAME OF THE GAME.")
      IF(IRIT.EQ.15110)WRITE(LDEV,15110)
15110 FORMAT(/" YOUR KEY WILL NOT FIT THE PADLOCK")
      IF(IRIT.EQ.15200)WRITE(LDEV,15200)(IRSN(L,IWRD(6,2)),L=1,4)
15200 FORMAT(/" YOU DO NOT HAVE ANYTHING OF INTEREST TO THE "4A2)
      IF(IRIT.EQ.15400)WRITE(LDEV,15400)(IRSN(L,IWRD(6,2)),L=1,4)
15400 FORMAT(/" YOU CAN FIND OUT NOTHING FROM THE "4A2)
      IF(IRIT.EQ.15500.AND. ITST(8).NE.0)WRITE(LDEV,15500)(IRSN(L,IWRD
     1(6,2)),L=1,4),(IRNM(L,IFSD(IROM(ITST(8)))),L=1,8),(IRSN(L,ITST
     2(9)),L=1,4),(IWP(L),L=1,4)
15500 FORMAT(/" AFTER A SLIGHT PAUSE BUT TAKING YOUR TREASURE, THE "4A2/
     1" TELLS YOU THAT THE SCENE OF THE MURDER IS THE "8A2/" AND THAT ",
     2"THE MURDER WAS COMMITTED BY THE "4A2/" WITH THE "4A2)
      IF(IRIT.EQ.15500.AND.ITST(8).EQ.0)WRITE(LDEV,15510)(IRSN(L,IWRD(6,
     12)),L=1,4)
15510 FORMAT(/" AFTER A SLIGHT PAUSE BUT TAKING YOUR TREASURE, THE "4A2/
     1" TELLS YOU THAT YOU MIGHT HAVE TO EXIT THROUGH THE ATTIC.")
      IF(IRIT.EQ.16035)WRITE(LDEV,16035)
16035 FORMAT(/" YOU JUST SMASHED THE PADLOCK TO PIECES")
      IF(IRIT.EQ.16035)IVEN(35)=IVEN(35)+1000
      IF(IRIT.EQ.16045)WRITE(LDEV,16045)
16045 FORMAT(/" YOU KILLED THE DWARF AND HE DISAPPEARED IN A CLOUD OF ",
     1"GREASY BLACK SMOKE")
      IF(IRIT.EQ.16045)IRES(13)=IRES(13)+100
      IF(IRIT .EQ. 20010) WRITE(LDEV,20010)
20010 FORMAT(/" YOU NEED AN OILCAN OR SOMETHING")
      IF(IRIT .EQ. 20020) WRITE(LDEV,20020)
20020 FORMAT(/" YOUR OILCAN IS EMPTY")
      IF(IRIT .EQ. 20030) WRITE(LDEV,20030)
20030 FORMAT(/" DON'T BE SILLY")
      IF(IRIT.EQ.22010)WRITE(LDEV,22010)
22010 FORMAT(/" THE CHEST IS NOT WHERE YOU CAN BREAK THE PADLOCK")
      IF(IRIT.EQ.22020)WRITE(LDEV,22020)
22020 FORMAT(/" YOU DO NOT HAVE ANYTHING THAT WILL BREAK THE PADLOCK")
      IF(IRIT.EQ.23010)WRITE(LDEV,23010)
23010 FORMAT(/" THE VAMPIRE SAYS THAT HE IS COUNT DRACULA AS HE WALKS"
     1" SLOWLY TOWARDS YOU,"/" HOLDING YOU MOTIONLESS IN HIS WIDE EYED ",
     2"GAZE.")
      IF(IRIT.EQ.23015)WRITE(LDEV,23015)
23015 FORMAT(/" THE BIG UGLY THING JUST GRUNTS AS HE WALKS TOWARDS ",
     1"YOU.")
      IF(IRIT.EQ.23020)WRITE(LDEV,23020)
23020 FORMAT(/" THE EVIL LITTLE THING JUST LOOKS UP AT YOU AND LAUGHS.")
      IF(IRIT.EQ.23030)WRITE(LDEV,23030)
23030 FORMAT(/" HE SAYS THAT HE WILL FOLLOW YOU TO THE MAIN GATE AND "
     1/" HELP YOU OPEN IT, IF THAT IS WHAT YOU WANT.")
      IF(IRIT.EQ.23040)WRITE(LDEV,23040)
23040 FORMAT(/" HE SAYS THAT THE GATE IS HEAVY AND HE WILL HELP YOU ",
     1"OPEN IT,"/" IF YOU TELL YOUR INVISIBLE GUIDE: OPEN THE GATE.")
      IF(IRIT.EQ.23050)WRITE(LDEV,23050)
23050 FORMAT(/" HE SAYS THAT HE ALWAYS CLOSES THE FRONT GATE WHEN HE IS"
     1/" THERE WITH A FRIEND.")
      IF(IRIT.EQ.23060)WRITE(LDEV,23060)
23060 FORMAT(/" HE SAYS THAT YOU CAN READ THE MAP THAT IS IN THE ",
     1"COTTAGE.")
      IF(IRIT.EQ.23070)WRITE(LDEV,23070)
23070 FORMAT(/" HE SAYS TO WATCH OUT FOR THE 500 FOOT SHEER CLIFF ",
     1"AROUND THE "/" EASTERN SIDE OF THE MANSION.")
      IF(IRIT.EQ.23080)WRITE(LDEV,23080)
23080 FORMAT(/" HE SAYS THAT HE IS AFRAID TO GO INTO THE COTTAGE.")
      IF(IRIT.EQ.23090)WRITE(LDEV,23090)
23090 FORMAT(/" HE SAYS THAT HE KNOWS BETTER THAN TO GO INTO THE ",
     A"DENSE WOODS.")
      IF(IRIT.EQ.23100)WRITE(LDEV,23100)
23100 FORMAT(/" HE SAYS THAT HE IS NOT ALLOWED TO GO INTO THE GARDEN.")
      IF(IRIT.EQ.23110)WRITE(LDEV,23110)
23110 FORMAT(/" THE RESPONSE IS THAT THE FRONT PORCH IS DANGEROUS.")
      IF(IRIT.EQ.23120)WRITE(LDEV,23120)(IWRD(L,2),L=1,4)
23120 FORMAT(/" YOUR QUESTIONS ARE STARTING TO IRRITATE THE "4A2)
      IF(IRIT.EQ.23140)WRITE(LDEV,23140)
23140 FORMAT(/" YOUR LAST QUESTION FELL ON DEAF EARS.")
      IF(IRIT.EQ.23145)WRITE(LDEV,23145)(IRSN(L,IWRD(6,2)),L=1,4)
23145 FORMAT(/" YOUR QUESTIONS ARE REALLY BOTHERING THE "4A2)
      IF(IRIT.EQ.23150)WRITE(LDEV,23150)(IWRD(L,2),L=1,4)
23150 FORMAT(/" I KNOW NOTHING ABOUT THE MURDER. ANSWERS THE "4A2)
      IF(IRIT.GE.23170.AND.IRIT.LE.23190)WRITE(LDEV,23170)
23170 FORMAT(/" YOUR QUESTION IS ANSWERED WITH A HESITANT:")
      IF(IRIT.EQ.23170)WRITE(LDEV,23175)(IRSN(L,ITST(9)),L=1,4)
23175 FORMAT(" I THINK THE MURDERER IS THE "4A2)
      IF(IRIT.EQ.23180)WRITE(LDEV,23180)(IRNM(L,IFSD(IROM(ITST(8)))),
     1L=1,8)
23180 FORMAT(" I THINK THE MURDER WAS COMMITTED IN THE "8A2)
      IF(IRIT.EQ.23190)WRITE(LDEV,23190)(IWP(L),L=1,4)
23190 FORMAT(" I THINK THE MURDER WEAPON IS THE "4A2)
      IF(IRIT.EQ.23210) WRITE(LDEV,23210)
23210 FORMAT(/" HE SAYS THAT HE DOESN'T WANT TO GO OUT OF THE MANSION.")
      IF(IRIT.EQ.23220)WRITE(LDEV,23220)
23220 FORMAT(/" HE SAYS THAT THERE IS A ENTRANCE TO A SECRET ",
     1"LABORTORY OFF THE LARGE BEDROOM.")
      IF(IRIT.EQ.23230)WRITE(LDEV,23230)
23230 FORMAT(/" HE SAYS THAT A SECRET PASSAGE CONNECTS ALL THREE ",
     1"LEVELS OF THE MANSION.")
      IF(IRIT.EQ.23240)WRITE(LDEV,23240)
23240 FORMAT(/" HE SAYS THAT THE MAID CAN BE VERY FRIENDLY.")
      IF(IRIT.EQ.23270)WRITE(LDEV,23270)
23270 FORMAT(/" SHE SAYS SHE IS AFRAID TO GO BELOW THE MAIN FLOOR ",
     1"OF THE MANSION.")
      IF(IRIT.EQ.23280)WRITE(LDEV,23280)
23280 FORMAT(/" SHW SAYS THAT SHE WILL NOT LEAVE THE MANSION AND ",
     1"GARDEN.")
      IF(IRIT.EQ. 23290)WRITE(LDEV,23290)
23290 FORMAT(/" SHE SAYS THAT SHE CAN READ THE WRITING ON THE CHEST.")
      IF(IRIT.EQ.23300)WRITE(LDEV,23300)
23300 FORMAT(/" SHE SAYS THAT THE ELF HIDES THINGS IN THE WELL.")
      IF(IRIT.EQ.23330)WRITE(LDEV,23330)
23330 FORMAT(/" HE SAYS THAT THERE IS TREASURE AT THE END OF THE ",
     1"CORRIDOR.")
      IF(IRIT.EQ.23340)WRITE(LDEV,23340)
23340 FORMAT(/" HE SAYS THAT YOU CAN DISTRACT THE WOLF WITH FOOD.")
      IF(IRIT.EQ.23350)WRITE(LDEV,23350)
23350 FORMAT(/" HE SAYS THAT YOU CAN TELL THE WELLS APART BY DROPPING ",
     1"ITEMS NEAR THEM.")
      IF(IRIT.EQ.23360)WRITE(LDEV,23360)
23360 FORMAT(/" HE SAYS THAT YOU CAN READ THE SCROLL BY USING MAGIC ",
     1"WORDS.")
      IF(IRIT.EQ.24001)WRITE(LDEV,24001)
24001 FORMAT(/" YOU CAN HEAR THE CHATTER OF THE MONKEY.")
      IF(IRIT.EQ.24002)WRITE(LDEV,24002)
24002 FORMAT(/" YOU CAN HEAR THE ROAR OF THE FIRE IN THE FURNACE.")
      IF(IRIT.EQ.24003)WRITE(LDEV,24003)
24003 FORMAT(/" YOU CAN HEAR STRANGE SOUNDS COMING UP FROM BELOW YOU.")
      IF(IRIT.EQ.24004.OR.IRIT.EQ.24013.OR.IRIT.EQ.24022)WRITE(LDEV,
     A24004)
24004 FORMAT(/" YOU CAN HEAR THE CREAKING OF WOOD AS YOU MOVE ABOUT.")
      IF(IRIT.EQ.24005)WRITE(LDEV,24005)
24005 FORMAT(/" IT IS DEATHLY QUIET HERE.")
      IF(IRIT.EQ.24006)WRITE(LDEV,24006)
24006 FORMAT(/" YOU CAN HERE SOMEONE WALKING IN THE ROOM ABOVE YOU.")
      IF(IRIT.EQ.24007)WRITE(LDEV,24007)
24007 FORMAT(/" YOU CAN ONLY HEAR THE NOISE YOU MAKE BUMPING INTO ",
     1"THINGS.")
      IF(IRIT.EQ.24008)WRITE(LDEV,24008)
24008 FORMAT(/" YOU CAN HEAR THE SQUEAKING OF SEVERAL RATS AS THEY ",
     1"SCURRY ABOUT.")
      IF(IRIT.EQ.24009)WRITE(LDEV,24009)
24009 FORMAT(/" YOU CAN HEAR SOME KIND OF ANIMAL SCRATCHING TO GET IN.")
      IF(IRIT.EQ.24010)WRITE(LDEV,24010)
24010 FORMAT(/" YOU CAN SORT OF HEAR BUT REALLY SENSE THE SOFT COMFORT",
     1"ABLE SURROUNDINGS.")
      IF(IRIT.EQ.24011)WRITE(LDEV,24011)
24011 FORMAT(/" YOU CAN HEAR A SLIGHT ECHO HIGH ABOVE YOU.")
      IF(IRIT.EQ.24012.AND.IFD(IVEN(75)).EQ.1)WRITE(LDEV,24012)
24012 FORMAT(/" YOU CAN HEAR THE RADIO PLAYING.")
      IF(IRIT.EQ.24012.AND.IFD(IVEN(75)).NE.1)WRITE(LDEV,24212)
24212 FORMAT(/" YOU CAN HEAR WHAT SOUNDS LIKE THUNDER IN THE MOUN",
     1"TAINS THAT ARE NEARBY.")
      IF(IRIT.EQ.24014.AND.IFD(IVEN(89)).EQ.1)WRITE(LDEV,24014)
24014 FORMAT(/" YOU CAN HEAR THE ROAR OF THE FIRE IN THE FIREPLACE.")
      IF(IRIT.EQ.24014.AND.IFD(IVEN(89)).NE.1)WRITE(LDEV,24214)
24214 FORMAT(/" YOU CAN HEAR YOUR ECHO AS YOU WALK ABOUT THE ROOM.")
      IF(IRIT.EQ.24015)WRITE(LDEV,24015)
24015 FORMAT(/" YOU CAN HEAR SOMEONE MAKING NOISE BELOW THE FLOOR.")
      IF(IRIT.EQ.24016)WRITE(LDEV,24016)
24016 FORMAT(/" YOU CAN HEAR SOFT ORGAN MUSIC.")
      IF(IRIT.EQ.24017)WRITE(LDEV,24017)
24017 FORMAT(/" YOU CAN HEAR THE FAINT SOUND OF ORGAN MUSIC.")
      IF(IRIT.EQ.24018)WRITE(LDEV,24018)
24018 FORMAT(/" YOU CAN HEAR A FACET DRIPPING.")
      IF(IRIT.EQ.24019)WRITE(LDEV,24019)
24019 FORMAT(/" YOU CAN HEAR THE SOUND OF YOUR HEART BEAT.")
      IF(IRIT.EQ.24020)WRITE(LDEV,24020)(IDTN(L,IDS),L=1,4)
      IF(IRIT.EQ.24024)WRITE(LDEV,24020)(IDTN(L,IDE),L=1,4)
      IF(IRIT.EQ.24025)WRITE(LDEV,24020)(IDTN(L,IDN),L=1,4)
24020 FORMAT(/" YOU CAN HEAR THE WIND BLOWING OUTSIDE THE WINDOW ",
     1"TO THE "4A2)
      IF(IRIT.EQ.24021)WRITE(LDEV,24021)
24021 FORMAT(/" YOU CAN HEAR THE WIND WHISTLING BETWEEN YOUR EARS.")
      IF(IRIT.EQ.24023.OR.IRIT.EQ.24026)WRITE(LDEV,24023)
24023 FORMAT(/" YOU CAN HEAR THE SOUNDS OF CHAINS RATTLING ABOVE YOU.")
      IF(IRIT.EQ.24027)WRITE(LDEV,24027)
24027 FORMAT(/" YOU CAN HEAR YOURSELF BREATHING.")
      IF(IRIT.EQ.24028)WRITE(LDEV,24028)
24028 FORMAT(/" YOU CAN HEAR SIX DISTINCT ECHOES FOR EACH SOUND YOU ",
     1"MAKE.")
      IF(IRIT.EQ.24029)WRITE(LDEV,24029)
24029 FORMAT(/" YOU CAN HEAR FIVE DISTINCT ECHOES FOR EACH SOUND YOU ",
     1"MAKE.")
      IF(IRIT.EQ.24030)WRITE(LDEV,24030)
24030 FORMAT(/" YOU CAN HEAR FOUR DISTINCT ECHOES FOR ECH SOUND YOU ",
     1"MAKE.")
      IF(IRIT.EQ.24031)WRITE(LDEV,24031)
24031 FORMAT(/" YOU CAN HEAR THREE DISTINCT ECHOES FOR EACH SOUND ",
     1"YOU MAKE.")
      IF(IRIT.EQ.24032)WRITE(LDEV,24032)
24032 FORMAT(/" YOU CAN HEAR TWO DISTINCT SOUNDS FOR EACH SOUND YOU ",
     1"MAKE.")
      IF(IRIT.EQ.24033.OR.IRIT.EQ.24034)WRITE(LDEV,24033)
24033 FORMAT(/" YOU CAN HEAR AN ECHO FOR EACH SOUND YOU MAKE.")
      IF(IRIT.GT.24035.AND.IRIT.LT.24041)WRITE(LDEV,24036)
24036 FORMAT(/" YOU CAN HEAR THE SOUND OF THE WALL CLOSING.")
      IF(IRIT.EQ.24041)WRITE(LDEV,24041)
24041 FORMAT(/" YOU CAN HEAR WATER FLOWING BELOW YOU.")
      IF(IRIT.GT.24041.AND.IRIT.LT.24054.AND.IRES(4).NE.0)
     1WRITE(LDEV,24042)
24042 FORMAT(/" YOU CAN HEAR SOMETHING DIGGING NEARBY.")
      IF(IRIT.GT.24041.AND.IRIT.LT.24054.AND.IRES(4).EQ.0)
     1WRITE(LDEV,24043)
24043 FORMAT(/" YOU CAN HEAR CREAKING LIKE THE TUNNEL IS GOING TO ",
     1"CAVE-IN.")
      IF(IRIT.EQ.24088)WRITE(LDEV,24088)
24088 FORMAT(/" YOU CAN HEAR THE FAINT SOUND OF MACHINERY.")
      IF(IRIT.EQ.24100)WRITE(LDEV,24100)
24100 FORMAT(/" YOU CAN HEAR NOTHING OF INTEREST.")
      IF(IRIT.EQ.24105)WRITE(LDEV,24105)
24105 FORMAT("  ")
      IF(IPR(3).EQ.24108)WRITE(LDEV,24108)
24108 FORMAT(" YOU CAN HEAR A CLOCK TICKING.")
      IF(IPR(3).EQ.24110)WRITE(LDEV,24110)
24110 FORMAT(" YOU CAN HEAR SOMETHING MAKING NOISE NEARBY.")
      IF(IPR(3).EQ.24120)WRITE(LDEV,24120)
24120 FORMAT(" YOU CAN HEAR SOMEONE MAKING NOISE NEARBY.")
      IF(IPR(3).EQ.24130)WRITE(LDEV,24130)
24130 FORMAT(" YOU CAN HEAR SOMEONE WHISPERING NEARBY.")
      IF(IPR(3).EQ.24140)WRITE(LDEV,24140)
24140 FORMAT(" YOU CAN HEAR SOMEONE TALKING NEARBY.")
      IF(IPR(3).EQ.24150)WRITE(LDEV,24150)
24150 FORMAT(" YOU CAN HEAR THE WOODSMAN AND HUNTER LAUGHING AND ",
     1"SAYING SOMETHING"/" ABOUT CLOSING THE GATE.")
      IF(IPR(3).EQ.24160)WRITE(LDEV,24160)(IRSN(L,ITST(9)),L=1,4)
24160 FORMAT(" YOU CAN HEAR THE MASTER AND THE BUTLER SAYING ",
     1"SOMETHING ABOUT THE "4A2/" AND MURDER.")
      IF(IPR(3).EQ.24162)WRITE(LDEV,24162)(IRNM(L,IFSD(IROM(ITST(8)))),
     1L=1,8)
24162 FORMAT(" YOU CAN HEAR THE MASTER AND THE BUTLER SAYING ",
     1"SOMETHING ABOUT THE"/" SCENE OF THE MURDER BEING THE "8A2)
      IF(IPR(3).EQ.24164)WRITE(LDEV,24164)(IWP(L),L=1,4)
24164 FORMAT(" YOU HEAR THE MASTER TELLING THE BUTLER ABOUT A ",
     1"MURDER WITH THE "4A2)
      IF(IPR(3).EQ.24170)WRITE(LDEV,24170)(IRSN(L,ITST(9)),L=1,4)
24170 FORMAT(" YOU CAN HEAR THE COOK AND THE GARDENER SAYING ",
     1"SOMETHING ABOUT THE "4A2/" AND MURDER.")
      IF(IPR(3).EQ.24172)WRITE(LDEV,24172)(IRNM(L,IFSD(IROM(ITST(8)))),
     1L=1,8)
24172 FORMAT(" YOU CAN HEAR THE COOK AND TYHE GARDENER SAYING ",
     1"SOMETHING ABOUT THE"/" SCENE OF THE MURDER BEING THE "8A2)
      IF(IPR(3).EQ.24174)WRITE(LDEV,24174)(IWP(L),L=1,4)
24174 FORMAT(" YOU HEAR THE COOK TELLING THE GARDENER ABOUT A ",
     1"MURDER WITH THE "4A2)
      IF(IPR(3).EQ.24180)WRITE(LDEV,24180)(IRSN(L,ITST(9)),L=1,4)
24180 FORMAT(" YOU CAN HEAR THE LADY AND THE MAID SAYING ",
     1"SOMETHING ABOUT THE "4A2/" AND MURDER.")
      IF(IPR(3).EQ.24182)WRITE(LDEV,24182)(IRNM(L,IFSD(IROM(ITST(8)))),
     1L=1,8)
24182 FORMAT(" YOU CAN HEAR THE LADY AND THE MAID SAYING ",
     1"SOMETHING ABOUT THE"/" SCENE OF THE MURDER BEING THE "8A2)
      IF(IPR(3).EQ.24184)WRITE(LDEV,24184)(IWP(L),L=1,4)
24184 FORMAT(" YOU HEAR THE LADY TELLING THE MAID ABOUT A ",
     1"MURDER WITH THE "4A2)
      IF(LU.NE.IPR(1).OR.ITST(21).EQ.0)GOTO 9999
      LU=ITST(21)
      GOTO 999
 9999 NAME(2)=MOVEAS("SB")
      IF(IRIT.EQ.12040)NAME(2)=MOVEAS("SC")
      IF(IRIT.EQ.12040)IWRD(6,1)=25
      CALL EXEC(8,NAME,0,0,0)
      STOP
      END
$CONTROL SEGMENT=MMSJ
      SUBROUTINE MMSJ
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      INTEGER MOVEAS
      IFSD(I)=I-(I/100)*100
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      RN(R)=R*7.7-INT(R*7.7)
      NAME(2)=MOVEAS("SK")
      LU=IPR(1)
      IR=ITST(1)
      R=RND
      GOTO(1000,1000,2000,3000,4000,5000,6000,7000),IWRD(6,1)-53
 1000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(7,1).NE.2.OR.IWRD(5,2).NE.3)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(6,2).NE.92) GOTO 15100
      IF((IR.GT.27.AND.IR.NE.36.AND.IR.NE.54.AND.IR.NE.91.AND.IR.NE.
     190).OR.IR.EQ.3.OR.IR.EQ.4.OR.IR.EQ.13.OR.IR.EQ.16.OR.IR.EQ.21
     2.OR.IR.EQ.22)CALL EXEC(8,NAME,LU,2030,0)
      DO 15010 J=1,240
      IF(IFSD(IXT(J)) .NE. IR) GOTO 15010
      IF((J-1)/60+1 .NE. ITST(4)/1000)GOTO 15010
      IC=ITFD(IXT(J))
      IF(IC.EQ.4.OR.IC.EQ.13.OR.IC.EQ.22.OR.J.EQ.62.OR.J.EQ.70.OR.J
     1.EQ.133.OR.J.EQ.182.OR.J.EQ.190)CALL EXEC(8,NAME,LU,15030,0)
      IF(IXT(J) .LT. 10000)CALL EXEC(8,NAME,LU,15020,0)
      IF(((IXT(J) .LT. 20000).AND. (IWRD(6,1) .EQ. 54)) .OR.
     1((IXT(J) .GT. 20000).AND. (IWRD(6,1) .EQ. 55)))
     2CALL EXEC(8,NAME,LU,8020,0)
      IF(IVEN(46).LT.20000.AND.J.EQ.64)CALL EXEC(8,NAME,LU,15041,0)
      IF(IVEN(2) .LT. 20000.AND.J.NE.64) CALL EXEC(8,NAME,LU,15040,0)
      IF(IWRD(6,1) .EQ. 54) IXT(J)=IXT(J)-10000
      IF(IWRD(6,1) .EQ. 55) IXT(J)=IXT(J)+10000
      IF((J.LT.121).AND.(IWRD(6,1).EQ.54))IXT(J+120)=IXT(J+120)-10000
      IF((J.GT.120).AND.(IWRD(6,1).EQ.54))IXT(J-120)=IXT(J-120)-10000
      IF((J.LT.121).AND.(IWRD(6,1).EQ.55))IXT(J+120)=IXT(J+120)+10000
      IF((J.GT.120).AND.(IWRD(6,1).EQ.55))IXT(J-120)=IXT(J-120)+10000
      CALL EXEC(8,NAME,LU,1040,0)
15010 CONTINUE
      CALL EXEC(8,NAME,LU,15030,0)
15100 IF(IWRD(6,2).NE.54.AND.IWRD(6,2).NE.35) GOTO 15200
      IF(IVEN(35).LT.20000.AND.IVEN(35).NE.600+IR)CALL EXEC(8,NAME,
     1LU,8030,0)
      IF(IWRD(6,1).EQ.55.AND.IFD(IVEN(35)).EQ.0)
     1CALL EXEC(8,NAME,LU,8020,0)
      IF(IWRD(6,1).EQ.55)CALL EXEC(8,NAME,LU,2010,0)
      IF(IVEN(2).LT.20000)CALL EXEC(8,NAME,LU,15040,0)
      CALL EXEC(8,NAME,LU,15110,0)
15200 CONTINUE
15900 CALL EXEC(8,NAME,LU,8010,0)
 2000 IF(IWRD(7,1).EQ.1)CALL EXEC(8,NAME,LU,1000,0)
      IF(IWRD(7,1).NE.2.OR.(IWRD(5,2).NE.4.AND.IWRD(5,2).NE.3).OR.
     1(IWRD(5,2).EQ.3.AND.IWRD(6,2).NE.54))CALL EXEC(8,NAME,LU,320,0)
      IF (IVEN(9) .LT. 20000)CALL EXEC(8,NAME,LU,16010,0)
      CALL MMRL
16019 IF(IFSD(IRES(IWRD(6,2))).NE.IR.AND.IWRD(5,2).NE.3)
     1CALL EXEC(8,NAME,LU,2030,0)
      IF(IWRD(5,2).EQ.3.AND.IFD(IVEN(35)).NE.0)CALL EXEC(8,NAME,LU,
     A2030,0)
      IC=0
      IF(IVEN(20).GT.20000)IC=1
      IF(IWRD(6,2).EQ.10)GOTO 16020
      IF((ITST(11) .EQ. 0) .AND. (IVEN(20) .LT. 20000))
     1CALL EXEC(8,NAME,LU,16020,0)
      IF((ITST(11).EQ.0.OR.IWRD(6,2).EQ.10).AND.IVEN(20).GT.20000)
     1IVEN(20)=0
      IF(((ITST(11).GT.0).AND.(IWRD(6,2).NE.10)) .OR. ((IWRD(6,2)
     1.EQ.10).AND.(IVEN(20).LT.20000)))ITST(11)=ITST(11)-1
      R=RN(R)
      IF(R .LT. .2) CALL EXEC(8,NAME,LU,16030,0)
      IF(R.LT..4.AND.IRES(IWRD(6,2))/1000.EQ.0)IRES(IWRD(6,2))=
     1IRES(IWRD(6,2))+5000
      IF(R.LT..4.AND.IRES(IWRD(6,2))/1000.EQ.0)
     1CALL EXEC(8,NAME,LU,16031,0)
      IF(IWRD(5,2).EQ.3)CALL EXEC(8,NAME,LU,16035,0)
      IF((IWRD(6,2) .EQ. 1) .OR. (IWRD(6,2)
     1.EQ. 5) .OR. ((IWRD(6,2) .EQ. 10).AND. (IC .EQ. 0))
     2.OR.(IRES(IWRD(6,2)).GT.10000)) CALL EXEC(8,NAME,LU,16040,0)
      IF(IWRD(6,2).EQ.13.AND.IR.NE.33) IRES(13)=533
      IF(IWRD(6,2).EQ.13.AND.IR.EQ.33) IRES(13)=534
      IF(IWRD(6,2).EQ.13)CALL EXEC(8,NAME,LU,16045,0)
16020 IF(IWRD(6,2).EQ.10)IRES(ITST(39))=10000+IR
      IF(IWRD(6,2).EQ.10)ITST(2)=ITST(2)+75
      IF(IWRD(6,2).EQ.16.AND.R.LT..8.AND.IVEN(45).EQ.14416.AND.
     1IRES(16)/1000.LT.4)CALL EXEC(8,NAME,LU,16046,0)
      IRES(IWRD(6,2))=10000+IR
      IF(IWRD(6,2).EQ.10)IRES(10)=0
      CALL EXEC(8,NAME,LU,16050,0)
 3000 IF((IWRD(7,1).NE.2).OR.(IWRD(5,2).NE.3))CALL EXEC(8,NAME,LU,320,0)
      CALL MMRL
      IF(IVEN(33) .LT. 20000)CALL EXEC(8,NAME,LU,20010,0)
      IF(IVEN(33) .GT. 22000)CALL EXEC(8,NAME,LU,20020,0)
      IF((IWRD(6,2) .LT. 54) .AND. (IVEN(IWRD(6,2)) .LT. 20000))
     1CALL EXEC(8,NAME,LU,3010,0)
      IF((IWRD(6,2) .GT. 47) .AND. (IFSD(IVEN(IWRD(6,2))) .NE. IR)
     1.AND. (IFSD(IVEN(IWRD(6,2))) .NE. 0)) CALL EXEC(8,NAME,LU,2030,0)
      IF((IWRD(6,2) .GT. 45) .AND. (IWRD(6,2) .LT. 51))
     1CALL EXEC(8,NAME,LU,20030,0)
      IF((IWRD(6,2) .EQ. 91) .AND. (IROM(IR) .LT. 10000))
     1CALL EXEC(8,NAME,LU,2030,0)
      IF((IWRD(6,2) .EQ. 92) .OR. (IWRD(6,2) .EQ. 93))
     1 CALL EXEC(8,NAME,LU,8020,0)
      IF((IWRD(6,2) .EQ. 74) .AND. (IR .EQ. 85)) IXT(322)=9185
      IF((IWRD(6,2) .EQ. 74) .AND. (IR .EQ. 86)) IXT(322)=8586
      IVEN(74)=IVEN(74)+1000
      CALL EXEC(8,NAME,LU,1040,0)
 4000 CALL EXEC(8,NAME,LU,320,0)
 5000 IF(IWRD(7,1).NE.2.OR.IWRD(5,2).NE.3.OR.IWRD(6,2).NE.54)
     1CALL EXEC(8,NAME,LU,320,0)
      CALL MMRL
      IF(IFD(IVEN(35)).EQ.1)CALL EXEC(8,NAME,LU,8020,0)
      IF(IFSD(IVEN(35)).NE.IR.OR.IVEN(35).GT.10000)
     1CALL EXEC(8,NAME,LU,22010,0)
      IF(IVEN(11).LT.20000.AND.IVEN(12).LT.20000.AND.IVEN(14).LT.
     120000.AND.IVEN(32).LT.20000.AND.IVEN(34).LT.20000)
     2CALL EXEC(8,NAME,LU,22020,0)
      CALL EXEC(8,NAME,LU,16035,0)
 6000 IF(IWRD(7,1).NE.4.OR.IWRD(5,2).NE.3.OR.IWRD(5,3).NE.5.OR.
     1IWRD(5,4).NE.3)CALL EXEC(8,NAME,LU,320,0)
      IF(IWRD(6,2).NE.17.OR.IWRD(6,3).NE.1.OR.IWRD(6,4).NE.66)GOTO 6100
      IF(IVEN(17).LT.20000)CALL EXEC(8,NAME,LU,3010,0)
      IF(IR.NE.41)CALL EXEC(8,NAME,LU,6010,0)
      IVEN(17)=1141
      CALL EXEC(8,NAME,LU,6020,0)
 6100 IF(IWRD(6,2).NE.46.OR.IWRD(6,3).NE.2.OR.IWRD(6,4).NE.85)GOTO 6200
      IF(IVEN(46).LT.20000)CALL EXEC(8,NAME,LU,3010,0)
      IF(IR.NE.1)CALL EXEC(8,NAME,LU,6010,0)
      IVEN(46)=1101
      CALL EXEC(8,NAME,LU,1040,0)
 6200 IF(IWRD(6,2).NE.5.OR.IWRD(6,3).NE.2.OR.IWRD(6,4).NE.77)GOTO 6300
      IF(IVEN(5).LT.20000)CALL EXEC(8,NAME,LU,3010,0)
      IF(IR.NE.16)CALL EXEC(8,NAME,LU,6010,0)
      IVEN(5)=1316
      CALL EXEC(8,NAME,LU,1040,0)
 6300 IF(IWRD(6,2).NE.4.OR.IWRD(6,3).NE.2.OR.IWRD(6,4).NE.85)GOTO 6900
      IF(IVEN(4).LT.20000)CALL EXEC(8,NAME,LU,3010,0)
      IF(IR.NE.93)CALL EXEC(8,NAME,LU,6010,0)
      IF(IFD(IVEN(4)).EQ.1)IVEN(4)=1493
      IF(IFD(IVEN(4)).NE.1)IVEN(4)=493
      CALL EXEC(8,NAME,LU,1040,0)
 6900 CALL EXEC(8,NAME,LU,320,0)
 7000 IF(IWRD(7,1).EQ.1)GOTO 7500
      IF(IWRD(7,1).NE.3.OR.IWRD(5,2).NE.5.OR.IWRD(6,2).NE.13.OR.
     1IWRD(5,3).NE.4)CALL EXEC(8,NAME,LU,320,0)
      IF(IFSD(IRES(IWRD(6,3))).NE.IR)CALLEXEC(8,NAME,LU,8031,0)
      IF(IWRD(6,3).EQ.1.OR.IWRD(6,3).EQ.15.OR.IWRD(6,3).EQ.4)
     1CALL EXEC(8,NAME,LU,7010,0)
      IF(IR.NE.1.AND.IR.NE.20.AND.IR.NE.24.AND.IR.NE.25)
     1CALL EXEC(8,NAME,LU,7020,0)
      IF(ITST(32).NE.1.OR.(IR.EQ.1.AND.IXT(61).LT.20000).OR.
     1(IR.EQ.20.AND.(IXT(12).LT.20000.OR.IROM(20).GT.20000)).OR.
     2(IR.EQ.25.AND.(IXT(73).LT.20000.OR.IROM(25).GT.20000)).OR.
     3IR.EQ.24)CALL EXEC(8,NAME,LU,7030,0)
      DO 7035 I=1,53
      IF(IVEN(I).GE.20000)CALL EXEC(8,NAME,LU,7030,0)
 7035 CONTINUE
      DO 7050 I=1,17
      IF(IFSD(IRES(I)).EQ.IR.AND.IWRD(6,3).NE.I)
     1CALL EXEC(8,NAME,LU,7030,0)
 7050 CONTINUE
      IF(IWRD(6,3).EQ.3.OR.IWRD(6,3).EQ.7.OR.IWRD(6,3).EQ.14)ITST(32)=2
      IF(IWRD(6,3).EQ.2.OR.IWRD(6,3).EQ.8.OR.IWRD(6,3).EQ.9)ITST(32)=3
      ITST(5)=ITST(5)+25
      CALL EXEC(8,NAME,LU,7040,0)
 7500 IF (IR.NE.1.AND.IR.NE.10.AND.IR.NE.20.AND.IR.NE.24.AND.IR.
     1NE.25)CALL EXEC(8,NAME,LU,7510,0)
      DO 7520 I=2,17
      IF(IFSD(IRES(I)).EQ.IR)CALL EXEC(8,NAME,LU,7530,0)
 7520 CONTINUE
      ITST(5)=ITST(5)+25
      CALL EXEC(8,NAME,LU,7540,0)
      STOP
      END
$CONTROL SEGMENT=MMSK
      SUBROUTINE MMSK
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      INTEGER MOVEAS
      IFSD(I)=I-(I/100)*100
      ITFD(I)=I/100-(I/10000)*100
      ITD(I)=I/100-(I/1000)*10
      IFD(I)=I/1000-(I/10000)*10
      CALL RMPAR(IPR)
      LU=IPR(1)
      IRIT=IPR(2)
      IW63=IWRD(6,3)
      IFC=ITST(4)/1000
      IDN=1
      IDE=2
      IDS=3
      IDW=4
      IF(IVEN(6).LT.20000)IDN=10-IFC
      IF(IDN.EQ.6)IDN=10
      IF(IVEN(6).LT.20000)IDE=11-IFC
      IF(IVEN(6).LT.20000)IDS=12-IFC
      IF(IDS.EQ.11)IDS=7
      IF(IVEN(6).LT.20000)IDW=13-IFC
      IF(IDW.GT.10)IDW=IDW-4
  999 IF (IRIT .EQ. 320) WRITE(LDEV,320)
  320 FORMAT(/" I CANNOT FIGURE OUT WHAT YOU ARE TRYING TO SAY")
      IF (IRIT .EQ. 520) WRITE(LDEV,520)
  520 FORMAT(/" NOTHING HAPPENS")
      IF(IRIT.EQ.1000)WRITE(LDEV,1000)(IWRD(L,1),L=1,4)
 1000 FORMAT(/" I AM NOT A MIND READER, YOU WILL HAVE TO TELL ME ",
     1"WHAT TO "4A2)
      IF (IRIT .EQ. 1040) WRITE(LDEV,1040)
 1040 FORMAT(/" OKAY")
      IF(IRIT .EQ. 1065) WRITE(LDEV,1065) IPR(3)
 1065 FORMAT(/" PROGRAM ERROR AT LINE"I6)
      IF(IPR(3).EQ.7.OR.IPR(3).EQ.16.OR.IPR(3).EQ.25)IC=IDS
      IF(IPR(3).EQ.5.OR.IPR(3).EQ.14.OR.IPR(3).EQ.23)IC=IDW
      IF(IPR(3).EQ.1.OR.IPR(3).EQ.10.OR.IPR(3).EQ.19)IC=IDN
      IF(IRIT .EQ. 1095) WRITE(LDEV,1095)(IDTN(I,IC),I=1,4)
 1095 FORMAT(/" YOUR ACTION OPENED A PANEL INTO THE SECRET PASSAGE ",
     1"THAT YOU CAN"/" ENTER BY GOING "4A2)
      IF (IRIT .EQ. 2010) WRITE (LDEV,2010)(IWRD(L,1),L=1,2),
     1(IWRD(L,2),L=1,4)
 2010 FORMAT(/" YOU CANNOT "2A2" THE "4A2)
      IF (IRIT .EQ. 2020) WRITE(LDEV,2020)(IWRD(L,2),L=1,4)
 2020 FORMAT(/" YOU ALREADY HAVE THE "4A2)
      IF (IRIT .EQ. 2025) WRITE(LDEV,2025)(IWRD(L,4),L=1,4)
 2025 FORMAT(/"  IT IS NOT IN THE POSSESSION OF THE "4A2)
      IF (IRIT .EQ. 2030) WRITE(LDEV,2030)(IWRD(L,2),L=1,4)
 2030 FORMAT(/" I DON'T SEE THE "4A2)
      IF (IRIT .EQ. 3010) WRITE(LDEV,3010)(IWRD(L,2),L=1,4)
 3010 FORMAT(/" YOU DO NOT HAVE THE "4A2)
      IF (IRIT .EQ. 3110) WRITE(LDEV,3110)(IWRD(L,2),L=1,4)
 3110 FORMAT(/" YOU NO LONGER HAVE THE "4A2)
      IF (IRIT .EQ. 4010) WRITE(LDEV,4010)(IWRD(L,4),L=1,4)
 4010 FORMAT(/" FIRST YOU HAVE TO FIND THE "4A2)
      IF(IRIT.EQ.4050)WRITE(LDEV,4050)
 4050 FORMAT(/" THANKS. IT NEEDS THAT AROUND HERE.")
      IF (IRIT .EQ. 5020) WRITE(LDEV,5020)(IWRD(L,3),L=1,4)
 5020 FORMAT(/" I DO NOT SEE THE "4A2)
      IF(IRIT.EQ.6010)WRITE(LDEV,6010)
 6010 FORMAT(/" YOU MUST NOT BE PAYING ATTENTION.")
      IF(IRIT.EQ.6020)WRITE(LDEV,6020)
 6020 FORMAT(/" THE FLOOR UNDER YOU MOVED SLIGHTLY AS IF THE AMULET ",
     1"ACTIVATED SOMETHING.")
      IF(IRIT.EQ.7010)WRITE(LDEV,7010)
 7010 FORMAT(/" YOU MUST BE SOME KIND OF PERVERT.")
      IF(IRIT.EQ.7020)WRITE(LDEV,7020)(IWRD(L,3),L=1,4)
 7020 FORMAT(/" 'THIS IS NOT THE TIME OR PLACE.' SAYS THE "4A2)
      IF(IRIT.EQ.7030)WRITE(LDEV,7030)(IWRD(L,3),L=1,4)
 7030 FORMAT(/" 'NOT NOW. SOMETHING IS NOT RIGHT.' SAYS THE "4A2)
      IF(IRIT.EQ.7040)WRITE(LDEV,7040)(IWRD(L,3),L=1,4),(IWRD(L,3),L=
     A1,4)
 7040 FORMAT(/" YOU FEEL YOURSELF GETTING AROUSED AS YOU WATCH ",
     1"A SEXY STRIP BY THE "4A2/" BEFORE PULLING YOU INTO BED. ",
     2"EAGERLY, YOU CARESS EACH OTHER AND ........."//" AN HOUR ",
     3"LATER, AFTER MANY SEXUAL DELIGHTS AND A NAP; YOU SEE THE "4A2/
     4" FINISH DRESSING, GIVING YOU A THANKFUL SMILE AS YOU WAKE UP.")
      IF (IRIT .EQ. 7050) WRITE(LDEV,7050)
 7050 FORMAT(" NOTHING")
      IF(IRIT.EQ.7510)WRITE(LDEV,7510)
 7510 FORMAT(/" YOU CANNOT GET COMFORTABLE HERE.")
      IF(IRIT.EQ.7530)WRITE(LDEV,7530)
 7530 FORMAT(/" SOMEONE IN THE ROOM IS KEEPING YOU AWAKE.")
      IF(IRIT.EQ.7540)WRITE(LDEV,7540)
 7540 FORMAT(/" YOU SLEEP FOR AN HOUR AND WAKE-UP REFRESHED.")
      IF (IRIT .EQ. 8010 ) WRITE(LDEV,8010)
 8010 FORMAT(/" I DON'T KNOW WHAT YOU EXPECT TO HAPPEN")
      IF(IRIT .EQ. 8015) WRITE(LDEV,8015)(IWRD(L,2),L=1,4)
 8015 FORMAT(/" YOUR FOOD HAS BEEN EATEN BY THE "4A2)
      IF (IRIT .EQ. 8020) WRITE(LDEV,8020)
 8020 FORMAT(/" IT ALREADY IS")
      IF (IRIT .EQ. 8030) WRITE(LDEV,8030)(IWRD(L,2),L=1,4)
      IF (IRIT .EQ. 8031) WRITE(LDEV,8030)(IWRD(L,3),L=1,4)
 8030 FORMAT(/" I DON'T SEE THE "4A2)
      IF(IRIT .EQ. 15030) WRITE(LDEV,15030)
      IF(IRIT.EQ.15020)WRITE(LDEV,15020)
15020 FORMAT(/" THE DOOR YOU ARE FACING HAS NO LOCK")
15030 FORMAT(/" YOU ARE NOT FACING A DOOR")
      IF(IRIT .EQ. 15040) WRITE(LDEV,15040)
15040 FORMAT(/" YOU NEED A DOOR KEY")
      IF(IRIT.EQ.15041)WRITE(LDEV,15041)
15041 FORMAT(/" YOU NEED A DUNGEON KEY")
      IF(IRIT.EQ.15110)WRITE(LDEV,15110)
15110 FORMAT(/" YOUR KEY WILL NOT FIT THE PADLOCK")
      IF (IRIT .EQ. 16010) WRITE(LDEV,16010)
16010 FORMAT(/" YOU NEED A GUN TO SHOOT ANYONE")
      IF(IRIT .EQ. 16020) WRITE(LDEV,16020)
16020 FORMAT(/" YOUR GUN IS OUT OF BULLETS")
      IF(IRIT .EQ. 16030) WRITE(LDEV,16030)
16030 FORMAT(/" YOU MISSED")
      IF(IRIT.EQ.16031)WRITE(LDEV,16031)(IWRD(L,2),L=1,4)
16031 FORMAT(/" YOU WOUNDED THE "4A2)
      IF(IRIT.EQ.16035)WRITE(LDEV,16035)
16035 FORMAT(/" YOU JUST SMASHED THE PADLOCK TO PIECES")
      IF(IRIT.EQ.16035)IVEN(35)=IVEN(35)+1000
      IF(IRIT .EQ. 16040) WRITE(LDEV,16040)(IWRD(L,2),L=1,4)
16040 FORMAT(/" YOU JUST WASTED A SHOT. IT DID YOU NO GOOD TO SHOOT ",
     1"THE "4A2)
      IF(IRIT.EQ.16045)WRITE(LDEV,16045)
16045 FORMAT(/" YOU KILLED THE DWARF AND HE DISAPPEARED IN A CLOUD OF ",
     1"GREASY BLACK SMOKE")
      IF(IRIT.EQ.16046)WRITE(LDEV,16046)
16046 FORMAT(/" THE BULLET BOUNCED OFF THE WARRIOR'S SHIELD.")
      IF(IRIT.EQ.16045)IRES(13)=IRES(13)+100
      IF(IRIT .EQ. 16050) WRITE(LDEV,16050)(IWRD(L,2),L=1,4)
16050 FORMAT(/" YOU JUST SHOT AND KILLED THE "4A2)
      IF(IRIT .EQ. 20010) WRITE(LDEV,20010)
20010 FORMAT(/" YOU NEED AN OILCAN OR SOMETHING")
      IF(IRIT .EQ. 20020) WRITE(LDEV,20020)
20020 FORMAT(/" YOUR OILCAN IS EMPTY")
      IF(IRIT .EQ. 20030) WRITE(LDEV,20030)
20030 FORMAT(/" DON'T BE SILLY")
      IF(IRIT.EQ.21020)WRITE(LDEV,21020)ITST(21)
21020 FORMAT(/" THIS LINE AND EVERY LINE WILL BE RECORDED ON LU #"I3,
     1" FOR THE REST OF THE GAME.")
      IF(IRIT.EQ.22010)WRITE(LDEV,22010)
22010 FORMAT(/" THE CHEST IS NOT WHERE YOU CAN BREAK THE PADLOCK")
      IF(IRIT.EQ.22020)WRITE(LDEV,22020)
22020 FORMAT(/" YOU DO NOT HAVE ANYTHING THAT WILL BREAK THE PADLOCK")
      IF(LU.NE.IPR(1).OR.ITST(21).EQ.0)GOTO 9999
      LU=ITST(21)
      GOTO 999
 9999 NAME(2)=MOVEAS("SB")
      CALL EXEC(8,NAME,0,0,0)
      STOP
      END
$CONTROL SEGMENT=MMETC
      SUBROUTINE MMRI(IV,IRS)
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      IFSD(I)=I-(I/100)*100
      IFD(I)=I/1000-(I/10000)*10
      LU=IPR(1)
      IR=ITST(1)
   50 IC=0
      DO 1000 J=1,53
      IF(IV.EQ.1.AND.(IVEN(J).GT.10000.OR.IVEN(J)-100*(IVEN(J)/100)
     1.NE.IR))GOTO 1000
      IF(IV.EQ.2.AND.IVEN(J).LT.20000)GOTO 1000
      IF(IV.EQ.4.AND.IRS.NE.J)GOTO 1000
      IF(IV.EQ.3.AND.(IVEN(J).LT.10000.OR.IVEN(J).GT.20000.OR.
     1IFSD(IVEN(J)).NE.IRS))GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.4.AND.(IVEN(4).EQ.493.OR.IVEN(4).EQ.1493))
     1GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.5.AND.IVEN(5).EQ.1316)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.17.AND.IVEN(17).EQ.1141)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.19.AND.IR.EQ.16)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.29.AND.IVEN(29).EQ.1214)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.30.AND.IR.EQ.25)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.37.AND.IVEN(37).EQ.1153)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.39.AND.IVEN(39).EQ.1253)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.40.AND.IVEN(40).EQ.1151)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.42.AND.IVEN(42).EQ.1151)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.46.AND.IVEN(46).EQ.1101)GOTO 1000
      IF(IV.EQ.1.AND.J.EQ.28.AND.IVEN(28).EQ.1184)GOTO 1000
      IF(IV.EQ.1.AND.IC.EQ.0)WRITE(LDEV,100)
      IF(IV.EQ.2.AND.J.EQ.53)GOTO 1000
  100 FORMAT(/" YOU CAN SEE:")
      IF(IV.EQ.5.AND.(J-1)/3.-INT((J-1)/3.).EQ.0)WRITE(LDEV,110)J,
     1IVEN(J)
      IF(IV.EQ.5.AND.(J-1)/3.-INT((J-1)/3.).NE.0)WRITE(LDEV,111)IVEN(J)
  110 FORMAT(I3,I6," ")
  111 FORMAT(I6," ")
      IF(J.EQ.1)WRITE(LDEV,210)
  210 FORMAT(" THE VAMPIRE RING ")
      IF(J.EQ.2)WRITE(LDEV,220)
  220 FORMAT(" A SET OF KEYS    ")
      IF(J.EQ.3)WRITE(LDEV,230)
  230 FORMAT(" A WIND UP CLOCK  ")
      IF(J.EQ.4)WRITE(LDEV,240)
  240 FORMAT(" A BATTERY LANTERN")
      IF(J.EQ.5)WRITE(LDEV,250)
  250 FORMAT(" A SILVER CROSS   ")
      IF(J.EQ.6)WRITE(LDEV,260)
  260 FORMAT(" A POCKET COMPASS ")
      IF(J.EQ.7)WRITE(LDEV,270)
  270 FORMAT(" A PIRATE TREASURE")
      IF(J.EQ.8)WRITE(LDEV,280)
  280 FORMAT(" A NEW BATTERY    ")
      IF(J.EQ.9)WRITE(LDEV,290)
  290 FORMAT(" A HAND GUN       ")
      IF(J.EQ.10)WRITE(LDEV,300)
  300 FORMAT(" A BUTCHER KNIFE  ")
      IF(J.EQ.11)WRITE(LDEV,310)
  310 FORMAT(" A TWO BLADED AXE ")
      IF(J.EQ.12)WRITE(LDEV,320)
  320 FORMAT(" A SWORD          ")
      IF(J.EQ.13.AND.ITST(10).NE.13)WRITE(LDEV,330)
  330 FORMAT(" A VIAL OF POISON ")
      IF(J.EQ.13.AND.ITST(10).EQ.13)WRITE(LDEV,335)
  335 FORMAT(" AN EMPTY VIAL    ")
      IF(J.EQ.14)WRITE(LDEV,340)
  340 FORMAT(" A CLUB           ")
      IF(J.EQ.15)WRITE(LDEV,350)
  350 FORMAT(" A COIL OF ROPE   ")
      IF(J.EQ.16)WRITE(LDEV,360)
  360 FORMAT(" A DESK CHAIR     ")
      IF(J.EQ.17)WRITE(LDEV,370)
  370 FORMAT(" AN UNEVEN AMULET ")
      IF(J.EQ.18)WRITE(LDEV,380)
  380 FORMAT(" AN OLD TALISMAN  ")
      IF(J.EQ.19.AND.IFD(IVEN(19)).EQ.1)WRITE(LDEV,390)
  390 FORMAT(" A LIT CANDLE     ")
      IF(J.EQ.19.AND.IFD(IVEN(19)).NE.1)WRITE(LDEV,395)
  395 FORMAT(" A CANDLE         ")
      IF(J.EQ.20)WRITE(LDEV,400)
  400 FORMAT(" A SILVER BULLET  ")
      IF(J.EQ.21)WRITE(LDEV,410)
  410 FORMAT(" A BOOK           ")
      IF(J.EQ.22)WRITE(LDEV,420)
  420 FORMAT(" A NOTE           ")
      IF(J.EQ.23)WRITE(LDEV,430)
  430 FORMAT(" A MATTER XMITTER ")
      IF(J.EQ.24)WRITE(LDEV,440)
  440 FORMAT(" SOME FOOD        ")
      IF(J.EQ.25)WRITE(LDEV,450)
  450 FORMAT(" A WITCH'S BROOM  ")
      IF(J.EQ.26)WRITE(LDEV,460)
  460 FORMAT(" A MATTER RECEIVER")
      IF(J.EQ.27.AND.IFD(IVEN(27)).EQ.1)WRITE(LDEV,470)
  470 FORMAT(" A BURNING TORCH  ")
      IF(J.EQ.27.AND.IFD(IVEN(27)).NE.1)WRITE(LDEV,475)
  475 FORMAT(" A USELESS TORCH  ")
      IF(J.EQ.28)WRITE(LDEV,480)
  480 FORMAT(" A SMALL ROAD MAP ")
      IF(J.EQ.29)WRITE(LDEV,490)
  490 FORMAT(" A WOODEN WEDGE   ")
      IF(J.EQ.30)WRITE(LDEV,500)
  500 FORMAT(" A DUSTY GLOBE    ")
      IF(J.EQ.31)WRITE(LDEV,510)
  510 FORMAT(" A KITCHEN MATCH  ")
      IF(J.EQ.32)WRITE(LDEV,520)
  520 FORMAT(" A RUSTY SHOVEL   ")
      IF(J.EQ.33)WRITE(LDEV,530)
  530 FORMAT(" A SMALL OILCAN   ")
      IF(J.EQ.34)WRITE(LDEV,540)
  540 FORMAT(" A GREASY HATCHET ")
      IF(J.EQ.35)WRITE(LDEV,550)
  550 FORMAT(" A MYSTERY CHEST  ")
      IF(J.EQ.36)WRITE(LDEV,560)
  560 FORMAT(" A BAG OF PEARLS  ")
      IF(J.EQ.37)WRITE(LDEV,570)
  570 FORMAT(" AN LARGE EMERALD ")
      IF(J.EQ.38)WRITE(LDEV,580)
  580 FORMAT(" TWELVE GOLD COINS")
      IF(J.EQ.39)WRITE(LDEV,590)
  590 FORMAT(" A SILVER GOBLET  ")
      IF(J.EQ.40)WRITE(LDEV,600)
  600 FORMAT(" SEVERAL DIAMONDS ")
      IF(J.EQ.41)WRITE(LDEV,610)
  610 FORMAT(" SOME FINE JEWELRY")
      IF(J.EQ.42)WRITE(LDEV,620)
  620 FORMAT(" A RUBY NECKLACE  ")
      IF(J.EQ.43)WRITE(LDEV,630)
  630 FORMAT(" A JEWELED CROWN  ")
      IF(J.EQ.44)WRITE(LDEV,640)
  640 FORMAT(" SOME DARTS       ")
      IF(J.EQ.45)WRITE(LDEV,650)
  650 FORMAT(" A METAL SHIELD   ")
      IF(J.EQ.46)WRITE(LDEV,660)
  660 FORMAT(" A DUNGEON KEY    ")
      IF(J.EQ.47)WRITE(LDEV,670)
  670 FORMAT(" AN OLD BATTERY   ")
      IF(J.EQ.48)WRITE(LDEV,680)
  680 FORMAT(" A GAUDY GAUNTLET ")
      IF(J.EQ.49)WRITE(LDEV,690)
  690 FORMAT(" A PARANOID PARROT")
      IF(J.EQ.50)WRITE(LDEV,700)
  700 FORMAT(" A MENACING MACE  ")
      IF(J.EQ.51)WRITE(LDEV,710)
  710 FORMAT(" A BLANK          ")
      IF(J.EQ.52)WRITE(LDEV,720)
  720 FORMAT(" A BLANK          ")
      IF(J.EQ.53)WRITE(LDEV,730)
  730 FORMAT(" YOUR CLOTHES     ")
      IF((IV.NE.5.OR.J/3.-INT(J/3.).EQ..0).AND.LU.NE.6)WRITE(LDEV,900)
  900 FORMAT(" ")
      IC=1
 1000 CONTINUE
      IF((IV.EQ.2.OR.IV.EQ.3).AND.IC.EQ.0)WRITE(LDEV,1010)
 1010 FORMAT(" NOTHING")
      RETURN
      STOP
      END
$CONTROL SEGMENT=MMETC
      SUBROUTINE MMRL
      COMMON/MMBC/IWRD(9,9),IPR(5),IVRB(4,89),IRNM(8,56),IROM(99),
     1IRSN(4,17),IRES(17),IPRP(4,17),IDTN(4,11),IVEN(107),
     2IXT(360),ICLS(4,12),ITST(40),NAME(3),RND,IWP(4),LDEV,IDEV
      IFSD(I)=I-(I/100)*100
      IFD(I)=I/1000-(I/10000)*10
      LU=IPR(1)
      IR=ITST(1)
      DO 1153 I=1,3
      IF(I.EQ.1)K=4
      IF(I.EQ.2)K=19
      IF(I.EQ.3)K=27
      IF(IFD(IVEN(K)).EQ.1.AND.((IVEN(K).LT.10000.AND.IFSD(IVEN(K))
     1.EQ.IR).OR.IVEN(K).GT.20000.OR.(IVEN(K).GT.10000.AND.IVEN(K)
     2.LT.20000.AND.IFSD(IRES(IFSD(IVEN(K)))).EQ.IR))) RETURN
 1153 CONTINUE
      IF ((IR .EQ. 10) .AND. (IVEN(76) .GT. 1000)) RETURN
      IF ((IR .EQ. 14) .AND. (IVEN(89) .GT. 1000)) RETURN
      IF (IVEN(31) .GT. 21000) RETURN
      IF((IR .GT. 53) .AND. (ITST(5) .LT. 300)) RETURN
      IF (IR .GT. 53) CALL EXEC(8,NAME,LU,1150,1)
      IF ((IROM(IR) .GT. 20000) .AND. (ITST(5) .LT. 300)) RETURN
      IF (IROM(IR) .GT. 20000) CALL EXEC(8,NAME,LU,1150,1)
      IF((ITST(5) .LT. 300) .AND. (IROM(IR) .GT. 10000))
     1CALL EXEC(8,NAME,LU,1150,2)
      CALL EXEC(8,NAME,LU,1150,0)
      STOP
      END
